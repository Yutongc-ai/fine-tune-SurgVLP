/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
num_shots is
num_shots is  1
num_shots is  1
Epoch 1 Loss: 0.6935
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.13it/s]
Epoch 1 best val f1 0.2105 test f1 0.33299121260643005
Epoch 2 Loss: 0.6866
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.03it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.07it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.45it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.55it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 2 best val f1 0.6000 test f1 0.4409826695919037
Epoch 3 Loss: 0.6799
Epoch 4 Loss: 0.6733
Epoch 5 Loss: 0.6668
Epoch 6 Loss: 0.6604
Epoch 7 Loss: 0.6542
Epoch 8 Loss: 0.6480
Epoch 9 Loss: 0.6420
Epoch 10 Loss: 0.6361
Epoch 11 Loss: 0.6304
Epoch 12 Loss: 0.6247
Epoch 13 Loss: 0.6192
Epoch 14 Loss: 0.6138
Epoch 15 Loss: 0.6085
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.96it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.43it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.68it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 17 Loss: 0.5983
Epoch 18 Loss: 0.5934
Epoch 19 Loss: 0.5886
Epoch 20 Loss: 0.5839
Epoch 21 Loss: 0.5793
Epoch 22 Loss: 0.5749
Epoch 23 Loss: 0.5705
Epoch 24 Loss: 0.5663
Epoch 25 Loss: 0.5622
Epoch 26 Loss: 0.5582
Epoch 27 Loss: 0.5543
Epoch 28 Loss: 0.5505
Epoch 29 Loss: 0.5468
Epoch 30 Loss: 0.5432
Epoch 31 Loss: 0.5397
Epoch 32 Loss: 0.5363
Epoch 33 Loss: 0.5330
Epoch 34 Loss: 0.5297
Epoch 35 Loss: 0.5266
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.37it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.52it/s]
Epoch 37 Loss: 0.5206
Epoch 38 Loss: 0.5177
Epoch 39 Loss: 0.5149
Epoch 40 Loss: 0.5121
Epoch 41 Loss: 0.5094
Epoch 42 Loss: 0.5068
Epoch 43 Loss: 0.5043
Epoch 44 Loss: 0.5018
Epoch 45 Loss: 0.4994
Epoch 46 Loss: 0.4971
Epoch 47 Loss: 0.4948
Epoch 48 Loss: 0.4926
Epoch 49 Loss: 0.4904
Epoch 50 Loss: 0.4883
Epoch 51 Loss: 0.4863
Epoch 52 Loss: 0.4842
Epoch 53 Loss: 0.4823
Epoch 54 Loss: 0.4804
Epoch 55 Loss: 0.4785
Epoch 56 Loss: 0.4766
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.10it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.13it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.83it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 57 Loss: 0.4749
Epoch 58 Loss: 0.4731
Epoch 59 Loss: 0.4714
Epoch 60 Loss: 0.4697
Epoch 61 Loss: 0.4681
Epoch 62 Loss: 0.4665
Epoch 63 Loss: 0.4649
Epoch 64 Loss: 0.4633
Epoch 65 Loss: 0.4618
Epoch 66 Loss: 0.4603
Epoch 67 Loss: 0.4589
Epoch 68 Loss: 0.4575
Epoch 69 Loss: 0.4561
Epoch 70 Loss: 0.4547
Epoch 71 Loss: 0.4533
Epoch 72 Loss: 0.4520
Epoch 73 Loss: 0.4507
Epoch 74 Loss: 0.4494
Epoch 75 Loss: 0.4481
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.47it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.81it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.07it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.49it/s]
Epoch 77 Loss: 0.4457
Epoch 78 Loss: 0.4445
Epoch 79 Loss: 0.4433
Epoch 80 Loss: 0.4421
Epoch 81 Loss: 0.4409
Epoch 82 Loss: 0.4398
Epoch 83 Loss: 0.4387
Epoch 84 Loss: 0.4376
Epoch 85 Loss: 0.4365
Epoch 86 Loss: 0.4354
Epoch 87 Loss: 0.4343
Epoch 88 Loss: 0.4333
Epoch 89 Loss: 0.4322
Epoch 90 Loss: 0.4312
Epoch 91 Loss: 0.4302
Epoch 92 Loss: 0.4292
Epoch 93 Loss: 0.4282
Epoch 94 Loss: 0.4272
Epoch 95 Loss: 0.4262
Epoch 96 Loss: 0.4252
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.35it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.37it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.97it/s]
Epoch 97 Loss: 0.4243
Epoch 98 Loss: 0.4233
Epoch 99 Loss: 0.4224
Epoch 100 Loss: 0.4214