/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
loading num parts:  2
loading num parts:  3
loading num parts:  4
num_shots is  1
num_shots is  1
Epoch 1 Loss: 1.1417 Alpha: tensor([0.5010, 0.5010, 0.5010, 0.5010, 0.5010, 0.5010, 0.5010],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 1 best val f1 0.3934 test f1 0.30675265192985535
Epoch 2 Loss: 0.7954 Alpha: tensor([0.5004, 0.5016, 0.5016, 0.5015, 0.5018, 0.5017, 0.5006],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 3 Loss: 0.6097 Alpha: tensor([0.4996, 0.5018, 0.5017, 0.5014, 0.5021, 0.5019, 0.4999],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 Loss: 0.5520 Alpha: tensor([0.4988, 0.5015, 0.5014, 0.5010, 0.5020, 0.5017, 0.4991],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 best val f1 0.4138 test f1 0.3068583607673645
Epoch 5 Loss: 0.5163 Alpha: tensor([0.4979, 0.5011, 0.5009, 0.5004, 0.5018, 0.5013, 0.4982],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 5 best val f1 0.4231 test f1 0.30692991614341736
Epoch 6 Loss: 0.4984 Alpha: tensor([0.4969, 0.5006, 0.5003, 0.4997, 0.5013, 0.5007, 0.4973],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 7 Loss: 0.4873 Alpha: tensor([0.4960, 0.4999, 0.4996, 0.4990, 0.5007, 0.5000, 0.4963],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 8 Loss: 0.4771 Alpha: tensor([0.4951, 0.4992, 0.4989, 0.4982, 0.5001, 0.4993, 0.4954],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 9 Loss: 0.4663 Alpha: tensor([0.4941, 0.4984, 0.4981, 0.4973, 0.4994, 0.4985, 0.4944],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 10 Loss: 0.4562 Alpha: tensor([0.4931, 0.4976, 0.4973, 0.4965, 0.4986, 0.4977, 0.4934],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 11 Loss: 0.4472 Alpha: tensor([0.4922, 0.4967, 0.4964, 0.4956, 0.4978, 0.4968, 0.4925],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 12 Loss: 0.4390 Alpha: tensor([0.4912, 0.4959, 0.4955, 0.4947, 0.4970, 0.4960, 0.4915],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 13 Loss: 0.4312 Alpha: tensor([0.4902, 0.4950, 0.4946, 0.4937, 0.4961, 0.4950, 0.4905],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 14 Loss: 0.4246 Alpha: tensor([0.4893, 0.4940, 0.4937, 0.4928, 0.4952, 0.4941, 0.4895],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 15 Loss: 0.4193 Alpha: tensor([0.4883, 0.4931, 0.4928, 0.4919, 0.4944, 0.4932, 0.4885],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 16 Loss: 0.4147 Alpha: tensor([0.4873, 0.4921, 0.4919, 0.4909, 0.4934, 0.4922, 0.4875],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 17 Loss: 0.4102 Alpha: tensor([0.4863, 0.4912, 0.4909, 0.4900, 0.4925, 0.4913, 0.4865],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 18 Loss: 0.4061 Alpha: tensor([0.4853, 0.4902, 0.4899, 0.4890, 0.4916, 0.4903, 0.4854],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 19 Loss: 0.4023 Alpha: tensor([0.4843, 0.4892, 0.4890, 0.4881, 0.4906, 0.4893, 0.4844],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 20 Loss: 0.3987 Alpha: tensor([0.4833, 0.4882, 0.4880, 0.4871, 0.4897, 0.4884, 0.4834],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 21 Loss: 0.3951 Alpha: tensor([0.4823, 0.4873, 0.4870, 0.4861, 0.4887, 0.4874, 0.4824],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 22 Loss: 0.3913 Alpha: tensor([0.4813, 0.4863, 0.4860, 0.4852, 0.4877, 0.4864, 0.4814],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 Loss: 0.3872 Alpha: tensor([0.4803, 0.4853, 0.4850, 0.4842, 0.4868, 0.4854, 0.4804],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 24 Loss: 0.3835 Alpha: tensor([0.4793, 0.4843, 0.4839, 0.4832, 0.4858, 0.4844, 0.4794],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 25 Loss: 0.3800 Alpha: tensor([0.4783, 0.4833, 0.4829, 0.4822, 0.4848, 0.4834, 0.4784],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 Loss: 0.3760 Alpha: tensor([0.4773, 0.4823, 0.4819, 0.4812, 0.4838, 0.4824, 0.4774],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 best val f1 0.4444 test f1 0.30811384320259094
Epoch 27 Loss: 0.3723 Alpha: tensor([0.4763, 0.4813, 0.4808, 0.4802, 0.4828, 0.4814, 0.4764],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 27 best val f1 0.5263 test f1 0.30805039405822754
Epoch 28 Loss: 0.3685 Alpha: tensor([0.4752, 0.4803, 0.4798, 0.4792, 0.4818, 0.4804, 0.4754],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 29 Loss: 0.3648 Alpha: tensor([0.4742, 0.4793, 0.4788, 0.4782, 0.4808, 0.4794, 0.4744],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 30 Loss: 0.3608 Alpha: tensor([0.4732, 0.4782, 0.4778, 0.4772, 0.4798, 0.4784, 0.4734],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 31 Loss: 0.3566 Alpha: tensor([0.4721, 0.4772, 0.4767, 0.4762, 0.4788, 0.4774, 0.4724],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 32 Loss: 0.3524 Alpha: tensor([0.4711, 0.4762, 0.4757, 0.4752, 0.4778, 0.4764, 0.4714],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 33 Loss: 0.3517 Alpha: tensor([0.4701, 0.4752, 0.4747, 0.4742, 0.4767, 0.4754, 0.4704],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 34 Loss: 0.3482 Alpha: tensor([0.4690, 0.4742, 0.4737, 0.4732, 0.4757, 0.4745, 0.4694],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 34 best val f1 0.5455 test f1 0.3097391724586487
Epoch 35 Loss: 0.3446 Alpha: tensor([0.4680, 0.4732, 0.4726, 0.4722, 0.4747, 0.4735, 0.4684],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 36 Loss: 0.3399 Alpha: tensor([0.4669, 0.4722, 0.4716, 0.4712, 0.4737, 0.4725, 0.4675],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 37 Loss: 0.3352 Alpha: tensor([0.4659, 0.4712, 0.4706, 0.4702, 0.4727, 0.4715, 0.4665],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 38 Loss: 0.3375 Alpha: tensor([0.4648, 0.4702, 0.4696, 0.4692, 0.4717, 0.4705, 0.4655],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 39 Loss: 0.3359 Alpha: tensor([0.4638, 0.4692, 0.4686, 0.4681, 0.4707, 0.4696, 0.4645],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 40 Loss: 0.3311 Alpha: tensor([0.4627, 0.4682, 0.4676, 0.4671, 0.4697, 0.4686, 0.4635],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 41 Loss: 0.3271 Alpha: tensor([0.4616, 0.4672, 0.4666, 0.4661, 0.4687, 0.4676, 0.4625],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 42 Loss: 0.3228 Alpha: tensor([0.4606, 0.4662, 0.4656, 0.4651, 0.4677, 0.4666, 0.4615],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 43 Loss: 0.3186 Alpha: tensor([0.4595, 0.4652, 0.4646, 0.4642, 0.4667, 0.4656, 0.4606],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 44 Loss: 0.3154 Alpha: tensor([0.4585, 0.4642, 0.4635, 0.4632, 0.4657, 0.4647, 0.4596],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 45 Loss: 0.3112 Alpha: tensor([0.4574, 0.4633, 0.4625, 0.4622, 0.4647, 0.4637, 0.4586],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 46 Loss: 0.3072 Alpha: tensor([0.4564, 0.4623, 0.4615, 0.4612, 0.4637, 0.4627, 0.4576],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 46 best val f1 0.5556 test f1 0.32558777928352356
Epoch 47 Loss: 0.3122 Alpha: tensor([0.4553, 0.4613, 0.4605, 0.4602, 0.4627, 0.4617, 0.4567],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 48 Loss: 0.3138 Alpha: tensor([0.4543, 0.4603, 0.4595, 0.4592, 0.4617, 0.4608, 0.4557],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 49 Loss: 0.3115 Alpha: tensor([0.4532, 0.4594, 0.4585, 0.4582, 0.4608, 0.4598, 0.4547],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 50 Loss: 0.3074 Alpha: tensor([0.4522, 0.4584, 0.4575, 0.4572, 0.4598, 0.4588, 0.4538],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 51 Loss: 0.3035 Alpha: tensor([0.4511, 0.4574, 0.4565, 0.4562, 0.4588, 0.4578, 0.4528],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 52 Loss: 0.3003 Alpha: tensor([0.4501, 0.4565, 0.4555, 0.4552, 0.4578, 0.4569, 0.4519],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 53 Loss: 0.2970 Alpha: tensor([0.4490, 0.4555, 0.4545, 0.4543, 0.4569, 0.4559, 0.4509],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 54 Loss: 0.2936 Alpha: tensor([0.4480, 0.4546, 0.4535, 0.4533, 0.4559, 0.4549, 0.4499],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 55 Loss: 0.2904 Alpha: tensor([0.4469, 0.4536, 0.4524, 0.4523, 0.4550, 0.4539, 0.4490],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 56 Loss: 0.2874 Alpha: tensor([0.4459, 0.4527, 0.4514, 0.4513, 0.4540, 0.4530, 0.4481],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 57 Loss: 0.2848 Alpha: tensor([0.4449, 0.4517, 0.4504, 0.4503, 0.4531, 0.4520, 0.4471],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 58 Loss: 0.2822 Alpha: tensor([0.4438, 0.4508, 0.4494, 0.4494, 0.4521, 0.4510, 0.4462],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 59 Loss: 0.2797 Alpha: tensor([0.4428, 0.4499, 0.4484, 0.4484, 0.4512, 0.4501, 0.4452],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 60 Loss: 0.2772 Alpha: tensor([0.4418, 0.4489, 0.4474, 0.4474, 0.4502, 0.4491, 0.4443],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 61 Loss: 0.2752 Alpha: tensor([0.4408, 0.4480, 0.4464, 0.4465, 0.4493, 0.4482, 0.4434],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 62 Loss: 0.2732 Alpha: tensor([0.4397, 0.4470, 0.4455, 0.4455, 0.4484, 0.4472, 0.4424],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 63 Loss: 0.2714 Alpha: tensor([0.4387, 0.4461, 0.4445, 0.4445, 0.4474, 0.4462, 0.4415],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 64 Loss: 0.2696 Alpha: tensor([0.4377, 0.4452, 0.4435, 0.4436, 0.4465, 0.4453, 0.4406],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 65 Loss: 0.2675 Alpha: tensor([0.4367, 0.4443, 0.4425, 0.4426, 0.4456, 0.4443, 0.4397],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 66 Loss: 0.2653 Alpha: tensor([0.4357, 0.4433, 0.4415, 0.4417, 0.4447, 0.4434, 0.4387],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 67 Loss: 0.2632 Alpha: tensor([0.4347, 0.4424, 0.4406, 0.4407, 0.4438, 0.4424, 0.4378],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 68 Loss: 0.2614 Alpha: tensor([0.4337, 0.4415, 0.4396, 0.4397, 0.4429, 0.4415, 0.4369],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 69 Loss: 0.2595 Alpha: tensor([0.4327, 0.4406, 0.4386, 0.4388, 0.4420, 0.4405, 0.4360],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 70 Loss: 0.2579 Alpha: tensor([0.4318, 0.4397, 0.4376, 0.4379, 0.4410, 0.4396, 0.4351],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 70 best val f1 0.5882 test f1 0.33066728711128235
Epoch 71 Loss: 0.2566 Alpha: tensor([0.4308, 0.4388, 0.4367, 0.4369, 0.4401, 0.4386, 0.4342],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 72 Loss: 0.2552 Alpha: tensor([0.4298, 0.4378, 0.4357, 0.4360, 0.4392, 0.4377, 0.4333],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 73 Loss: 0.2541 Alpha: tensor([0.4288, 0.4369, 0.4348, 0.4350, 0.4383, 0.4367, 0.4324],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 74 Loss: 0.2529 Alpha: tensor([0.4279, 0.4360, 0.4338, 0.4341, 0.4374, 0.4358, 0.4315],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 75 Loss: 0.2517 Alpha: tensor([0.4269, 0.4351, 0.4329, 0.4332, 0.4365, 0.4349, 0.4306],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 76 Loss: 0.2504 Alpha: tensor([0.4259, 0.4342, 0.4319, 0.4322, 0.4357, 0.4339, 0.4297],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 77 Loss: 0.2494 Alpha: tensor([0.4250, 0.4334, 0.4310, 0.4313, 0.4348, 0.4330, 0.4288],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 78 Loss: 0.2487 Alpha: tensor([0.4240, 0.4325, 0.4300, 0.4304, 0.4339, 0.4321, 0.4280],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 79 Loss: 0.2478 Alpha: tensor([0.4231, 0.4316, 0.4291, 0.4295, 0.4330, 0.4312, 0.4271],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 80 Loss: 0.2516 Alpha: tensor([0.4221, 0.4307, 0.4281, 0.4286, 0.4321, 0.4303, 0.4262],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 81 Loss: 0.2493 Alpha: tensor([0.4212, 0.4298, 0.4272, 0.4276, 0.4312, 0.4293, 0.4253],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 82 Loss: 0.2499 Alpha: tensor([0.4203, 0.4289, 0.4263, 0.4267, 0.4303, 0.4284, 0.4245],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 83 Loss: 0.2476 Alpha: tensor([0.4193, 0.4281, 0.4253, 0.4258, 0.4294, 0.4275, 0.4236],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 84 Loss: 0.2472 Alpha: tensor([0.4184, 0.4272, 0.4244, 0.4249, 0.4285, 0.4266, 0.4227],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 85 Loss: 0.2471 Alpha: tensor([0.4175, 0.4263, 0.4235, 0.4240, 0.4277, 0.4257, 0.4218],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 86 Loss: 0.2462 Alpha: tensor([0.4165, 0.4254, 0.4226, 0.4231, 0.4268, 0.4248, 0.4210],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 87 Loss: 0.2444 Alpha: tensor([0.4156, 0.4246, 0.4216, 0.4222, 0.4259, 0.4239, 0.4201],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 88 Loss: 0.2436 Alpha: tensor([0.4147, 0.4237, 0.4207, 0.4213, 0.4250, 0.4230, 0.4193],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 89 Loss: 0.2429 Alpha: tensor([0.4138, 0.4229, 0.4198, 0.4204, 0.4242, 0.4222, 0.4184],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 90 Loss: 0.2418 Alpha: tensor([0.4129, 0.4220, 0.4189, 0.4195, 0.4233, 0.4213, 0.4176],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 91 Loss: 0.2824 Alpha: tensor([0.4120, 0.4211, 0.4180, 0.4186, 0.4224, 0.4204, 0.4167],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 92 Loss: 0.3290 Alpha: tensor([0.4111, 0.4203, 0.4171, 0.4177, 0.4215, 0.4195, 0.4158],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 93 Loss: 0.3138 Alpha: tensor([0.4102, 0.4194, 0.4162, 0.4168, 0.4207, 0.4186, 0.4150],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 94 Loss: 0.3063 Alpha: tensor([0.4092, 0.4186, 0.4153, 0.4159, 0.4198, 0.4178, 0.4141],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 95 Loss: 0.3021 Alpha: tensor([0.4083, 0.4178, 0.4144, 0.4151, 0.4189, 0.4169, 0.4133],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 96 Loss: 0.2942 Alpha: tensor([0.4074, 0.4169, 0.4135, 0.4142, 0.4180, 0.4160, 0.4124],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 97 Loss: 0.2867 Alpha: tensor([0.4065, 0.4161, 0.4126, 0.4133, 0.4172, 0.4152, 0.4116],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 98 Loss: 0.2810 Alpha: tensor([0.4056, 0.4153, 0.4118, 0.4125, 0.4163, 0.4143, 0.4108],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 99 Loss: 0.2770 Alpha: tensor([0.4048, 0.4144, 0.4109, 0.4116, 0.4154, 0.4135, 0.4099],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 100 Loss: 0.2730 Alpha: tensor([0.4039, 0.4136, 0.4101, 0.4107, 0.4146, 0.4126, 0.4091],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 101 Loss: 0.2687 Alpha: tensor([0.4030, 0.4128, 0.4092, 0.4099, 0.4138, 0.4118, 0.4082],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 102 Loss: 0.2649 Alpha: tensor([0.4021, 0.4120, 0.4084, 0.4090, 0.4129, 0.4109, 0.4074],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 103 Loss: 0.2620 Alpha: tensor([0.4013, 0.4111, 0.4076, 0.4082, 0.4121, 0.4101, 0.4066],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 104 Loss: 0.2602 Alpha: tensor([0.4004, 0.4103, 0.4068, 0.4073, 0.4113, 0.4093, 0.4058],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 105 Loss: 0.2581 Alpha: tensor([0.3996, 0.4095, 0.4060, 0.4065, 0.4104, 0.4085, 0.4049],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 106 Loss: 0.2558 Alpha: tensor([0.3987, 0.4087, 0.4051, 0.4056, 0.4096, 0.4076, 0.4041],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 107 Loss: 0.2535 Alpha: tensor([0.3979, 0.4079, 0.4043, 0.4048, 0.4088, 0.4068, 0.4033],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 108 Loss: 0.2513 Alpha: tensor([0.3970, 0.4070, 0.4035, 0.4040, 0.4080, 0.4060, 0.4025],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 109 Loss: 0.2497 Alpha: tensor([0.3962, 0.4062, 0.4027, 0.4031, 0.4072, 0.4052, 0.4017],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 110 Loss: 0.2480 Alpha: tensor([0.3954, 0.4054, 0.4019, 0.4023, 0.4064, 0.4044, 0.4009],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 111 Loss: 0.2517 Alpha: tensor([0.3946, 0.4046, 0.4012, 0.4015, 0.4056, 0.4036, 0.4000],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 112 Loss: 0.2503 Alpha: tensor([0.3937, 0.4038, 0.4004, 0.4007, 0.4048, 0.4028, 0.3992],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 113 Loss: 0.2484 Alpha: tensor([0.3929, 0.4030, 0.3996, 0.3998, 0.4040, 0.4020, 0.3984],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 114 Loss: 0.2455 Alpha: tensor([0.3921, 0.4022, 0.3988, 0.3990, 0.4032, 0.4012, 0.3976],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 115 Loss: 0.2430 Alpha: tensor([0.3913, 0.4014, 0.3980, 0.3982, 0.4024, 0.4004, 0.3968],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 116 Loss: 0.2441 Alpha: tensor([0.3905, 0.4006, 0.3973, 0.3974, 0.4016, 0.3996, 0.3960],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 117 Loss: 0.2464 Alpha: tensor([0.3897, 0.3998, 0.3965, 0.3966, 0.4008, 0.3988, 0.3952],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 118 Loss: 0.2465 Alpha: tensor([0.3889, 0.3990, 0.3957, 0.3957, 0.4000, 0.3980, 0.3944],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 119 Loss: 0.2452 Alpha: tensor([0.3881, 0.3982, 0.3950, 0.3949, 0.3992, 0.3972, 0.3936],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 120 Loss: 0.2439 Alpha: tensor([0.3873, 0.3975, 0.3942, 0.3941, 0.3985, 0.3964, 0.3928],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 121 Loss: 0.2424 Alpha: tensor([0.3865, 0.3967, 0.3934, 0.3933, 0.3977, 0.3956, 0.3921],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 122 Loss: 0.2411 Alpha: tensor([0.3858, 0.3959, 0.3927, 0.3925, 0.3969, 0.3949, 0.3913],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 123 Loss: 0.2399 Alpha: tensor([0.3850, 0.3951, 0.3919, 0.3917, 0.3961, 0.3941, 0.3905],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 124 Loss: 0.2389 Alpha: tensor([0.3842, 0.3943, 0.3912, 0.3909, 0.3953, 0.3933, 0.3897],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 125 Loss: 0.2376 Alpha: tensor([0.3834, 0.3935, 0.3904, 0.3901, 0.3945, 0.3925, 0.3889],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 126 Loss: 0.2362 Alpha: tensor([0.3826, 0.3927, 0.3897, 0.3893, 0.3938, 0.3917, 0.3881],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 127 Loss: 0.2345 Alpha: tensor([0.3819, 0.3919, 0.3890, 0.3885, 0.3930, 0.3910, 0.3873],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 128 Loss: 0.2331 Alpha: tensor([0.3811, 0.3912, 0.3882, 0.3877, 0.3922, 0.3902, 0.3865],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 129 Loss: 0.2318 Alpha: tensor([0.3803, 0.3904, 0.3875, 0.3869, 0.3914, 0.3894, 0.3857],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 130 Loss: 0.2307 Alpha: tensor([0.3796, 0.3896, 0.3868, 0.3861, 0.3907, 0.3886, 0.3850],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 131 Loss: 0.2298 Alpha: tensor([0.3788, 0.3888, 0.3860, 0.3853, 0.3899, 0.3879, 0.3842],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 132 Loss: 0.2288 Alpha: tensor([0.3780, 0.3880, 0.3853, 0.3845, 0.3891, 0.3871, 0.3834],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 133 Loss: 0.2281 Alpha: tensor([0.3773, 0.3873, 0.3846, 0.3837, 0.3884, 0.3863, 0.3826],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 134 Loss: 0.2272 Alpha: tensor([0.3765, 0.3865, 0.3838, 0.3829, 0.3876, 0.3856, 0.3818],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 135 Loss: 0.2266 Alpha: tensor([0.3758, 0.3857, 0.3831, 0.3821, 0.3868, 0.3848, 0.3810],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 136 Loss: 0.2260 Alpha: tensor([0.3750, 0.3849, 0.3824, 0.3813, 0.3861, 0.3841, 0.3803],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 137 Loss: 0.2255 Alpha: tensor([0.3743, 0.3842, 0.3817, 0.3806, 0.3853, 0.3833, 0.3795],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 138 Loss: 0.2251 Alpha: tensor([0.3735, 0.3834, 0.3809, 0.3798, 0.3845, 0.3825, 0.3787],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 139 Loss: 0.2243 Alpha: tensor([0.3728, 0.3826, 0.3802, 0.3790, 0.3838, 0.3818, 0.3779],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 140 Loss: 0.2261 Alpha: tensor([0.3721, 0.3819, 0.3795, 0.3782, 0.3830, 0.3810, 0.3772],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 141 Loss: 0.2278 Alpha: tensor([0.3713, 0.3811, 0.3788, 0.3775, 0.3822, 0.3803, 0.3764],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 142 Loss: 0.2285 Alpha: tensor([0.3706, 0.3803, 0.3781, 0.3767, 0.3815, 0.3795, 0.3756],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 143 Loss: 0.2279 Alpha: tensor([0.3699, 0.3796, 0.3774, 0.3759, 0.3807, 0.3788, 0.3749],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 144 Loss: 0.2269 Alpha: tensor([0.3691, 0.3788, 0.3766, 0.3752, 0.3800, 0.3780, 0.3741],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 145 Loss: 0.2264 Alpha: tensor([0.3684, 0.3781, 0.3759, 0.3744, 0.3792, 0.3773, 0.3733],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 146 Loss: 0.2265 Alpha: tensor([0.3677, 0.3773, 0.3752, 0.3737, 0.3785, 0.3765, 0.3726],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 147 Loss: 0.2268 Alpha: tensor([0.3670, 0.3765, 0.3745, 0.3729, 0.3777, 0.3758, 0.3718],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 148 Loss: 0.2262 Alpha: tensor([0.3663, 0.3758, 0.3738, 0.3721, 0.3769, 0.3750, 0.3710],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 148 best val f1 0.6316 test f1 0.27551114559173584
Epoch 149 Loss: 0.2253 Alpha: tensor([0.3655, 0.3750, 0.3731, 0.3714, 0.3762, 0.3743, 0.3703],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 150 Loss: 0.2246 Alpha: tensor([0.3648, 0.3743, 0.3724, 0.3706, 0.3754, 0.3735, 0.3695],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 151 Loss: 0.2247 Alpha: tensor([0.3641, 0.3735, 0.3717, 0.3699, 0.3747, 0.3728, 0.3688],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 152 Loss: 0.2243 Alpha: tensor([0.3634, 0.3728, 0.3710, 0.3691, 0.3739, 0.3721, 0.3680],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 153 Loss: 0.2293 Alpha: tensor([0.3627, 0.3720, 0.3704, 0.3684, 0.3732, 0.3713, 0.3672],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 154 Loss: 0.2258 Alpha: tensor([0.3620, 0.3713, 0.3697, 0.3676, 0.3725, 0.3706, 0.3665],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 155 Loss: 0.2296 Alpha: tensor([0.3613, 0.3705, 0.3690, 0.3669, 0.3717, 0.3698, 0.3657],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 156 Loss: 0.2307 Alpha: tensor([0.3606, 0.3698, 0.3683, 0.3662, 0.3710, 0.3691, 0.3650],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 157 Loss: 0.2293 Alpha: tensor([0.3599, 0.3690, 0.3676, 0.3654, 0.3702, 0.3684, 0.3642],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 158 Loss: 0.2283 Alpha: tensor([0.3592, 0.3683, 0.3669, 0.3647, 0.3695, 0.3676, 0.3635],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 159 Loss: 0.2267 Alpha: tensor([0.3585, 0.3676, 0.3663, 0.3640, 0.3688, 0.3669, 0.3627],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 160 Loss: 0.2252 Alpha: tensor([0.3578, 0.3668, 0.3656, 0.3632, 0.3680, 0.3662, 0.3620],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 161 Loss: 0.2239 Alpha: tensor([0.3571, 0.3661, 0.3649, 0.3625, 0.3673, 0.3655, 0.3612],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 162 Loss: 0.2229 Alpha: tensor([0.3565, 0.3653, 0.3642, 0.3618, 0.3666, 0.3648, 0.3605],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 163 Loss: 0.2219 Alpha: tensor([0.3558, 0.3646, 0.3636, 0.3611, 0.3658, 0.3640, 0.3597],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 164 Loss: 0.2213 Alpha: tensor([0.3551, 0.3639, 0.3629, 0.3603, 0.3651, 0.3633, 0.3590],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 165 Loss: 0.2203 Alpha: tensor([0.3544, 0.3631, 0.3622, 0.3596, 0.3644, 0.3626, 0.3582],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 166 Loss: 0.2193 Alpha: tensor([0.3537, 0.3624, 0.3616, 0.3589, 0.3637, 0.3619, 0.3575],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 167 Loss: 0.2182 Alpha: tensor([0.3530, 0.3617, 0.3609, 0.3582, 0.3629, 0.3612, 0.3567],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 168 Loss: 0.2171 Alpha: tensor([0.3524, 0.3609, 0.3603, 0.3575, 0.3622, 0.3605, 0.3560],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 169 Loss: 0.2288 Alpha: tensor([0.3517, 0.3602, 0.3596, 0.3568, 0.3615, 0.3598, 0.3552],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 170 Loss: 0.2419 Alpha: tensor([0.3510, 0.3594, 0.3589, 0.3561, 0.3608, 0.3590, 0.3545],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 171 Loss: 0.2396 Alpha: tensor([0.3503, 0.3587, 0.3583, 0.3553, 0.3601, 0.3583, 0.3538],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 172 Loss: 0.2366 Alpha: tensor([0.3497, 0.3580, 0.3576, 0.3546, 0.3593, 0.3576, 0.3530],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 173 Loss: 0.2335 Alpha: tensor([0.3490, 0.3573, 0.3570, 0.3539, 0.3586, 0.3569, 0.3523],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 174 Loss: 0.2304 Alpha: tensor([0.3483, 0.3565, 0.3563, 0.3532, 0.3579, 0.3562, 0.3515],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 175 Loss: 0.2282 Alpha: tensor([0.3477, 0.3558, 0.3557, 0.3525, 0.3572, 0.3556, 0.3508],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 176 Loss: 0.2262 Alpha: tensor([0.3470, 0.3551, 0.3551, 0.3518, 0.3565, 0.3549, 0.3501],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 177 Loss: 0.3046 Alpha: tensor([0.3463, 0.3543, 0.3544, 0.3511, 0.3558, 0.3542, 0.3493],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 178 Loss: 0.3743 Alpha: tensor([0.3457, 0.3536, 0.3538, 0.3504, 0.3550, 0.3535, 0.3486],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 179 Loss: 0.3833 Alpha: tensor([0.3450, 0.3529, 0.3531, 0.3497, 0.3543, 0.3528, 0.3479],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 180 Loss: 0.3848 Alpha: tensor([0.3443, 0.3522, 0.3524, 0.3490, 0.3535, 0.3521, 0.3472],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 181 Loss: 0.3783 Alpha: tensor([0.3437, 0.3514, 0.3518, 0.3483, 0.3528, 0.3514, 0.3464],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 182 Loss: 0.3880 Alpha: tensor([0.3430, 0.3507, 0.3511, 0.3476, 0.3521, 0.3507, 0.3457],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 183 Loss: 0.3926 Alpha: tensor([0.3423, 0.3500, 0.3504, 0.3469, 0.3513, 0.3500, 0.3450],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 184 Loss: 0.3968 Alpha: tensor([0.3417, 0.3493, 0.3497, 0.3462, 0.3506, 0.3493, 0.3443],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 185 Loss: 0.3994 Alpha: tensor([0.3410, 0.3486, 0.3490, 0.3455, 0.3499, 0.3486, 0.3435],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 186 Loss: 0.3970 Alpha: tensor([0.3404, 0.3479, 0.3484, 0.3448, 0.3491, 0.3480, 0.3428],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 187 Loss: 0.3919 Alpha: tensor([0.3397, 0.3472, 0.3477, 0.3441, 0.3484, 0.3473, 0.3421],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 188 Loss: 0.3826 Alpha: tensor([0.3390, 0.3464, 0.3470, 0.3434, 0.3477, 0.3466, 0.3414],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 189 Loss: 0.3744 Alpha: tensor([0.3384, 0.3457, 0.3463, 0.3427, 0.3469, 0.3459, 0.3407],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 190 Loss: 0.3650 Alpha: tensor([0.3377, 0.3450, 0.3456, 0.3420, 0.3462, 0.3453, 0.3400],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 191 Loss: 0.3569 Alpha: tensor([0.3371, 0.3443, 0.3449, 0.3414, 0.3455, 0.3446, 0.3394],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 192 Loss: 0.3495 Alpha: tensor([0.3364, 0.3436, 0.3443, 0.3407, 0.3447, 0.3440, 0.3387],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 193 Loss: 0.3423 Alpha: tensor([0.3358, 0.3430, 0.3436, 0.3400, 0.3440, 0.3433, 0.3380],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 194 Loss: 0.3351 Alpha: tensor([0.3351, 0.3423, 0.3429, 0.3394, 0.3433, 0.3427, 0.3373],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 195 Loss: 0.3283 Alpha: tensor([0.3345, 0.3416, 0.3423, 0.3387, 0.3426, 0.3420, 0.3366],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 196 Loss: 0.3221 Alpha: tensor([0.3338, 0.3409, 0.3417, 0.3380, 0.3419, 0.3414, 0.3359],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 197 Loss: 0.3161 Alpha: tensor([0.3332, 0.3402, 0.3411, 0.3374, 0.3412, 0.3408, 0.3353],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 198 Loss: 0.3105 Alpha: tensor([0.3325, 0.3395, 0.3405, 0.3368, 0.3404, 0.3402, 0.3346],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 199 Loss: 0.3051 Alpha: tensor([0.3319, 0.3387, 0.3399, 0.3361, 0.3397, 0.3395, 0.3339],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 200 Loss: 0.2996 Alpha: tensor([0.3312, 0.3380, 0.3393, 0.3355, 0.3391, 0.3389, 0.3332],
       device='cuda:0', grad_fn=<SelectBackward0>)