/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  0
num_shots is  1
num_shots is  1
Epoch 1 Loss: 1.1316
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 10.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.03it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 1 best val f1 0.1176 test f1 0.23827965557575226
Epoch 2 Loss: 0.2854
Epoch 3 Loss: -0.0889
Epoch 3 best val f1 0.2857 test f1 0.4048551917076111
Epoch 4 Loss: -0.1887
Epoch 5 Loss: -0.2154
Epoch 5 best val f1 0.3000 test f1 0.47375261783599854
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.40it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.10it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.03it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.44it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.44it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.44it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.41it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.49it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 6 best val f1 0.3810 test f1 0.49401727318763733
Epoch 7 Loss: -0.2657
Epoch 8 Loss: -0.2866
Epoch 9 Loss: -0.3090
Epoch 10 Loss: -0.3332
Epoch 11 Loss: -0.3568
Epoch 12 Loss: -0.3792
Epoch 13 Loss: -0.4019
Epoch 14 Loss: -0.4252
Epoch 15 Loss: -0.4490
Epoch 16 Loss: -0.4733
Epoch 17 Loss: -0.4981
Epoch 18 Loss: -0.5234
Epoch 19 Loss: -0.5489
Epoch 20 Loss: -0.5740
Epoch 21 Loss: -0.5986
Epoch 22 Loss: -0.6230
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.60it/s]
Epoch 24 Loss: -0.6729
Epoch 25 Loss: -0.6986
Epoch 26 Loss: -0.7244
Epoch 27 Loss: -0.7501
Epoch 28 Loss: -0.7756
Epoch 29 Loss: -0.8013
Epoch 30 Loss: -0.8273
Epoch 31 Loss: -0.8535
Epoch 32 Loss: -0.8798
Epoch 33 Loss: -0.9064
Epoch 34 Loss: -0.9332
Epoch 35 Loss: -0.9601
Epoch 36 Loss: -0.9871
Epoch 37 Loss: -1.0142
Epoch 38 Loss: -1.0414
Epoch 39 Loss: -1.0691
Epoch 40 Loss: -1.0971
Epoch 41 Loss: -1.1254
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.47it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.12it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.68it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 42 Loss: -1.1544
Epoch 43 Loss: -1.1838
Epoch 44 Loss: -1.2136
Epoch 45 Loss: -1.2439
Epoch 46 Loss: -1.2745
Epoch 47 Loss: -1.3055
Epoch 48 Loss: -1.3368
Epoch 49 Loss: -1.3685
Epoch 50 Loss: -1.4009
Epoch 51 Loss: -1.4342
Epoch 52 Loss: -1.4704
Epoch 53 Loss: -1.5084
Epoch 54 Loss: -1.5502
Epoch 55 Loss: -1.5943
Epoch 56 Loss: -1.6402
Epoch 57 Loss: -1.6853
Epoch 58 Loss: -1.7294
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
Epoch 60 Loss: -1.8175
Epoch 61 Loss: -1.8601
Epoch 62 Loss: -1.9021
Epoch 63 Loss: -1.9438
Epoch 64 Loss: -1.9853
Epoch 65 Loss: -2.0280
Epoch 66 Loss: -2.0714
Epoch 67 Loss: -2.1149
Epoch 68 Loss: -2.1587
Epoch 68 best val f1 0.3902 test f1 0.39084887504577637
Epoch 69 Loss: -2.2028
Epoch 70 Loss: -2.2470
Epoch 71 Loss: -2.2914
Epoch 72 Loss: -2.3359
Epoch 73 Loss: -2.3806
Epoch 74 Loss: -2.4257
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.38it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.67it/s]
Epoch 75 Loss: -2.4709
Epoch 76 Loss: -2.5165
Epoch 77 Loss: -2.5623
Epoch 78 Loss: -2.6083
Epoch 79 Loss: -2.6545
Epoch 80 Loss: -2.7012
Epoch 81 Loss: -2.7492
Epoch 82 Loss: -2.8037
Epoch 83 Loss: -2.8725
Epoch 84 Loss: -2.9483
Epoch 85 Loss: -3.0274
Epoch 86 Loss: -3.0998
Epoch 87 Loss: -3.1671
Epoch 88 Loss: -3.2317
Epoch 89 Loss: -3.2949
Epoch 90 Loss: -3.3583
Epoch 91 Loss: -3.4218
Epoch 92 Loss: -3.4849
Epoch 93 Loss: -3.5477
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.45it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.51it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.48it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.47it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.45it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
Epoch 94 Loss: -3.6101
Epoch 95 Loss: -3.6719
Epoch 96 Loss: -3.7337
Epoch 97 Loss: -3.7955
Epoch 98 Loss: -3.8572
Epoch 99 Loss: -3.9192
Epoch 100 Loss: -3.9816