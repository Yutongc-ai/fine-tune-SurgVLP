/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.41it/s]
num_shots is  4
num_shots is  4
Epoch 1 Loss: 0.6960
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
Epoch 1 best val f1 0.2090 test f1 0.43993204832077026
Epoch 2 Loss: 0.6899
Epoch 3 Loss: 0.6839
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.75it/s]
Epoch 4 Loss: 0.6780
Epoch 5 Loss: 0.6722
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.75it/s]
Epoch 5 best val f1 0.2385 test f1 0.4451940953731537
Epoch 6 Loss: 0.6666
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.59it/s]
Epoch 6 best val f1 0.2400 test f1 0.4451940953731537
Epoch 7 Loss: 0.6610
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.69it/s]
Epoch 7 best val f1 0.3043 test f1 0.4451940953731537
Epoch 8 Loss: 0.6556
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
Epoch 8 best val f1 0.3441 test f1 0.4451940953731537
Epoch 9 Loss: 0.6503
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.60it/s]
Epoch 9 best val f1 0.3820 test f1 0.4451940953731537
Epoch 10 Loss: 0.6452
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
Epoch 10 best val f1 0.4186 test f1 0.4451940953731537
Epoch 11 Loss: 0.6401
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.69it/s]
Epoch 11 best val f1 0.4419 test f1 0.4451940953731537
Epoch 12 Loss: 0.6352
Epoch 13 Loss: 0.6304
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.61it/s]
Epoch 13 best val f1 0.4578 test f1 0.4451940953731537
Epoch 14 Loss: 0.6257
Epoch 14 best val f1 0.4634 test f1 0.4451940953731537
Epoch 15 Loss: 0.6212
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
Epoch 16 Loss: 0.6167
Epoch 16 best val f1 0.4878 test f1 0.4451940953731537
Epoch 17 Loss: 0.6124
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.62it/s]
Epoch 18 Loss: 0.6082
Epoch 19 Loss: 0.6041
Epoch 20 Loss: 0.6002
Epoch 21 Loss: 0.5963
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 22 Loss: 0.5926
Epoch 23 Loss: 0.5890
Epoch 24 Loss: 0.5854
Epoch 25 Loss: 0.5820
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
Epoch 27 Loss: 0.5755
Epoch 28 Loss: 0.5724
Epoch 29 Loss: 0.5694
Epoch 30 Loss: 0.5665
Epoch 31 Loss: 0.5637
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
Epoch 32 Loss: 0.5609
Epoch 33 Loss: 0.5583
Epoch 34 Loss: 0.5557
Epoch 35 Loss: 0.5533
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.63it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 36 Loss: 0.5509
Epoch 37 Loss: 0.5485
Epoch 38 Loss: 0.5463
Epoch 39 Loss: 0.5441
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 41 Loss: 0.5400
Epoch 42 Loss: 0.5380
Epoch 43 Loss: 0.5361
Epoch 44 Loss: 0.5343
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
Epoch 46 Loss: 0.5308
Epoch 47 Loss: 0.5291
Epoch 48 Loss: 0.5275
Epoch 49 Loss: 0.5259
Epoch 50 Loss: 0.5244
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.50it/s]
Epoch 51 Loss: 0.5229
Epoch 52 Loss: 0.5215
Epoch 53 Loss: 0.5201
Epoch 54 Loss: 0.5188
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.69it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 55 Loss: 0.5175
Epoch 56 Loss: 0.5163
Epoch 57 Loss: 0.5150
Epoch 58 Loss: 0.5138
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
Epoch 60 Loss: 0.5116
Epoch 61 Loss: 0.5105
Epoch 62 Loss: 0.5094
Epoch 63 Loss: 0.5084
Epoch 64 Loss: 0.5074
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.58it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 65 Loss: 0.5064
Epoch 66 Loss: 0.5055
Epoch 67 Loss: 0.5046
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.39it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
Epoch 69 Loss: 0.5028
Epoch 70 Loss: 0.5019
Epoch 71 Loss: 0.5011
Epoch 72 Loss: 0.5003
Epoch 73 Loss: 0.4995
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 74 Loss: 0.4987
Epoch 75 Loss: 0.4979
Epoch 76 Loss: 0.4972
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.45it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.75it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 78 Loss: 0.4958
Epoch 79 Loss: 0.4950
Epoch 80 Loss: 0.4944
Epoch 81 Loss: 0.4937
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
Epoch 83 Loss: 0.4924
Epoch 84 Loss: 0.4917
Epoch 85 Loss: 0.4911
Epoch 86 Loss: 0.4905
Epoch 87 Loss: 0.4899
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.29it/s]
Epoch 88 Loss: 0.4893
Epoch 89 Loss: 0.4887
Epoch 90 Loss: 0.4881
Epoch 91 Loss: 0.4875
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.58it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 92 Loss: 0.4869
Epoch 93 Loss: 0.4864
Epoch 94 Loss: 0.4858
Epoch 95 Loss: 0.4853
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.24it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 97 Loss: 0.4842
Epoch 98 Loss: 0.4837
Epoch 99 Loss: 0.4831
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.72it/s]