/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.51it/s]
num_shots is  1
num_shots is  1
Epoch 1 Loss: 1.7297
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 12.48it/s]
Epoch 1 best val f1 0.2000 test f1 0.24345330893993378
Epoch 2 Loss: 0.4904
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.67it/s]
Epoch 2 best val f1 0.2353 test f1 0.3070523738861084
Epoch 3 Loss: -0.0518
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.69it/s]
Epoch 3 best val f1 0.4211 test f1 0.39316797256469727
Epoch 4 Loss: -0.2959
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.07it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.71it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 4 best val f1 0.5000 test f1 0.4400233030319214
Epoch 5 Loss: -0.3471
Epoch 6 Loss: -0.3672
Epoch 7 Loss: -0.3844
Epoch 8 Loss: -0.4006
Epoch 9 Loss: -0.4160
Epoch 10 Loss: -0.4303
Epoch 11 Loss: -0.4435
Epoch 12 Loss: -0.4580
Epoch 13 Loss: -0.4739
Epoch 14 Loss: -0.4893
Epoch 15 Loss: -0.5040
Epoch 16 Loss: -0.5185
Epoch 17 Loss: -0.5328
Epoch 18 Loss: -0.5470
Epoch 19 Loss: -0.5612
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.14it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.01it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.45it/s]
Epoch 21 Loss: -0.5894
Epoch 22 Loss: -0.6034
Epoch 23 Loss: -0.6174
Epoch 24 Loss: -0.6313
Epoch 25 Loss: -0.6451
Epoch 26 Loss: -0.6587
Epoch 27 Loss: -0.6723
Epoch 28 Loss: -0.6857
Epoch 29 Loss: -0.6989
Epoch 30 Loss: -0.7119