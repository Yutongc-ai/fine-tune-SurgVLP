/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
num_shots is  1
num_shots is  1
Epoch 1 Loss: 1.0644
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.05it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.71it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 1 best val f1 0.2353 test f1 0.1151527464389801
Epoch 2 Loss: 0.1735
Epoch 3 Loss: -0.1134
Epoch 4 Loss: -0.1526
Epoch 5 Loss: -0.1895
Epoch 6 Loss: -0.2175
Epoch 7 Loss: -0.2395
Epoch 8 Loss: -0.2597
Epoch 9 Loss: -0.2797
Epoch 10 Loss: -0.2997
Epoch 11 Loss: -0.3196
Epoch 12 Loss: -0.3393
Epoch 13 Loss: -0.3588
Epoch 14 Loss: -0.3780
Epoch 15 Loss: -0.3971
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.05it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.35it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.96it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.14it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.32it/s]
Epoch 16 best val f1 0.3000 test f1 0.5133283734321594
Epoch 17 Loss: -0.4358
Epoch 18 Loss: -0.4553
Epoch 19 Loss: -0.4746
Epoch 20 Loss: -0.4940
Epoch 21 Loss: -0.5137
Epoch 22 Loss: -0.5338
Epoch 23 Loss: -0.5540
Epoch 23 best val f1 0.3636 test f1 0.5127328038215637
Epoch 24 Loss: -0.5743
Epoch 25 Loss: -0.5946
Epoch 26 Loss: -0.6148
Epoch 27 Loss: -0.6348
Epoch 28 Loss: -0.6548
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.04it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.08it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.95it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 29 Loss: -0.6745
Epoch 30 Loss: -0.6942
Epoch 31 Loss: -0.7137
Epoch 31 best val f1 0.4000 test f1 0.5225299596786499
Epoch 32 Loss: -0.7332
Epoch 33 Loss: -0.7527
Epoch 34 Loss: -0.7722
Epoch 35 Loss: -0.7918
Epoch 36 Loss: -0.8115
Epoch 37 Loss: -0.8311
Epoch 38 Loss: -0.8508
Epoch 38 best val f1 0.4375 test f1 0.48041972517967224
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.07it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.12it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.00it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.06it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.76it/s]
Epoch 40 Loss: -0.8903
Epoch 41 Loss: -0.9101
Epoch 42 Loss: -0.9300
Epoch 43 Loss: -0.9500
Epoch 44 Loss: -0.9703
Epoch 45 Loss: -0.9906
Epoch 45 best val f1 0.4444 test f1 0.4291646182537079
Epoch 46 Loss: -1.0111
Epoch 47 Loss: -1.0318
Epoch 48 Loss: -1.0526
Epoch 49 Loss: -1.0736
Epoch 49 best val f1 0.4865 test f1 0.40757033228874207
Epoch 50 Loss: -1.0949
Epoch 51 Loss: -1.1173
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.03it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.96it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.79it/s]
Epoch 52 Loss: -1.1420
Epoch 53 Loss: -1.1679
Epoch 54 Loss: -1.1944
Epoch 55 Loss: -1.2202
Epoch 56 Loss: -1.2444
Epoch 56 best val f1 0.5000 test f1 0.37877005338668823
Epoch 57 Loss: -1.2691
Epoch 58 Loss: -1.2956
Epoch 59 Loss: -1.3217
Epoch 60 Loss: -1.3475
Epoch 61 Loss: -1.3733
Epoch 62 Loss: -1.3990
Epoch 63 Loss: -1.4249
Epoch 64 Loss: -1.4510
Epoch 65 Loss: -1.4774
Epoch 66 Loss: -1.5040
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.11it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.14it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.02it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.27it/s]
Epoch 67 Loss: -1.5308
Epoch 68 Loss: -1.5578
Epoch 69 Loss: -1.5851
Epoch 70 Loss: -1.6124
Epoch 71 Loss: -1.6400
Epoch 72 Loss: -1.6676
Epoch 73 Loss: -1.6954
Epoch 74 Loss: -1.7233
Epoch 75 Loss: -1.7513
Epoch 76 Loss: -1.7795
Epoch 77 Loss: -1.8079
Epoch 78 Loss: -1.8364
Epoch 79 Loss: -1.8650
Epoch 80 Loss: -1.8938
Epoch 81 Loss: -1.9227
Epoch 82 Loss: -1.9518
Epoch 83 Loss: -1.9809
Epoch 84 Loss: -2.0102
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.13it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.07it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.10it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.11it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.73it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 85 Loss: -2.0397
Epoch 86 Loss: -2.0692
Epoch 87 Loss: -2.0990
Epoch 88 Loss: -2.1288
Epoch 89 Loss: -2.1588
Epoch 90 Loss: -2.1889
Epoch 91 Loss: -2.2191
Epoch 92 Loss: -2.2494
Epoch 93 Loss: -2.2799
Epoch 94 Loss: -2.3105
Epoch 95 Loss: -2.3412
Epoch 96 Loss: -2.3720
Epoch 97 Loss: -2.4029
Epoch 98 Loss: -2.4343
Epoch 99 Loss: -2.4727
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]