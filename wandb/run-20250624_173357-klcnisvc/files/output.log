/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  0
num_shots is  4
num_shots is  4
Epoch 1 Loss: 0.8165
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.43it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.62it/s]
Epoch 1 best val f1 0.2785 test f1 0.24818062782287598
Epoch 2 Loss: 0.0436
Epoch 2 best val f1 0.4471 test f1 0.396279513835907
Epoch 3 Loss: -0.2692
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.59it/s]
Epoch 4 Loss: -0.3561
Epoch 5 Loss: -0.4203
Epoch 5 best val f1 0.4828 test f1 0.4766433537006378
Epoch 6 Loss: -0.4765
Epoch 7 Loss: -0.5280
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
Epoch 8 Loss: -0.5780
Epoch 9 Loss: -0.6288
Epoch 10 Loss: -0.6806
Epoch 11 Loss: -0.7333
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 12 Loss: -0.7862
Epoch 13 Loss: -0.8400
Epoch 14 Loss: -0.8948
Epoch 15 Loss: -0.9506
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
Epoch 16 Loss: -1.0077
Epoch 17 Loss: -1.0662
Epoch 18 Loss: -1.1255
Epoch 19 Loss: -1.1858
Epoch 20 Loss: -1.2470
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
Epoch 21 Loss: -1.3090
Epoch 22 Loss: -1.3720
Epoch 23 Loss: -1.4361
Epoch 24 Loss: -1.5014
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 25 Loss: -1.5682
Epoch 26 Loss: -1.6361
Epoch 27 Loss: -1.7051
Epoch 28 Loss: -1.7751
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.62it/s]
Epoch 30 Loss: -1.9168
Epoch 31 Loss: -1.9887
Epoch 32 Loss: -2.0614
Epoch 33 Loss: -2.1354
Epoch 34 Loss: -2.2111
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 35 Loss: -2.2882
Epoch 36 Loss: -2.3660
Epoch 37 Loss: -2.4446
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 39 Loss: -2.6026
Epoch 40 Loss: -2.6829
Epoch 41 Loss: -2.7636
Epoch 42 Loss: -2.8453
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
Epoch 44 Loss: -3.0099
Epoch 45 Loss: -3.0933
Epoch 46 Loss: -3.1772
Epoch 47 Loss: -3.2616
Epoch 48 Loss: -3.3467
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 49 Loss: -3.4325
Epoch 50 Loss: -3.5187
Epoch 51 Loss: -3.6053
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.61it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 53 Loss: -3.7799
Epoch 54 Loss: -3.8674
Epoch 55 Loss: -3.9553
Epoch 56 Loss: -4.0440
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
Epoch 58 Loss: -4.2220
Epoch 59 Loss: -4.3119
Epoch 60 Loss: -4.4018
Epoch 61 Loss: -4.4920
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 62 Loss: -4.5835
Epoch 63 Loss: -4.6739
Epoch 64 Loss: -4.7628
Epoch 65 Loss: -4.8623
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 67 Loss: -5.0623
Epoch 68 Loss: -5.1654
Epoch 69 Loss: -5.2629
Epoch 70 Loss: -5.3679
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
Epoch 72 Loss: -5.5724
Epoch 73 Loss: -5.6613
Epoch 74 Loss: -5.7653
Epoch 75 Loss: -5.8783
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.38it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 76 Loss: -5.9618
Epoch 77 Loss: -6.0886
Epoch 78 Loss: -6.1862
Epoch 79 Loss: -6.2907
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.63it/s]
Epoch 81 Loss: -6.5209
Epoch 82 Loss: -6.6556
Epoch 83 Loss: -6.7697
Epoch 84 Loss: -6.8854
Epoch 85 Loss: -6.9979
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
Epoch 86 Loss: -7.1104
Epoch 87 Loss: -7.2224
Epoch 88 Loss: -7.3369
Epoch 89 Loss: -7.4518
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.66it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 90 Loss: -7.5690
Epoch 91 Loss: -7.6852
Epoch 92 Loss: -7.7987
Epoch 93 Loss: -7.9202
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
Epoch 95 Loss: -8.1688
Epoch 96 Loss: -8.2893
Epoch 97 Loss: -8.4122
Epoch 98 Loss: -8.5351
Epoch 99 Loss: -8.6579
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.67it/s]
Epoch 100 Loss: -8.7835