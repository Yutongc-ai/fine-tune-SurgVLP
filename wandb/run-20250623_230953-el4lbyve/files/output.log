/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
num_shots is  4
num_shots is  4
Epoch 1 Loss: 0.8502 Alpha: tensor([0.4990, 0.4990, 0.4990, 0.4990, 0.4990, 0.4990, 0.4990],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 1 best val f1 0.3934 test f1 0.3057743310928345
Epoch 2 Loss: 0.8362 Alpha: tensor([0.4980, 0.4980, 0.4980, 0.4980, 0.4980, 0.4980, 0.4980],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 3 Loss: 0.8235 Alpha: tensor([0.4970, 0.4970, 0.4970, 0.4970, 0.4970, 0.4970, 0.4970],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 Loss: 0.8119 Alpha: tensor([0.4960, 0.4960, 0.4960, 0.4960, 0.4960, 0.4960, 0.4960],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 5 Loss: 0.8013 Alpha: tensor([0.4950, 0.4950, 0.4950, 0.4950, 0.4950, 0.4950, 0.4950],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 6 Loss: 0.7916 Alpha: tensor([0.4940, 0.4940, 0.4940, 0.4940, 0.4940, 0.4940, 0.4940],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 7 Loss: 0.7825 Alpha: tensor([0.4930, 0.4930, 0.4930, 0.4929, 0.4930, 0.4930, 0.4930],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 8 Loss: 0.7740 Alpha: tensor([0.4920, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 9 Loss: 0.7676 Alpha: tensor([0.4910, 0.4909, 0.4909, 0.4909, 0.4909, 0.4909, 0.4909],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 10 Loss: 0.7619 Alpha: tensor([0.4900, 0.4899, 0.4899, 0.4899, 0.4899, 0.4899, 0.4899],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 11 Loss: 0.7567 Alpha: tensor([0.4890, 0.4889, 0.4889, 0.4888, 0.4889, 0.4889, 0.4889],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 12 Loss: 0.7518 Alpha: tensor([0.4880, 0.4879, 0.4879, 0.4878, 0.4878, 0.4878, 0.4878],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 13 Loss: 0.7471 Alpha: tensor([0.4870, 0.4868, 0.4868, 0.4867, 0.4868, 0.4868, 0.4868],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 14 Loss: 0.7428 Alpha: tensor([0.4860, 0.4858, 0.4858, 0.4857, 0.4857, 0.4858, 0.4858],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 15 Loss: 0.7386 Alpha: tensor([0.4850, 0.4848, 0.4848, 0.4846, 0.4847, 0.4847, 0.4847],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 16 Loss: 0.7345 Alpha: tensor([0.4840, 0.4837, 0.4837, 0.4836, 0.4836, 0.4837, 0.4837],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 17 Loss: 0.7306 Alpha: tensor([0.4830, 0.4827, 0.4827, 0.4825, 0.4826, 0.4826, 0.4826],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 18 Loss: 0.7268 Alpha: tensor([0.4820, 0.4816, 0.4816, 0.4814, 0.4815, 0.4816, 0.4816],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 19 Loss: 0.7231 Alpha: tensor([0.4810, 0.4806, 0.4806, 0.4804, 0.4805, 0.4805, 0.4805],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 20 Loss: 0.7195 Alpha: tensor([0.4800, 0.4795, 0.4795, 0.4793, 0.4794, 0.4795, 0.4795],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 21 Loss: 0.7160 Alpha: tensor([0.4790, 0.4785, 0.4785, 0.4782, 0.4783, 0.4784, 0.4784],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 21 best val f1 0.3951 test f1 0.3057771325111389
Epoch 22 Loss: 0.7126 Alpha: tensor([0.4780, 0.4774, 0.4774, 0.4771, 0.4773, 0.4774, 0.4774],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 Loss: 0.7093 Alpha: tensor([0.4770, 0.4764, 0.4764, 0.4760, 0.4762, 0.4763, 0.4763],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 best val f1 0.3967 test f1 0.3057785630226135
Epoch 24 Loss: 0.7061 Alpha: tensor([0.4760, 0.4753, 0.4753, 0.4749, 0.4751, 0.4752, 0.4753],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 24 best val f1 0.3983 test f1 0.3057785630226135
Epoch 25 Loss: 0.7030 Alpha: tensor([0.4750, 0.4743, 0.4743, 0.4738, 0.4740, 0.4742, 0.4742],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 Loss: 0.7001 Alpha: tensor([0.4740, 0.4732, 0.4732, 0.4727, 0.4730, 0.4731, 0.4731],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 27 Loss: 0.6973 Alpha: tensor([0.4730, 0.4721, 0.4722, 0.4716, 0.4719, 0.4720, 0.4721],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 28 Loss: 0.6945 Alpha: tensor([0.4720, 0.4711, 0.4711, 0.4705, 0.4708, 0.4709, 0.4710],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 29 Loss: 0.6918 Alpha: tensor([0.4710, 0.4700, 0.4701, 0.4694, 0.4697, 0.4699, 0.4699],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 30 Loss: 0.6892 Alpha: tensor([0.4701, 0.4689, 0.4690, 0.4683, 0.4686, 0.4688, 0.4688],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 30 best val f1 0.4017 test f1 0.30582401156425476
Epoch 31 Loss: 0.6866 Alpha: tensor([0.4691, 0.4679, 0.4679, 0.4672, 0.4675, 0.4677, 0.4678],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 32 Loss: 0.6842 Alpha: tensor([0.4681, 0.4668, 0.4669, 0.4661, 0.4664, 0.4666, 0.4667],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 33 Loss: 0.6818 Alpha: tensor([0.4671, 0.4657, 0.4658, 0.4650, 0.4653, 0.4655, 0.4656],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 34 Loss: 0.6795 Alpha: tensor([0.4661, 0.4647, 0.4648, 0.4639, 0.4643, 0.4644, 0.4646],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 34 best val f1 0.4053 test f1 0.30597037076950073
Epoch 35 Loss: 0.6773 Alpha: tensor([0.4651, 0.4636, 0.4637, 0.4628, 0.4632, 0.4634, 0.4635],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 35 best val f1 0.4126 test f1 0.3060314953327179
Epoch 36 Loss: 0.6751 Alpha: tensor([0.4642, 0.4625, 0.4626, 0.4617, 0.4621, 0.4623, 0.4624],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 36 best val f1 0.4201 test f1 0.30612680315971375
Epoch 37 Loss: 0.6729 Alpha: tensor([0.4632, 0.4615, 0.4616, 0.4605, 0.4610, 0.4612, 0.4613],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 37 best val f1 0.4240 test f1 0.3062705993652344
Epoch 38 Loss: 0.6708 Alpha: tensor([0.4622, 0.4604, 0.4605, 0.4594, 0.4599, 0.4601, 0.4603],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 39 Loss: 0.6688 Alpha: tensor([0.4612, 0.4593, 0.4595, 0.4583, 0.4588, 0.4590, 0.4592],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 39 best val f1 0.4286 test f1 0.3066670000553131
Epoch 40 Loss: 0.6668 Alpha: tensor([0.4603, 0.4583, 0.4584, 0.4572, 0.4577, 0.4579, 0.4581],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 40 best val f1 0.4327 test f1 0.3069557249546051
Epoch 41 Loss: 0.6650 Alpha: tensor([0.4593, 0.4572, 0.4574, 0.4561, 0.4566, 0.4568, 0.4571],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 41 best val f1 0.4412 test f1 0.3073224127292633
Epoch 42 Loss: 0.6632 Alpha: tensor([0.4583, 0.4561, 0.4563, 0.4550, 0.4555, 0.4558, 0.4560],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 42 best val f1 0.4455 test f1 0.3077685534954071
Epoch 43 Loss: 0.6613 Alpha: tensor([0.4573, 0.4551, 0.4552, 0.4539, 0.4544, 0.4547, 0.4549],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 44 Loss: 0.6596 Alpha: tensor([0.4564, 0.4540, 0.4542, 0.4527, 0.4533, 0.4536, 0.4539],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 45 Loss: 0.6577 Alpha: tensor([0.4554, 0.4529, 0.4531, 0.4516, 0.4522, 0.4525, 0.4528],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 46 Loss: 0.6560 Alpha: tensor([0.4544, 0.4519, 0.4521, 0.4505, 0.4511, 0.4514, 0.4517],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 47 Loss: 0.6542 Alpha: tensor([0.4535, 0.4508, 0.4510, 0.4494, 0.4500, 0.4503, 0.4507],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 48 Loss: 0.6525 Alpha: tensor([0.4525, 0.4497, 0.4500, 0.4483, 0.4490, 0.4493, 0.4496],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 48 best val f1 0.4497 test f1 0.31271836161613464
Epoch 49 Loss: 0.6508 Alpha: tensor([0.4516, 0.4487, 0.4490, 0.4472, 0.4479, 0.4482, 0.4486],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 49 best val f1 0.4540 test f1 0.3141142427921295
Epoch 50 Loss: 0.6490 Alpha: tensor([0.4506, 0.4476, 0.4479, 0.4461, 0.4468, 0.4471, 0.4475],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 51 Loss: 0.6473 Alpha: tensor([0.4496, 0.4466, 0.4469, 0.4450, 0.4457, 0.4460, 0.4464],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 51 best val f1 0.4586 test f1 0.31744518876075745
Epoch 52 Loss: 0.6456 Alpha: tensor([0.4487, 0.4455, 0.4458, 0.4439, 0.4446, 0.4450, 0.4454],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 52 best val f1 0.4706 test f1 0.31932130455970764
Epoch 53 Loss: 0.6449 Alpha: tensor([0.4477, 0.4445, 0.4448, 0.4428, 0.4435, 0.4439, 0.4443],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 53 best val f1 0.4768 test f1 0.3214225471019745
Epoch 54 Loss: 0.6447 Alpha: tensor([0.4468, 0.4434, 0.4438, 0.4417, 0.4424, 0.4428, 0.4433],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 54 best val f1 0.4933 test f1 0.32387998700141907
Epoch 55 Loss: 0.6444 Alpha: tensor([0.4458, 0.4424, 0.4427, 0.4406, 0.4414, 0.4417, 0.4422],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 55 best val f1 0.5000 test f1 0.3265724182128906
Epoch 56 Loss: 0.6437 Alpha: tensor([0.4449, 0.4413, 0.4417, 0.4395, 0.4403, 0.4407, 0.4412],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 56 best val f1 0.5034 test f1 0.32962948083877563
Epoch 57 Loss: 0.6430 Alpha: tensor([0.4439, 0.4403, 0.4407, 0.4384, 0.4392, 0.4396, 0.4402],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 58 Loss: 0.6423 Alpha: tensor([0.4430, 0.4392, 0.4396, 0.4373, 0.4381, 0.4385, 0.4391],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 59 Loss: 0.6416 Alpha: tensor([0.4420, 0.4382, 0.4386, 0.4362, 0.4370, 0.4375, 0.4381],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 60 Loss: 0.6406 Alpha: tensor([0.4411, 0.4371, 0.4376, 0.4351, 0.4360, 0.4364, 0.4370],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 61 Loss: 0.6396 Alpha: tensor([0.4401, 0.4361, 0.4366, 0.4340, 0.4349, 0.4353, 0.4360],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 62 Loss: 0.6386 Alpha: tensor([0.4392, 0.4350, 0.4355, 0.4329, 0.4338, 0.4343, 0.4349],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 63 Loss: 0.6375 Alpha: tensor([0.4382, 0.4340, 0.4345, 0.4318, 0.4327, 0.4332, 0.4339],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 64 Loss: 0.6362 Alpha: tensor([0.4373, 0.4330, 0.4335, 0.4307, 0.4316, 0.4322, 0.4328],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 65 Loss: 0.6349 Alpha: tensor([0.4363, 0.4319, 0.4325, 0.4296, 0.4306, 0.4311, 0.4318],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 65 best val f1 0.5120 test f1 0.36533427238464355
Epoch 66 Loss: 0.6336 Alpha: tensor([0.4354, 0.4309, 0.4315, 0.4285, 0.4295, 0.4300, 0.4308],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 66 best val f1 0.5203 test f1 0.3703303933143616
Epoch 67 Loss: 0.6321 Alpha: tensor([0.4344, 0.4299, 0.4305, 0.4274, 0.4284, 0.4290, 0.4297],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 68 Loss: 0.6306 Alpha: tensor([0.4335, 0.4288, 0.4294, 0.4263, 0.4274, 0.4279, 0.4287],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 68 best val f1 0.5289 test f1 0.3803609609603882
Epoch 69 Loss: 0.6291 Alpha: tensor([0.4325, 0.4278, 0.4284, 0.4252, 0.4263, 0.4269, 0.4277],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 69 best val f1 0.5424 test f1 0.3847784698009491
Epoch 70 Loss: 0.6276 Alpha: tensor([0.4316, 0.4268, 0.4274, 0.4241, 0.4252, 0.4259, 0.4266],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 71 Loss: 0.6260 Alpha: tensor([0.4307, 0.4257, 0.4264, 0.4230, 0.4242, 0.4248, 0.4256],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 71 best val f1 0.5487 test f1 0.3942742347717285
Epoch 72 Loss: 0.6245 Alpha: tensor([0.4297, 0.4247, 0.4254, 0.4219, 0.4231, 0.4238, 0.4246],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 72 best val f1 0.5636 test f1 0.3989221751689911
Epoch 73 Loss: 0.6229 Alpha: tensor([0.4288, 0.4237, 0.4244, 0.4208, 0.4220, 0.4227, 0.4235],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 74 Loss: 0.6213 Alpha: tensor([0.4278, 0.4227, 0.4234, 0.4198, 0.4210, 0.4217, 0.4225],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 75 Loss: 0.6197 Alpha: tensor([0.4269, 0.4216, 0.4224, 0.4187, 0.4199, 0.4206, 0.4215],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 76 Loss: 0.6181 Alpha: tensor([0.4259, 0.4206, 0.4214, 0.4176, 0.4189, 0.4196, 0.4205],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 77 Loss: 0.6164 Alpha: tensor([0.4250, 0.4196, 0.4205, 0.4165, 0.4178, 0.4186, 0.4195],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 78 Loss: 0.6148 Alpha: tensor([0.4241, 0.4186, 0.4195, 0.4154, 0.4168, 0.4175, 0.4184],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 79 Loss: 0.6133 Alpha: tensor([0.4231, 0.4176, 0.4185, 0.4144, 0.4157, 0.4165, 0.4174],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 80 Loss: 0.6117 Alpha: tensor([0.4222, 0.4166, 0.4175, 0.4133, 0.4147, 0.4155, 0.4164],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 81 Loss: 0.6101 Alpha: tensor([0.4212, 0.4155, 0.4165, 0.4122, 0.4136, 0.4145, 0.4154],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 82 Loss: 0.6085 Alpha: tensor([0.4203, 0.4145, 0.4155, 0.4111, 0.4126, 0.4134, 0.4144],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 83 Loss: 0.6070 Alpha: tensor([0.4193, 0.4135, 0.4146, 0.4101, 0.4116, 0.4124, 0.4134],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 84 Loss: 0.6055 Alpha: tensor([0.4184, 0.4125, 0.4136, 0.4090, 0.4105, 0.4114, 0.4124],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 85 Loss: 0.6039 Alpha: tensor([0.4175, 0.4115, 0.4126, 0.4079, 0.4095, 0.4104, 0.4114],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 86 Loss: 0.6024 Alpha: tensor([0.4165, 0.4105, 0.4116, 0.4069, 0.4085, 0.4093, 0.4104],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 87 Loss: 0.6009 Alpha: tensor([0.4156, 0.4095, 0.4107, 0.4058, 0.4074, 0.4083, 0.4094],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 88 Loss: 0.5994 Alpha: tensor([0.4147, 0.4085, 0.4097, 0.4047, 0.4064, 0.4073, 0.4084],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 89 Loss: 0.5980 Alpha: tensor([0.4137, 0.4075, 0.4088, 0.4037, 0.4054, 0.4063, 0.4074],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 90 Loss: 0.5965 Alpha: tensor([0.4128, 0.4065, 0.4078, 0.4026, 0.4044, 0.4053, 0.4064],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 91 Loss: 0.5951 Alpha: tensor([0.4118, 0.4055, 0.4068, 0.4016, 0.4033, 0.4043, 0.4055],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 92 Loss: 0.5936 Alpha: tensor([0.4109, 0.4045, 0.4059, 0.4005, 0.4023, 0.4033, 0.4045],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 93 Loss: 0.5922 Alpha: tensor([0.4100, 0.4035, 0.4049, 0.3994, 0.4013, 0.4023, 0.4035],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 94 Loss: 0.5908 Alpha: tensor([0.4090, 0.4025, 0.4040, 0.3984, 0.4003, 0.4013, 0.4025],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 95 Loss: 0.5895 Alpha: tensor([0.4081, 0.4015, 0.4030, 0.3973, 0.3993, 0.4003, 0.4015],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 96 Loss: 0.5881 Alpha: tensor([0.4072, 0.4005, 0.4021, 0.3963, 0.3982, 0.3993, 0.4006],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 97 Loss: 0.5868 Alpha: tensor([0.4062, 0.3996, 0.4011, 0.3952, 0.3972, 0.3983, 0.3996],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 98 Loss: 0.5855 Alpha: tensor([0.4053, 0.3986, 0.4002, 0.3942, 0.3962, 0.3973, 0.3986],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 99 Loss: 0.5842 Alpha: tensor([0.4044, 0.3976, 0.3992, 0.3932, 0.3952, 0.3963, 0.3977],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 100 Loss: 0.5829 Alpha: tensor([0.4034, 0.3966, 0.3983, 0.3921, 0.3942, 0.3953, 0.3967],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 101 Loss: 0.5816 Alpha: tensor([0.4025, 0.3956, 0.3974, 0.3911, 0.3932, 0.3943, 0.3957],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 102 Loss: 0.5803 Alpha: tensor([0.4016, 0.3946, 0.3964, 0.3900, 0.3922, 0.3933, 0.3948],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 103 Loss: 0.5790 Alpha: tensor([0.4006, 0.3937, 0.3955, 0.3890, 0.3912, 0.3923, 0.3938],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 104 Loss: 0.5778 Alpha: tensor([0.3997, 0.3927, 0.3946, 0.3880, 0.3902, 0.3914, 0.3929],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 105 Loss: 0.5765 Alpha: tensor([0.3988, 0.3917, 0.3936, 0.3869, 0.3892, 0.3904, 0.3919],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 106 Loss: 0.5753 Alpha: tensor([0.3979, 0.3907, 0.3927, 0.3859, 0.3882, 0.3894, 0.3910],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 107 Loss: 0.5740 Alpha: tensor([0.3969, 0.3897, 0.3918, 0.3849, 0.3872, 0.3884, 0.3900],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 108 Loss: 0.5727 Alpha: tensor([0.3960, 0.3888, 0.3909, 0.3838, 0.3862, 0.3874, 0.3891],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 109 Loss: 0.5715 Alpha: tensor([0.3951, 0.3878, 0.3899, 0.3828, 0.3852, 0.3865, 0.3882],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 110 Loss: 0.5703 Alpha: tensor([0.3941, 0.3868, 0.3890, 0.3818, 0.3843, 0.3855, 0.3872],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 111 Loss: 0.5691 Alpha: tensor([0.3932, 0.3859, 0.3881, 0.3808, 0.3833, 0.3845, 0.3863],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 112 Loss: 0.5679 Alpha: tensor([0.3923, 0.3849, 0.3872, 0.3798, 0.3823, 0.3835, 0.3854],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 113 Loss: 0.5667 Alpha: tensor([0.3914, 0.3839, 0.3863, 0.3787, 0.3813, 0.3826, 0.3844],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 114 Loss: 0.5656 Alpha: tensor([0.3904, 0.3830, 0.3854, 0.3777, 0.3803, 0.3816, 0.3835],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 115 Loss: 0.5645 Alpha: tensor([0.3895, 0.3820, 0.3844, 0.3767, 0.3793, 0.3806, 0.3826],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 116 Loss: 0.5633 Alpha: tensor([0.3886, 0.3810, 0.3835, 0.3757, 0.3784, 0.3797, 0.3816],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 117 Loss: 0.5622 Alpha: tensor([0.3877, 0.3801, 0.3826, 0.3747, 0.3774, 0.3787, 0.3807],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 118 Loss: 0.5611 Alpha: tensor([0.3867, 0.3791, 0.3817, 0.3737, 0.3764, 0.3778, 0.3798],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 119 Loss: 0.5600 Alpha: tensor([0.3858, 0.3781, 0.3808, 0.3727, 0.3754, 0.3768, 0.3789],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 120 Loss: 0.5589 Alpha: tensor([0.3849, 0.3772, 0.3799, 0.3717, 0.3745, 0.3759, 0.3780],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 121 Loss: 0.5578 Alpha: tensor([0.3840, 0.3762, 0.3790, 0.3707, 0.3735, 0.3749, 0.3771],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 122 Loss: 0.5568 Alpha: tensor([0.3831, 0.3753, 0.3781, 0.3697, 0.3725, 0.3740, 0.3761],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 123 Loss: 0.5557 Alpha: tensor([0.3821, 0.3743, 0.3772, 0.3687, 0.3716, 0.3730, 0.3752],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 124 Loss: 0.5546 Alpha: tensor([0.3812, 0.3734, 0.3763, 0.3677, 0.3706, 0.3721, 0.3743],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 125 Loss: 0.5536 Alpha: tensor([0.3803, 0.3724, 0.3754, 0.3667, 0.3696, 0.3711, 0.3734],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 126 Loss: 0.5526 Alpha: tensor([0.3794, 0.3715, 0.3746, 0.3657, 0.3687, 0.3702, 0.3725],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 127 Loss: 0.5515 Alpha: tensor([0.3785, 0.3705, 0.3737, 0.3647, 0.3677, 0.3692, 0.3716],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 128 Loss: 0.5505 Alpha: tensor([0.3776, 0.3696, 0.3728, 0.3637, 0.3668, 0.3683, 0.3707],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 129 Loss: 0.5495 Alpha: tensor([0.3766, 0.3686, 0.3719, 0.3627, 0.3658, 0.3674, 0.3698],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 130 Loss: 0.5485 Alpha: tensor([0.3757, 0.3677, 0.3710, 0.3618, 0.3649, 0.3664, 0.3689],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 131 Loss: 0.5475 Alpha: tensor([0.3748, 0.3667, 0.3701, 0.3608, 0.3639, 0.3655, 0.3681],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 132 Loss: 0.5465 Alpha: tensor([0.3739, 0.3658, 0.3693, 0.3598, 0.3630, 0.3646, 0.3672],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 133 Loss: 0.5455 Alpha: tensor([0.3730, 0.3648, 0.3684, 0.3588, 0.3620, 0.3636, 0.3663],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 134 Loss: 0.5445 Alpha: tensor([0.3721, 0.3639, 0.3675, 0.3579, 0.3611, 0.3627, 0.3654],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 135 Loss: 0.5435 Alpha: tensor([0.3711, 0.3630, 0.3666, 0.3569, 0.3601, 0.3618, 0.3645],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 136 Loss: 0.5426 Alpha: tensor([0.3702, 0.3620, 0.3658, 0.3559, 0.3592, 0.3608, 0.3636],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 137 Loss: 0.5416 Alpha: tensor([0.3693, 0.3611, 0.3649, 0.3550, 0.3582, 0.3599, 0.3628],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 138 Loss: 0.5408 Alpha: tensor([0.3684, 0.3602, 0.3640, 0.3540, 0.3573, 0.3590, 0.3619],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 139 Loss: 0.5399 Alpha: tensor([0.3675, 0.3592, 0.3632, 0.3530, 0.3564, 0.3581, 0.3610],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 140 Loss: 0.5390 Alpha: tensor([0.3666, 0.3583, 0.3623, 0.3521, 0.3554, 0.3572, 0.3601],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 141 Loss: 0.5381 Alpha: tensor([0.3657, 0.3574, 0.3614, 0.3511, 0.3545, 0.3562, 0.3593],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 142 Loss: 0.5372 Alpha: tensor([0.3648, 0.3564, 0.3606, 0.3502, 0.3536, 0.3553, 0.3584],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 143 Loss: 0.5362 Alpha: tensor([0.3639, 0.3555, 0.3597, 0.3492, 0.3526, 0.3544, 0.3575],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 144 Loss: 0.5353 Alpha: tensor([0.3630, 0.3546, 0.3589, 0.3483, 0.3517, 0.3535, 0.3567],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 145 Loss: 0.5344 Alpha: tensor([0.3621, 0.3537, 0.3580, 0.3473, 0.3508, 0.3526, 0.3558],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 146 Loss: 0.5335 Alpha: tensor([0.3611, 0.3527, 0.3572, 0.3464, 0.3498, 0.3517, 0.3550],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 147 Loss: 0.5325 Alpha: tensor([0.3602, 0.3518, 0.3563, 0.3454, 0.3489, 0.3508, 0.3541],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 148 Loss: 0.5316 Alpha: tensor([0.3593, 0.3509, 0.3555, 0.3445, 0.3480, 0.3499, 0.3533],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 149 Loss: 0.5306 Alpha: tensor([0.3584, 0.3500, 0.3546, 0.3436, 0.3471, 0.3490, 0.3524],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 150 Loss: 0.5296 Alpha: tensor([0.3575, 0.3490, 0.3538, 0.3426, 0.3462, 0.3481, 0.3516],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 151 Loss: 0.5286 Alpha: tensor([0.3566, 0.3481, 0.3529, 0.3417, 0.3453, 0.3472, 0.3507],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 152 Loss: 0.5276 Alpha: tensor([0.3557, 0.3472, 0.3521, 0.3408, 0.3443, 0.3463, 0.3499],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 153 Loss: 0.5266 Alpha: tensor([0.3548, 0.3463, 0.3512, 0.3399, 0.3434, 0.3454, 0.3490],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 154 Loss: 0.5256 Alpha: tensor([0.3539, 0.3454, 0.3504, 0.3389, 0.3425, 0.3445, 0.3482],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 155 Loss: 0.5246 Alpha: tensor([0.3530, 0.3445, 0.3496, 0.3380, 0.3416, 0.3436, 0.3474],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 156 Loss: 0.5236 Alpha: tensor([0.3521, 0.3436, 0.3487, 0.3371, 0.3407, 0.3428, 0.3465],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 157 Loss: 0.5226 Alpha: tensor([0.3512, 0.3427, 0.3479, 0.3362, 0.3398, 0.3419, 0.3457],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 158 Loss: 0.5216 Alpha: tensor([0.3503, 0.3417, 0.3471, 0.3353, 0.3389, 0.3410, 0.3449],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 159 Loss: 0.5207 Alpha: tensor([0.3494, 0.3408, 0.3462, 0.3344, 0.3380, 0.3401, 0.3440],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 160 Loss: 0.5198 Alpha: tensor([0.3485, 0.3399, 0.3454, 0.3335, 0.3371, 0.3392, 0.3432],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 161 Loss: 0.5189 Alpha: tensor([0.3476, 0.3390, 0.3446, 0.3326, 0.3362, 0.3383, 0.3424],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 162 Loss: 0.5179 Alpha: tensor([0.3468, 0.3381, 0.3438, 0.3317, 0.3353, 0.3375, 0.3415],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 163 Loss: 0.5171 Alpha: tensor([0.3459, 0.3372, 0.3429, 0.3308, 0.3344, 0.3366, 0.3407],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 164 Loss: 0.5162 Alpha: tensor([0.3450, 0.3363, 0.3421, 0.3299, 0.3335, 0.3357, 0.3399],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 165 Loss: 0.5153 Alpha: tensor([0.3441, 0.3354, 0.3413, 0.3290, 0.3326, 0.3349, 0.3391],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 166 Loss: 0.5144 Alpha: tensor([0.3432, 0.3345, 0.3405, 0.3281, 0.3318, 0.3340, 0.3383],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 167 Loss: 0.5135 Alpha: tensor([0.3423, 0.3336, 0.3397, 0.3272, 0.3309, 0.3331, 0.3375],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 168 Loss: 0.5127 Alpha: tensor([0.3414, 0.3328, 0.3389, 0.3263, 0.3300, 0.3322, 0.3366],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 169 Loss: 0.5118 Alpha: tensor([0.3405, 0.3319, 0.3381, 0.3254, 0.3291, 0.3314, 0.3358],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 170 Loss: 0.5110 Alpha: tensor([0.3396, 0.3310, 0.3373, 0.3245, 0.3282, 0.3305, 0.3350],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 171 Loss: 0.5101 Alpha: tensor([0.3388, 0.3301, 0.3364, 0.3237, 0.3274, 0.3297, 0.3342],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 172 Loss: 0.5093 Alpha: tensor([0.3379, 0.3292, 0.3356, 0.3228, 0.3265, 0.3288, 0.3334],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 173 Loss: 0.5084 Alpha: tensor([0.3370, 0.3283, 0.3348, 0.3219, 0.3256, 0.3279, 0.3326],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 174 Loss: 0.5075 Alpha: tensor([0.3361, 0.3274, 0.3340, 0.3211, 0.3248, 0.3271, 0.3318],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 175 Loss: 0.5066 Alpha: tensor([0.3352, 0.3265, 0.3332, 0.3202, 0.3239, 0.3262, 0.3310],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 176 Loss: 0.5058 Alpha: tensor([0.3343, 0.3257, 0.3324, 0.3193, 0.3230, 0.3254, 0.3302],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 177 Loss: 0.5049 Alpha: tensor([0.3335, 0.3248, 0.3317, 0.3185, 0.3222, 0.3245, 0.3294],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 178 Loss: 0.5040 Alpha: tensor([0.3326, 0.3239, 0.3309, 0.3176, 0.3213, 0.3237, 0.3286],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 179 Loss: 0.5032 Alpha: tensor([0.3317, 0.3230, 0.3301, 0.3167, 0.3204, 0.3228, 0.3278],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 180 Loss: 0.5023 Alpha: tensor([0.3308, 0.3222, 0.3293, 0.3159, 0.3196, 0.3220, 0.3270],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 181 Loss: 0.5015 Alpha: tensor([0.3300, 0.3213, 0.3285, 0.3150, 0.3187, 0.3211, 0.3263],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 182 Loss: 0.5006 Alpha: tensor([0.3291, 0.3204, 0.3277, 0.3142, 0.3179, 0.3203, 0.3255],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 183 Loss: 0.4998 Alpha: tensor([0.3282, 0.3195, 0.3269, 0.3134, 0.3170, 0.3195, 0.3247],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 184 Loss: 0.4989 Alpha: tensor([0.3274, 0.3187, 0.3262, 0.3125, 0.3162, 0.3186, 0.3239],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 185 Loss: 0.4981 Alpha: tensor([0.3265, 0.3178, 0.3254, 0.3117, 0.3153, 0.3178, 0.3231],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 186 Loss: 0.4972 Alpha: tensor([0.3256, 0.3169, 0.3246, 0.3108, 0.3145, 0.3170, 0.3223],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 187 Loss: 0.4964 Alpha: tensor([0.3247, 0.3161, 0.3238, 0.3100, 0.3136, 0.3161, 0.3216],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 188 Loss: 0.4955 Alpha: tensor([0.3239, 0.3152, 0.3231, 0.3092, 0.3128, 0.3153, 0.3208],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 189 Loss: 0.4947 Alpha: tensor([0.3230, 0.3144, 0.3223, 0.3083, 0.3119, 0.3145, 0.3200],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 190 Loss: 0.4938 Alpha: tensor([0.3222, 0.3135, 0.3215, 0.3075, 0.3111, 0.3136, 0.3192],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 191 Loss: 0.4930 Alpha: tensor([0.3213, 0.3126, 0.3207, 0.3067, 0.3103, 0.3128, 0.3185],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 192 Loss: 0.4921 Alpha: tensor([0.3204, 0.3118, 0.3200, 0.3059, 0.3094, 0.3120, 0.3177],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 193 Loss: 0.4913 Alpha: tensor([0.3196, 0.3109, 0.3192, 0.3051, 0.3086, 0.3112, 0.3169],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 194 Loss: 0.4904 Alpha: tensor([0.3187, 0.3101, 0.3185, 0.3042, 0.3078, 0.3103, 0.3162],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 195 Loss: 0.4896 Alpha: tensor([0.3179, 0.3092, 0.3177, 0.3034, 0.3069, 0.3095, 0.3154],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 196 Loss: 0.4888 Alpha: tensor([0.3170, 0.3084, 0.3169, 0.3026, 0.3061, 0.3087, 0.3146],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 197 Loss: 0.4880 Alpha: tensor([0.3162, 0.3075, 0.3162, 0.3018, 0.3053, 0.3079, 0.3139],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 198 Loss: 0.4871 Alpha: tensor([0.3153, 0.3067, 0.3154, 0.3010, 0.3045, 0.3071, 0.3131],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 199 Loss: 0.4862 Alpha: tensor([0.3145, 0.3058, 0.3147, 0.3002, 0.3036, 0.3063, 0.3123],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 200 Loss: 0.4853 Alpha: tensor([0.3136, 0.3050, 0.3139, 0.2994, 0.3028, 0.3055, 0.3116],
       device='cuda:0', grad_fn=<SelectBackward0>)