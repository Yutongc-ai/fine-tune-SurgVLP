/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
num_shots is  1
num_shots is  1
Epoch 1 Loss: 0.9311
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  5.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.39it/s]
Epoch 1 best val f1 0.2000 test f1 0.17524105310440063
Epoch 2 Loss: 0.1027
Epoch 2 best val f1 0.2353 test f1 0.26327505707740784
Epoch 3 Loss: -0.2544
Epoch 3 best val f1 0.4000 test f1 0.3733164966106415
Epoch 4 Loss: -0.4109
Epoch 4 best val f1 0.5000 test f1 0.4426119029521942
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.36it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.40it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.47it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
Epoch 5 Loss: -0.4703
Epoch 6 Loss: -0.5243
Epoch 7 Loss: -0.5733
Epoch 8 Loss: -0.6199
Epoch 9 Loss: -0.6647
Epoch 10 Loss: -0.7085
Epoch 11 Loss: -0.7523
Epoch 12 Loss: -0.7962
Epoch 13 Loss: -0.8399
Epoch 14 Loss: -0.8832
Epoch 15 Loss: -0.9265
Epoch 16 Loss: -0.9703
Epoch 17 Loss: -1.0147
Epoch 18 Loss: -1.0593
Epoch 19 Loss: -1.1045
Epoch 20 Loss: -1.1500
Epoch 21 Loss: -1.1958
Epoch 22 Loss: -1.2420
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 11.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.22it/s]
Epoch 23 Loss: -1.2884
Epoch 24 Loss: -1.3347
Epoch 25 Loss: -1.3811
Epoch 26 Loss: -1.4274
Epoch 27 Loss: -1.4739
Epoch 28 Loss: -1.5206
Epoch 29 Loss: -1.5677
Epoch 30 Loss: -1.6153
Epoch 31 Loss: -1.6630
Epoch 32 Loss: -1.7109
Epoch 33 Loss: -1.7591
Epoch 34 Loss: -1.8077
Epoch 35 Loss: -1.8569
Epoch 36 Loss: -1.9066
Epoch 37 Loss: -1.9568
Epoch 38 Loss: -2.0073
Epoch 39 Loss: -2.0582
Epoch 40 Loss: -2.1094
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
Epoch 41 Loss: -2.1608
Epoch 42 Loss: -2.2130
Epoch 43 Loss: -2.2663
Epoch 44 Loss: -2.3221
Epoch 45 Loss: -2.3808
Epoch 46 Loss: -2.4443
Epoch 47 Loss: -2.5123
Epoch 48 Loss: -2.5811
Epoch 49 Loss: -2.6499
Epoch 50 Loss: -2.7185
Epoch 51 Loss: -2.7844
Epoch 52 Loss: -2.8483
Epoch 53 Loss: -2.9117
Epoch 54 Loss: -2.9748
Epoch 55 Loss: -3.0384
Epoch 56 Loss: -3.1030
Epoch 57 Loss: -3.1669
Epoch 58 Loss: -3.2309
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.56it/s]
Epoch 59 Loss: -3.2963
Epoch 60 Loss: -3.3617
Epoch 61 Loss: -3.4269
Epoch 62 Loss: -3.4925
Epoch 63 Loss: -3.5586
Epoch 64 Loss: -3.6249
Epoch 65 Loss: -3.6915
Epoch 66 Loss: -3.7585
Epoch 67 Loss: -3.8258
Epoch 68 Loss: -3.8934
Epoch 69 Loss: -3.9631
Epoch 70 Loss: -4.0352
Epoch 71 Loss: -4.1216
Epoch 72 Loss: -4.2060
Epoch 73 Loss: -4.2891
Epoch 74 Loss: -4.3672
Epoch 75 Loss: -4.4420
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.43it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.51it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.37it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.51it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 76 Loss: -4.5183
Epoch 77 Loss: -4.6032
Epoch 78 Loss: -4.7000
Epoch 79 Loss: -4.8014
Epoch 80 Loss: -4.9074
Epoch 81 Loss: -5.0077
Epoch 82 Loss: -5.0999
Epoch 83 Loss: -5.1905
Epoch 84 Loss: -5.2784
Epoch 85 Loss: -5.3654
Epoch 86 Loss: -5.4520
Epoch 87 Loss: -5.5386
Epoch 88 Loss: -5.6251
Epoch 89 Loss: -5.7114
Epoch 90 Loss: -5.7980
Epoch 91 Loss: -5.8846
Epoch 92 Loss: -5.9715
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 11.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.43it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.39it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.44it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.71it/s]
Epoch 94 Loss: -6.1460
Epoch 95 Loss: -6.2336
Epoch 96 Loss: -6.3212
Epoch 97 Loss: -6.4089
Epoch 98 Loss: -6.4967
Epoch 99 Loss: -6.5847
Epoch 100 Loss: -6.6727