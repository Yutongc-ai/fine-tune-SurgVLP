/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
num_shots is  4
num_shots is  4
Epoch 1 Loss: 1.0407 Alpha: tensor([0.4990, 0.5010, 0.5010, 0.5010, 0.5010, 0.5010, 0.5010],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 1 best val f1 0.4444 test f1 0.3057743310928345
Epoch 2 Loss: 0.9327 Alpha: tensor([0.4980, 0.5018, 0.5018, 0.5019, 0.5018, 0.5015, 0.5018],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 3 Loss: 0.8594 Alpha: tensor([0.4970, 0.5020, 0.5021, 0.5024, 0.5024, 0.5014, 0.5023],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 Loss: 0.8109 Alpha: tensor([0.4960, 0.5018, 0.5019, 0.5025, 0.5025, 0.5009, 0.5024],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 5 Loss: 0.7787 Alpha: tensor([0.4950, 0.5014, 0.5015, 0.5022, 0.5023, 0.5002, 0.5022],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 6 Loss: 0.7555 Alpha: tensor([0.4940, 0.5008, 0.5009, 0.5017, 0.5018, 0.4995, 0.5018],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 7 Loss: 0.7379 Alpha: tensor([0.4930, 0.5000, 0.5002, 0.5011, 0.5012, 0.4986, 0.5012],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 8 Loss: 0.7232 Alpha: tensor([0.4920, 0.4992, 0.4994, 0.5004, 0.5005, 0.4977, 0.5005],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 9 Loss: 0.7105 Alpha: tensor([0.4909, 0.4984, 0.4985, 0.4996, 0.4998, 0.4968, 0.4997],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 10 Loss: 0.6994 Alpha: tensor([0.4899, 0.4975, 0.4976, 0.4987, 0.4989, 0.4959, 0.4989],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 11 Loss: 0.6894 Alpha: tensor([0.4889, 0.4966, 0.4967, 0.4978, 0.4981, 0.4949, 0.4980],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 12 Loss: 0.6804 Alpha: tensor([0.4879, 0.4956, 0.4957, 0.4969, 0.4971, 0.4939, 0.4971],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 13 Loss: 0.6721 Alpha: tensor([0.4869, 0.4946, 0.4947, 0.4960, 0.4962, 0.4929, 0.4961],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 14 Loss: 0.6647 Alpha: tensor([0.4859, 0.4936, 0.4937, 0.4950, 0.4952, 0.4919, 0.4952],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 15 Loss: 0.6579 Alpha: tensor([0.4849, 0.4926, 0.4927, 0.4940, 0.4942, 0.4908, 0.4942],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 16 Loss: 0.6513 Alpha: tensor([0.4839, 0.4916, 0.4917, 0.4930, 0.4932, 0.4898, 0.4932],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 17 Loss: 0.6462 Alpha: tensor([0.4829, 0.4905, 0.4907, 0.4919, 0.4922, 0.4887, 0.4922],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 18 Loss: 0.6414 Alpha: tensor([0.4819, 0.4895, 0.4896, 0.4909, 0.4912, 0.4877, 0.4911],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 19 Loss: 0.6374 Alpha: tensor([0.4809, 0.4884, 0.4886, 0.4898, 0.4901, 0.4866, 0.4901],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 20 Loss: 0.6336 Alpha: tensor([0.4799, 0.4873, 0.4875, 0.4888, 0.4891, 0.4855, 0.4890],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 20 best val f1 0.4462 test f1 0.30584171414375305
Epoch 21 Loss: 0.6298 Alpha: tensor([0.4789, 0.4863, 0.4864, 0.4877, 0.4880, 0.4845, 0.4879],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 21 best val f1 0.4480 test f1 0.3058665096759796
Epoch 22 Loss: 0.6261 Alpha: tensor([0.4779, 0.4852, 0.4854, 0.4866, 0.4869, 0.4834, 0.4869],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 Loss: 0.6220 Alpha: tensor([0.4769, 0.4841, 0.4843, 0.4856, 0.4859, 0.4823, 0.4858],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 best val f1 0.4498 test f1 0.30595746636390686
Epoch 24 Loss: 0.6182 Alpha: tensor([0.4759, 0.4830, 0.4832, 0.4845, 0.4848, 0.4812, 0.4847],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 24 best val f1 0.4516 test f1 0.3060149848461151
Epoch 25 Loss: 0.6141 Alpha: tensor([0.4749, 0.4819, 0.4821, 0.4834, 0.4837, 0.4801, 0.4836],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 Loss: 0.6100 Alpha: tensor([0.4740, 0.4808, 0.4810, 0.4823, 0.4826, 0.4791, 0.4825],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 best val f1 0.4527 test f1 0.30622124671936035
Epoch 27 Loss: 0.6060 Alpha: tensor([0.4730, 0.4797, 0.4799, 0.4812, 0.4815, 0.4780, 0.4814],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 27 best val f1 0.4564 test f1 0.30633223056793213
Epoch 28 Loss: 0.6019 Alpha: tensor([0.4720, 0.4786, 0.4788, 0.4801, 0.4804, 0.4769, 0.4803],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 28 best val f1 0.4596 test f1 0.3065190613269806
Epoch 29 Loss: 0.5979 Alpha: tensor([0.4710, 0.4775, 0.4777, 0.4790, 0.4793, 0.4758, 0.4792],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 29 best val f1 0.4753 test f1 0.3067396581172943
Epoch 30 Loss: 0.5941 Alpha: tensor([0.4701, 0.4764, 0.4766, 0.4779, 0.4781, 0.4747, 0.4780],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 31 Loss: 0.5902 Alpha: tensor([0.4691, 0.4753, 0.4755, 0.4768, 0.4770, 0.4736, 0.4769],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 31 best val f1 0.4787 test f1 0.30724412202835083
Epoch 32 Loss: 0.5865 Alpha: tensor([0.4681, 0.4742, 0.4744, 0.4756, 0.4759, 0.4725, 0.4758],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 32 best val f1 0.4841 test f1 0.30751973390579224
Epoch 33 Loss: 0.5828 Alpha: tensor([0.4672, 0.4730, 0.4733, 0.4745, 0.4748, 0.4714, 0.4747],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 33 best val f1 0.5180 test f1 0.3078010082244873
Epoch 34 Loss: 0.5793 Alpha: tensor([0.4662, 0.4719, 0.4722, 0.4734, 0.4737, 0.4703, 0.4735],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 35 Loss: 0.5759 Alpha: tensor([0.4653, 0.4708, 0.4711, 0.4723, 0.4725, 0.4692, 0.4724],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 36 Loss: 0.5724 Alpha: tensor([0.4643, 0.4697, 0.4700, 0.4712, 0.4714, 0.4681, 0.4713],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 37 Loss: 0.5691 Alpha: tensor([0.4634, 0.4686, 0.4689, 0.4700, 0.4703, 0.4670, 0.4701],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 38 Loss: 0.5657 Alpha: tensor([0.4624, 0.4675, 0.4678, 0.4689, 0.4692, 0.4659, 0.4690],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 39 Loss: 0.5625 Alpha: tensor([0.4615, 0.4664, 0.4667, 0.4678, 0.4681, 0.4648, 0.4679],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 40 Loss: 0.5592 Alpha: tensor([0.4606, 0.4653, 0.4656, 0.4666, 0.4669, 0.4637, 0.4667],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 41 Loss: 0.5560 Alpha: tensor([0.4596, 0.4641, 0.4645, 0.4655, 0.4658, 0.4626, 0.4656],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 42 Loss: 0.5532 Alpha: tensor([0.4587, 0.4630, 0.4635, 0.4644, 0.4647, 0.4615, 0.4645],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 43 Loss: 0.5507 Alpha: tensor([0.4578, 0.4619, 0.4624, 0.4633, 0.4636, 0.4605, 0.4634],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 44 Loss: 0.5483 Alpha: tensor([0.4569, 0.4608, 0.4613, 0.4622, 0.4625, 0.4594, 0.4622],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 45 Loss: 0.5458 Alpha: tensor([0.4559, 0.4597, 0.4602, 0.4610, 0.4614, 0.4583, 0.4611],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 46 Loss: 0.5431 Alpha: tensor([0.4550, 0.4586, 0.4592, 0.4599, 0.4603, 0.4572, 0.4600],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 47 Loss: 0.5404 Alpha: tensor([0.4541, 0.4575, 0.4581, 0.4588, 0.4592, 0.4561, 0.4589],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 48 Loss: 0.5376 Alpha: tensor([0.4532, 0.4565, 0.4570, 0.4577, 0.4581, 0.4551, 0.4578],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 49 Loss: 0.5348 Alpha: tensor([0.4523, 0.4554, 0.4560, 0.4566, 0.4570, 0.4540, 0.4567],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 50 Loss: 0.5319 Alpha: tensor([0.4514, 0.4543, 0.4549, 0.4554, 0.4559, 0.4529, 0.4556],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 51 Loss: 0.5288 Alpha: tensor([0.4505, 0.4532, 0.4539, 0.4543, 0.4548, 0.4519, 0.4545],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 52 Loss: 0.5257 Alpha: tensor([0.4496, 0.4521, 0.4528, 0.4532, 0.4537, 0.4508, 0.4534],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 53 Loss: 0.5224 Alpha: tensor([0.4487, 0.4510, 0.4518, 0.4521, 0.4527, 0.4498, 0.4523],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 54 Loss: 0.5191 Alpha: tensor([0.4478, 0.4500, 0.4507, 0.4510, 0.4516, 0.4487, 0.4512],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 55 Loss: 0.5158 Alpha: tensor([0.4469, 0.4489, 0.4497, 0.4499, 0.4505, 0.4477, 0.4501],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 56 Loss: 0.5125 Alpha: tensor([0.4460, 0.4478, 0.4487, 0.4488, 0.4495, 0.4466, 0.4491],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 57 Loss: 0.5089 Alpha: tensor([0.4451, 0.4468, 0.4477, 0.4477, 0.4484, 0.4456, 0.4480],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 58 Loss: 0.5055 Alpha: tensor([0.4442, 0.4457, 0.4467, 0.4466, 0.4474, 0.4445, 0.4469],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 59 Loss: 0.5019 Alpha: tensor([0.4433, 0.4447, 0.4457, 0.4455, 0.4464, 0.4435, 0.4459],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 60 Loss: 0.4984 Alpha: tensor([0.4424, 0.4436, 0.4447, 0.4444, 0.4453, 0.4425, 0.4448],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 61 Loss: 0.4948 Alpha: tensor([0.4416, 0.4426, 0.4437, 0.4433, 0.4443, 0.4415, 0.4438],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 62 Loss: 0.4913 Alpha: tensor([0.4407, 0.4416, 0.4427, 0.4422, 0.4433, 0.4404, 0.4428],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 63 Loss: 0.4878 Alpha: tensor([0.4398, 0.4405, 0.4417, 0.4411, 0.4423, 0.4394, 0.4417],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 64 Loss: 0.4844 Alpha: tensor([0.4389, 0.4395, 0.4407, 0.4400, 0.4413, 0.4384, 0.4407],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 65 Loss: 0.4809 Alpha: tensor([0.4381, 0.4385, 0.4397, 0.4389, 0.4403, 0.4374, 0.4397],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 66 Loss: 0.4773 Alpha: tensor([0.4372, 0.4375, 0.4388, 0.4379, 0.4393, 0.4364, 0.4387],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 67 Loss: 0.4736 Alpha: tensor([0.4363, 0.4365, 0.4378, 0.4368, 0.4383, 0.4354, 0.4377],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 68 Loss: 0.4700 Alpha: tensor([0.4355, 0.4355, 0.4369, 0.4357, 0.4373, 0.4344, 0.4367],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 69 Loss: 0.4668 Alpha: tensor([0.4346, 0.4345, 0.4359, 0.4346, 0.4363, 0.4334, 0.4357],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 70 Loss: 0.4641 Alpha: tensor([0.4338, 0.4335, 0.4350, 0.4336, 0.4354, 0.4324, 0.4347],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 71 Loss: 0.4613 Alpha: tensor([0.4329, 0.4325, 0.4340, 0.4325, 0.4344, 0.4314, 0.4337],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 72 Loss: 0.4582 Alpha: tensor([0.4321, 0.4315, 0.4331, 0.4314, 0.4334, 0.4304, 0.4328],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 73 Loss: 0.4549 Alpha: tensor([0.4312, 0.4305, 0.4322, 0.4304, 0.4325, 0.4295, 0.4318],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 74 Loss: 0.4515 Alpha: tensor([0.4304, 0.4295, 0.4312, 0.4293, 0.4315, 0.4285, 0.4308],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 75 Loss: 0.4481 Alpha: tensor([0.4295, 0.4285, 0.4303, 0.4283, 0.4306, 0.4275, 0.4299],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 76 Loss: 0.4446 Alpha: tensor([0.4287, 0.4276, 0.4294, 0.4272, 0.4297, 0.4265, 0.4289],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 77 Loss: 0.4434 Alpha: tensor([0.4278, 0.4266, 0.4285, 0.4262, 0.4287, 0.4255, 0.4280],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 78 Loss: 0.4576 Alpha: tensor([0.4270, 0.4257, 0.4275, 0.4251, 0.4278, 0.4246, 0.4271],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 79 Loss: 0.4740 Alpha: tensor([0.4262, 0.4247, 0.4266, 0.4241, 0.4269, 0.4236, 0.4261],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 80 Loss: 0.4832 Alpha: tensor([0.4253, 0.4238, 0.4257, 0.4230, 0.4260, 0.4226, 0.4252],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 81 Loss: 0.4864 Alpha: tensor([0.4245, 0.4228, 0.4248, 0.4220, 0.4251, 0.4217, 0.4243],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 82 Loss: 0.4863 Alpha: tensor([0.4236, 0.4219, 0.4238, 0.4210, 0.4241, 0.4207, 0.4234],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 83 Loss: 0.4845 Alpha: tensor([0.4228, 0.4210, 0.4229, 0.4199, 0.4232, 0.4197, 0.4225],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 84 Loss: 0.4859 Alpha: tensor([0.4219, 0.4201, 0.4220, 0.4189, 0.4223, 0.4188, 0.4216],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 84 best val f1 0.5238 test f1 0.2910045385360718
Epoch 85 Loss: 0.4907 Alpha: tensor([0.4211, 0.4191, 0.4210, 0.4179, 0.4214, 0.4178, 0.4207],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 86 Loss: 0.4948 Alpha: tensor([0.4202, 0.4182, 0.4201, 0.4169, 0.4206, 0.4168, 0.4198],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 87 Loss: 0.4968 Alpha: tensor([0.4193, 0.4173, 0.4192, 0.4158, 0.4197, 0.4159, 0.4189],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 88 Loss: 0.4965 Alpha: tensor([0.4185, 0.4164, 0.4182, 0.4148, 0.4188, 0.4149, 0.4180],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 89 Loss: 0.4944 Alpha: tensor([0.4176, 0.4155, 0.4173, 0.4138, 0.4179, 0.4140, 0.4171],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 90 Loss: 0.4910 Alpha: tensor([0.4167, 0.4146, 0.4164, 0.4128, 0.4170, 0.4130, 0.4162],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 91 Loss: 0.4869 Alpha: tensor([0.4158, 0.4137, 0.4155, 0.4117, 0.4161, 0.4121, 0.4153],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 92 Loss: 0.4825 Alpha: tensor([0.4149, 0.4128, 0.4145, 0.4107, 0.4153, 0.4111, 0.4144],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 93 Loss: 0.4782 Alpha: tensor([0.4141, 0.4120, 0.4136, 0.4097, 0.4144, 0.4102, 0.4136],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 94 Loss: 0.4742 Alpha: tensor([0.4132, 0.4111, 0.4127, 0.4087, 0.4135, 0.4093, 0.4127],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 95 Loss: 0.4704 Alpha: tensor([0.4123, 0.4102, 0.4118, 0.4077, 0.4127, 0.4083, 0.4119],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 96 Loss: 0.4665 Alpha: tensor([0.4114, 0.4093, 0.4109, 0.4067, 0.4118, 0.4074, 0.4110],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 97 Loss: 0.4627 Alpha: tensor([0.4106, 0.4085, 0.4100, 0.4057, 0.4110, 0.4065, 0.4102],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 98 Loss: 0.4588 Alpha: tensor([0.4097, 0.4076, 0.4091, 0.4047, 0.4102, 0.4056, 0.4093],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 99 Loss: 0.4548 Alpha: tensor([0.4088, 0.4068, 0.4082, 0.4037, 0.4093, 0.4047, 0.4085],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 100 Loss: 0.4509 Alpha: tensor([0.4080, 0.4059, 0.4073, 0.4027, 0.4085, 0.4038, 0.4076],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 101 Loss: 0.4472 Alpha: tensor([0.4071, 0.4051, 0.4064, 0.4017, 0.4077, 0.4029, 0.4068],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 102 Loss: 0.4436 Alpha: tensor([0.4062, 0.4042, 0.4055, 0.4007, 0.4068, 0.4020, 0.4060],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 103 Loss: 0.4401 Alpha: tensor([0.4054, 0.4034, 0.4046, 0.3997, 0.4060, 0.4011, 0.4052],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 104 Loss: 0.4368 Alpha: tensor([0.4045, 0.4025, 0.4038, 0.3987, 0.4052, 0.4002, 0.4044],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 105 Loss: 0.4333 Alpha: tensor([0.4037, 0.4017, 0.4029, 0.3978, 0.4044, 0.3993, 0.4036],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 106 Loss: 0.4300 Alpha: tensor([0.4029, 0.4009, 0.4020, 0.3968, 0.4036, 0.3984, 0.4028],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 107 Loss: 0.4266 Alpha: tensor([0.4020, 0.4001, 0.4012, 0.3958, 0.4028, 0.3975, 0.4020],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 108 Loss: 0.4233 Alpha: tensor([0.4012, 0.3992, 0.4003, 0.3949, 0.4020, 0.3966, 0.4012],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 109 Loss: 0.4203 Alpha: tensor([0.4003, 0.3984, 0.3995, 0.3939, 0.4012, 0.3957, 0.4004],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 110 Loss: 0.4173 Alpha: tensor([0.3995, 0.3976, 0.3986, 0.3929, 0.4005, 0.3949, 0.3997],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 111 Loss: 0.4144 Alpha: tensor([0.3987, 0.3968, 0.3978, 0.3920, 0.3997, 0.3940, 0.3989],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 112 Loss: 0.4115 Alpha: tensor([0.3979, 0.3960, 0.3970, 0.3910, 0.3989, 0.3931, 0.3981],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 113 Loss: 0.4105 Alpha: tensor([0.3970, 0.3952, 0.3961, 0.3901, 0.3981, 0.3922, 0.3974],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 114 Loss: 0.4104 Alpha: tensor([0.3962, 0.3944, 0.3953, 0.3892, 0.3974, 0.3914, 0.3966],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 115 Loss: 0.4096 Alpha: tensor([0.3954, 0.3936, 0.3945, 0.3882, 0.3966, 0.3905, 0.3958],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 116 Loss: 0.4083 Alpha: tensor([0.3945, 0.3928, 0.3937, 0.3873, 0.3958, 0.3896, 0.3951],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 117 Loss: 0.4065 Alpha: tensor([0.3937, 0.3920, 0.3928, 0.3863, 0.3951, 0.3887, 0.3943],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 118 Loss: 0.4047 Alpha: tensor([0.3929, 0.3912, 0.3920, 0.3854, 0.3943, 0.3879, 0.3936],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 119 Loss: 0.4026 Alpha: tensor([0.3920, 0.3904, 0.3912, 0.3845, 0.3935, 0.3870, 0.3928],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 120 Loss: 0.4001 Alpha: tensor([0.3912, 0.3896, 0.3904, 0.3835, 0.3928, 0.3861, 0.3921],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 121 Loss: 0.3978 Alpha: tensor([0.3904, 0.3889, 0.3896, 0.3826, 0.3920, 0.3853, 0.3914],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 122 Loss: 0.3955 Alpha: tensor([0.3895, 0.3881, 0.3888, 0.3817, 0.3913, 0.3844, 0.3906],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 123 Loss: 0.3933 Alpha: tensor([0.3887, 0.3873, 0.3880, 0.3808, 0.3905, 0.3835, 0.3899],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 124 Loss: 0.3911 Alpha: tensor([0.3879, 0.3865, 0.3872, 0.3799, 0.3897, 0.3827, 0.3892],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 125 Loss: 0.3888 Alpha: tensor([0.3871, 0.3858, 0.3864, 0.3790, 0.3890, 0.3818, 0.3884],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 126 Loss: 0.3867 Alpha: tensor([0.3862, 0.3850, 0.3856, 0.3781, 0.3882, 0.3810, 0.3877],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 127 Loss: 0.3914 Alpha: tensor([0.3854, 0.3842, 0.3848, 0.3772, 0.3875, 0.3801, 0.3870],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 127 best val f1 0.5301 test f1 0.276619553565979
Epoch 128 Loss: 0.3954 Alpha: tensor([0.3846, 0.3835, 0.3840, 0.3763, 0.3867, 0.3792, 0.3863],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 129 Loss: 0.3951 Alpha: tensor([0.3838, 0.3827, 0.3832, 0.3754, 0.3860, 0.3784, 0.3856],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 130 Loss: 0.3943 Alpha: tensor([0.3829, 0.3819, 0.3824, 0.3745, 0.3853, 0.3775, 0.3849],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 131 Loss: 0.3932 Alpha: tensor([0.3821, 0.3812, 0.3816, 0.3736, 0.3845, 0.3767, 0.3841],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 132 Loss: 0.3917 Alpha: tensor([0.3813, 0.3804, 0.3808, 0.3727, 0.3838, 0.3758, 0.3834],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 133 Loss: 0.3895 Alpha: tensor([0.3804, 0.3797, 0.3800, 0.3718, 0.3830, 0.3750, 0.3827],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 134 Loss: 0.3876 Alpha: tensor([0.3796, 0.3789, 0.3792, 0.3710, 0.3823, 0.3741, 0.3820],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 135 Loss: 0.3859 Alpha: tensor([0.3788, 0.3782, 0.3784, 0.3701, 0.3816, 0.3733, 0.3813],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 136 Loss: 0.3840 Alpha: tensor([0.3779, 0.3774, 0.3776, 0.3693, 0.3808, 0.3724, 0.3806],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 137 Loss: 0.3819 Alpha: tensor([0.3771, 0.3767, 0.3768, 0.3684, 0.3801, 0.3716, 0.3799],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 138 Loss: 0.3796 Alpha: tensor([0.3763, 0.3760, 0.3760, 0.3675, 0.3794, 0.3707, 0.3792],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 139 Loss: 0.3774 Alpha: tensor([0.3755, 0.3752, 0.3753, 0.3667, 0.3786, 0.3699, 0.3785],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 140 Loss: 0.3752 Alpha: tensor([0.3746, 0.3745, 0.3745, 0.3659, 0.3779, 0.3691, 0.3778],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 141 Loss: 0.3730 Alpha: tensor([0.3738, 0.3737, 0.3737, 0.3650, 0.3772, 0.3682, 0.3771],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 142 Loss: 0.3709 Alpha: tensor([0.3730, 0.3730, 0.3729, 0.3642, 0.3765, 0.3674, 0.3765],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 143 Loss: 0.3688 Alpha: tensor([0.3722, 0.3723, 0.3721, 0.3633, 0.3758, 0.3666, 0.3758],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 144 Loss: 0.3667 Alpha: tensor([0.3713, 0.3715, 0.3713, 0.3625, 0.3751, 0.3657, 0.3751],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 145 Loss: 0.3646 Alpha: tensor([0.3705, 0.3708, 0.3706, 0.3617, 0.3743, 0.3649, 0.3744],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 146 Loss: 0.3625 Alpha: tensor([0.3697, 0.3701, 0.3698, 0.3609, 0.3736, 0.3641, 0.3737],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 147 Loss: 0.3605 Alpha: tensor([0.3689, 0.3694, 0.3690, 0.3601, 0.3729, 0.3633, 0.3730],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 148 Loss: 0.3587 Alpha: tensor([0.3680, 0.3686, 0.3682, 0.3593, 0.3722, 0.3625, 0.3724],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 149 Loss: 0.3569 Alpha: tensor([0.3672, 0.3679, 0.3675, 0.3585, 0.3715, 0.3616, 0.3717],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 150 Loss: 0.3553 Alpha: tensor([0.3664, 0.3672, 0.3667, 0.3576, 0.3708, 0.3608, 0.3710],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 151 Loss: 0.3536 Alpha: tensor([0.3656, 0.3665, 0.3659, 0.3568, 0.3701, 0.3600, 0.3703],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 152 Loss: 0.3520 Alpha: tensor([0.3648, 0.3658, 0.3651, 0.3561, 0.3695, 0.3592, 0.3697],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 153 Loss: 0.3582 Alpha: tensor([0.3640, 0.3650, 0.3644, 0.3553, 0.3688, 0.3584, 0.3690],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 154 Loss: 0.3614 Alpha: tensor([0.3631, 0.3643, 0.3636, 0.3545, 0.3681, 0.3576, 0.3683],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 155 Loss: 0.3605 Alpha: tensor([0.3623, 0.3636, 0.3628, 0.3537, 0.3674, 0.3568, 0.3677],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 156 Loss: 0.3601 Alpha: tensor([0.3615, 0.3629, 0.3620, 0.3529, 0.3667, 0.3560, 0.3670],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 157 Loss: 0.3642 Alpha: tensor([0.3607, 0.3622, 0.3613, 0.3521, 0.3660, 0.3552, 0.3663],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 158 Loss: 0.3683 Alpha: tensor([0.3599, 0.3615, 0.3605, 0.3513, 0.3653, 0.3544, 0.3656],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 159 Loss: 0.3670 Alpha: tensor([0.3590, 0.3608, 0.3597, 0.3505, 0.3646, 0.3536, 0.3650],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 160 Loss: 0.3660 Alpha: tensor([0.3582, 0.3600, 0.3589, 0.3498, 0.3640, 0.3528, 0.3643],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 161 Loss: 0.3643 Alpha: tensor([0.3574, 0.3593, 0.3581, 0.3490, 0.3633, 0.3520, 0.3636],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 162 Loss: 0.3623 Alpha: tensor([0.3566, 0.3586, 0.3574, 0.3482, 0.3626, 0.3512, 0.3630],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 163 Loss: 0.3604 Alpha: tensor([0.3558, 0.3579, 0.3566, 0.3474, 0.3619, 0.3504, 0.3623],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 164 Loss: 0.3576 Alpha: tensor([0.3549, 0.3572, 0.3558, 0.3466, 0.3612, 0.3496, 0.3616],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 165 Loss: 0.3552 Alpha: tensor([0.3541, 0.3565, 0.3550, 0.3459, 0.3605, 0.3488, 0.3609],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 166 Loss: 0.3535 Alpha: tensor([0.3533, 0.3558, 0.3542, 0.3451, 0.3599, 0.3480, 0.3603],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 167 Loss: 0.3517 Alpha: tensor([0.3525, 0.3551, 0.3535, 0.3443, 0.3592, 0.3472, 0.3596],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 168 Loss: 0.3493 Alpha: tensor([0.3517, 0.3544, 0.3527, 0.3436, 0.3585, 0.3464, 0.3589],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 169 Loss: 0.3472 Alpha: tensor([0.3509, 0.3537, 0.3519, 0.3428, 0.3578, 0.3457, 0.3583],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 170 Loss: 0.3453 Alpha: tensor([0.3501, 0.3530, 0.3511, 0.3420, 0.3572, 0.3449, 0.3576],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 171 Loss: 0.3435 Alpha: tensor([0.3493, 0.3523, 0.3504, 0.3413, 0.3565, 0.3441, 0.3570],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 172 Loss: 0.3416 Alpha: tensor([0.3485, 0.3516, 0.3496, 0.3405, 0.3558, 0.3433, 0.3563],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 173 Loss: 0.3396 Alpha: tensor([0.3477, 0.3510, 0.3488, 0.3398, 0.3552, 0.3425, 0.3556],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 174 Loss: 0.3424 Alpha: tensor([0.3469, 0.3503, 0.3481, 0.3390, 0.3545, 0.3418, 0.3550],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 175 Loss: 0.3479 Alpha: tensor([0.3461, 0.3496, 0.3473, 0.3383, 0.3538, 0.3410, 0.3543],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 176 Loss: 0.3498 Alpha: tensor([0.3453, 0.3489, 0.3465, 0.3375, 0.3532, 0.3402, 0.3537],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 177 Loss: 0.3492 Alpha: tensor([0.3445, 0.3482, 0.3458, 0.3368, 0.3525, 0.3395, 0.3530],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 178 Loss: 0.3479 Alpha: tensor([0.3437, 0.3475, 0.3450, 0.3360, 0.3519, 0.3387, 0.3523],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 179 Loss: 0.3462 Alpha: tensor([0.3429, 0.3468, 0.3442, 0.3353, 0.3512, 0.3379, 0.3517],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 180 Loss: 0.3445 Alpha: tensor([0.3421, 0.3461, 0.3435, 0.3346, 0.3506, 0.3372, 0.3510],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 181 Loss: 0.3427 Alpha: tensor([0.3413, 0.3455, 0.3427, 0.3338, 0.3499, 0.3364, 0.3504],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 182 Loss: 0.3410 Alpha: tensor([0.3405, 0.3448, 0.3420, 0.3331, 0.3493, 0.3356, 0.3497],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 183 Loss: 0.3389 Alpha: tensor([0.3397, 0.3441, 0.3412, 0.3323, 0.3486, 0.3349, 0.3491],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 184 Loss: 0.3369 Alpha: tensor([0.3390, 0.3434, 0.3405, 0.3316, 0.3480, 0.3341, 0.3484],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 185 Loss: 0.3366 Alpha: tensor([0.3382, 0.3427, 0.3397, 0.3309, 0.3473, 0.3334, 0.3477],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 186 Loss: 0.3363 Alpha: tensor([0.3374, 0.3421, 0.3390, 0.3301, 0.3467, 0.3326, 0.3471],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 187 Loss: 0.3354 Alpha: tensor([0.3366, 0.3414, 0.3382, 0.3294, 0.3461, 0.3318, 0.3464],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 188 Loss: 0.3342 Alpha: tensor([0.3358, 0.3407, 0.3375, 0.3287, 0.3454, 0.3311, 0.3458],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 189 Loss: 0.3327 Alpha: tensor([0.3350, 0.3400, 0.3367, 0.3279, 0.3448, 0.3303, 0.3451],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 190 Loss: 0.3351 Alpha: tensor([0.3342, 0.3394, 0.3360, 0.3272, 0.3442, 0.3296, 0.3445],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 191 Loss: 0.3355 Alpha: tensor([0.3334, 0.3387, 0.3352, 0.3265, 0.3435, 0.3288, 0.3438],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 192 Loss: 0.3358 Alpha: tensor([0.3326, 0.3380, 0.3345, 0.3258, 0.3429, 0.3281, 0.3432],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 193 Loss: 0.3356 Alpha: tensor([0.3319, 0.3373, 0.3337, 0.3251, 0.3423, 0.3273, 0.3425],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 194 Loss: 0.3345 Alpha: tensor([0.3311, 0.3367, 0.3330, 0.3244, 0.3416, 0.3266, 0.3419],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 195 Loss: 0.3333 Alpha: tensor([0.3303, 0.3360, 0.3322, 0.3236, 0.3410, 0.3259, 0.3412],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 196 Loss: 0.3315 Alpha: tensor([0.3295, 0.3353, 0.3315, 0.3229, 0.3404, 0.3251, 0.3406],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 197 Loss: 0.3293 Alpha: tensor([0.3288, 0.3346, 0.3308, 0.3222, 0.3397, 0.3244, 0.3399],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 198 Loss: 0.3274 Alpha: tensor([0.3280, 0.3340, 0.3300, 0.3215, 0.3391, 0.3236, 0.3393],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 199 Loss: 0.3253 Alpha: tensor([0.3272, 0.3333, 0.3293, 0.3208, 0.3385, 0.3229, 0.3386],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 200 Loss: 0.3250 Alpha: tensor([0.3264, 0.3326, 0.3285, 0.3201, 0.3379, 0.3222, 0.3380],
       device='cuda:0', grad_fn=<SelectBackward0>)