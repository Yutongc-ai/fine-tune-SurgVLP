/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
num_shots is  1
num_shots is  1
Epoch 1 Loss: 0.8103
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.98it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.99it/s]
Epoch 1 best val f1 0.2353 test f1 0.10717206448316574
Epoch 2 Loss: -0.2059
Epoch 3 Loss: -0.5641
Epoch 4 Loss: -0.7086
Epoch 5 Loss: -0.8345
Epoch 6 Loss: -0.9464
Epoch 7 Loss: -1.0516
Epoch 8 Loss: -1.1538
Epoch 9 Loss: -1.2542
Epoch 10 Loss: -1.3545
Epoch 11 Loss: -1.4558
Epoch 12 Loss: -1.5579
Epoch 13 Loss: -1.6626
Epoch 14 Loss: -1.7707
Epoch 15 Loss: -1.8828
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.99it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.01it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.96it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.08it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.99it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.41it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.98it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.97it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.06it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
Epoch 16 Loss: -1.9958
Epoch 17 Loss: -2.1110
Epoch 18 Loss: -2.2311
Epoch 19 Loss: -2.3544
Epoch 20 Loss: -2.4802
Epoch 21 Loss: -2.6089
Epoch 22 Loss: -2.7409
Epoch 23 Loss: -2.8743
Epoch 24 Loss: -3.0104
Epoch 25 Loss: -3.1481
Epoch 26 Loss: -3.2860
Epoch 27 Loss: -3.4233
Epoch 28 Loss: -3.5603
Epoch 29 Loss: -3.6978
Epoch 30 Loss: -3.8360
Epoch 31 Loss: -3.9748
Epoch 32 Loss: -4.1143
Epoch 33 Loss: -4.2545
Epoch 34 Loss: -4.3954
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.44it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.06it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.08it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 35 Loss: -4.5372
Epoch 36 Loss: -4.6798
Epoch 37 Loss: -4.8231
Epoch 38 Loss: -4.9673
Epoch 39 Loss: -5.1124
Epoch 40 Loss: -5.2581
Epoch 41 Loss: -5.4045
Epoch 42 Loss: -5.5516
Epoch 43 Loss: -5.6993
Epoch 44 Loss: -5.8476
Epoch 45 Loss: -5.9965
Epoch 46 Loss: -6.1459
Epoch 47 Loss: -6.2960
Epoch 48 Loss: -6.4467
Epoch 49 Loss: -6.5979
Epoch 50 Loss: -6.7497
Epoch 51 Loss: -6.9019
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.47it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.13it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.25it/s]
Epoch 53 Loss: -7.2077
Epoch 54 Loss: -7.3614
Epoch 54 best val f1 0.3333 test f1 0.10373151302337646
Epoch 55 Loss: -7.5154
Epoch 56 Loss: -7.6700
Epoch 57 Loss: -7.8250
Epoch 58 Loss: -7.9804
Epoch 59 Loss: -8.1362
Epoch 60 Loss: -8.2924
Epoch 61 Loss: -8.4491
Epoch 62 Loss: -8.6062
Epoch 63 Loss: -8.7637
Epoch 64 Loss: -8.9216
Epoch 65 Loss: -9.0798
Epoch 66 Loss: -9.2387
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.06it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.13it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.32it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 67 Loss: -9.4426
Epoch 68 Loss: -9.8355
Epoch 69 Loss: -9.7663
Epoch 70 Loss: -10.2147
Epoch 71 Loss: -10.5453
Epoch 72 Loss: -10.8040
Epoch 73 Loss: -10.9800
Epoch 74 Loss: -11.1572
Epoch 75 Loss: -11.3351
Epoch 76 Loss: -11.5195
Epoch 77 Loss: -11.7084
Epoch 78 Loss: -11.9044
Epoch 79 Loss: -12.1032
Epoch 80 Loss: -12.3015
Epoch 81 Loss: -12.4994
Epoch 82 Loss: -12.6975
Epoch 83 Loss: -12.8989
Epoch 84 Loss: -13.1005
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.34it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.03it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.01it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 86 Loss: -13.5011
Epoch 87 Loss: -13.7004
Epoch 88 Loss: -13.8991
Epoch 89 Loss: -14.0973
Epoch 90 Loss: -14.2951
Epoch 91 Loss: -14.4926
Epoch 92 Loss: -14.6900
Epoch 93 Loss: -14.8875
Epoch 94 Loss: -15.0850
Epoch 95 Loss: -15.2825
Epoch 96 Loss: -15.4798
Epoch 97 Loss: -15.6771
Epoch 98 Loss: -15.8742
Epoch 99 Loss: -16.0721
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.12it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.96it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.06it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.01it/s]