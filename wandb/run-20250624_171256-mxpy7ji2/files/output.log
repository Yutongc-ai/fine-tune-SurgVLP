/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
num_shots is  1
num_shots is  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.99it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.52it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 1 Loss: 1.0517
Epoch 1 best val f1 0.2000 test f1 0.18444916605949402
Epoch 2 Loss: 0.2637
Epoch 2 best val f1 0.2353 test f1 0.2846297025680542
Epoch 3 Loss: -0.0573
Epoch 3 best val f1 0.4000 test f1 0.39990946650505066
Epoch 4 Loss: -0.1727
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.78it/s]
Epoch 5 Loss: -0.2033
Epoch 6 Loss: -0.2302
Epoch 7 Loss: -0.2547
Epoch 8 Loss: -0.2773
Epoch 9 Loss: -0.2990
Epoch 10 Loss: -0.3222
Epoch 11 Loss: -0.3470
Epoch 12 Loss: -0.3712
Epoch 13 Loss: -0.3946
Epoch 14 Loss: -0.4178
Epoch 15 Loss: -0.4410
Epoch 16 Loss: -0.4647
Epoch 17 Loss: -0.4889
Epoch 18 Loss: -0.5139
Epoch 19 Loss: -0.5394
Epoch 20 Loss: -0.5656
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.43it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 20 best val f1 0.5185 test f1 0.4850161075592041
Epoch 21 Loss: -0.5920
Epoch 22 Loss: -0.6184
Epoch 23 Loss: -0.6451
Epoch 24 Loss: -0.6721
Epoch 25 Loss: -0.6993
Epoch 26 Loss: -0.7262
Epoch 27 Loss: -0.7530
Epoch 28 Loss: -0.7795
Epoch 29 Loss: -0.8061
Epoch 30 Loss: -0.8326
Epoch 31 Loss: -0.8593
Epoch 32 Loss: -0.8861
Epoch 33 Loss: -0.9130
Epoch 34 Loss: -0.9401
Epoch 35 Loss: -0.9672
Epoch 36 Loss: -0.9943
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.75it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 38 Loss: -1.0489
Epoch 39 Loss: -1.0766
Epoch 40 Loss: -1.1050
Epoch 41 Loss: -1.1340
Epoch 42 Loss: -1.1633
Epoch 43 Loss: -1.1932
Epoch 44 Loss: -1.2242
Epoch 45 Loss: -1.2556
Epoch 46 Loss: -1.2881
Epoch 47 Loss: -1.3237
Epoch 48 Loss: -1.3631
Epoch 49 Loss: -1.4069
Epoch 50 Loss: -1.4559
Epoch 51 Loss: -1.5062
Epoch 52 Loss: -1.5572
Epoch 53 Loss: -1.6086
Epoch 54 Loss: -1.6580
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.37it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 56 Loss: -1.7506
Epoch 57 Loss: -1.7954
Epoch 58 Loss: -1.8399
Epoch 59 Loss: -1.8844
Epoch 60 Loss: -1.9287
Epoch 61 Loss: -1.9732
Epoch 62 Loss: -2.0181
Epoch 63 Loss: -2.0634
Epoch 64 Loss: -2.1090
Epoch 65 Loss: -2.1548
Epoch 66 Loss: -2.2009
Epoch 67 Loss: -2.2472
Epoch 68 Loss: -2.2938
Epoch 69 Loss: -2.3418
Epoch 70 Loss: -2.3910
Epoch 71 Loss: -2.4502
Epoch 72 Loss: -2.5138
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.81it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.57it/s]
Epoch 74 Loss: -2.6523
Epoch 75 Loss: -2.7354
Epoch 76 Loss: -2.8112
Epoch 77 Loss: -2.8723
Epoch 78 Loss: -2.9392
Epoch 79 Loss: -2.9995
Epoch 80 Loss: -3.0591
Epoch 81 Loss: -3.1185
Epoch 82 Loss: -3.1779
Epoch 83 Loss: -3.2374
Epoch 84 Loss: -3.2971
Epoch 85 Loss: -3.3570
Epoch 86 Loss: -3.4171
Epoch 87 Loss: -3.4775
Epoch 88 Loss: -3.5382
Epoch 89 Loss: -3.5993
Epoch 90 Loss: -3.6606
Epoch 91 Loss: -3.7221
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.81it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.03it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.22it/s]
Epoch 92 Loss: -3.7836
Epoch 93 Loss: -3.8449
Epoch 94 Loss: -3.9062
Epoch 95 Loss: -3.9682
Epoch 96 Loss: -4.0303
Epoch 97 Loss: -4.0922
Epoch 98 Loss: -4.1541
Epoch 99 Loss: -4.2161
Epoch 100 Loss: -4.2782