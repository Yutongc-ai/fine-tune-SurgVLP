/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
num_shots is  1
num_shots is  1
Epoch 1 Loss: 0.9424
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  5.40it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.29it/s]
Epoch 1 best val f1 0.2000 test f1 0.17524771392345428
Epoch 2 Loss: 0.1130
Epoch 2 best val f1 0.2353 test f1 0.25931254029273987
Epoch 3 Loss: -0.2361
Epoch 3 best val f1 0.4000 test f1 0.3688843250274658
Epoch 4 Loss: -0.3874
Epoch 4 best val f1 0.5000 test f1 0.44009634852409363
Epoch 5 Loss: -0.4403
Epoch 6 Loss: -0.4880
Epoch 7 Loss: -0.5314
Epoch 8 Loss: -0.5730
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
Epoch 9 Loss: -0.6137
Epoch 10 Loss: -0.6537
Epoch 11 Loss: -0.6939
Epoch 12 Loss: -0.7345
Epoch 13 Loss: -0.7750
Epoch 14 Loss: -0.8150
Epoch 15 Loss: -0.8545
Epoch 16 Loss: -0.8942
Epoch 17 Loss: -0.9346
Epoch 18 Loss: -0.9755
Epoch 19 Loss: -1.0175
Epoch 20 Loss: -1.0607
Epoch 21 Loss: -1.1049
Epoch 22 Loss: -1.1495
Epoch 23 Loss: -1.1944
Epoch 24 Loss: -1.2391
Epoch 25 Loss: -1.2837
Epoch 26 Loss: -1.3284
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.96it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
Epoch 27 Loss: -1.3736
Epoch 28 Loss: -1.4194
Epoch 29 Loss: -1.4657
Epoch 30 Loss: -1.5124
Epoch 31 Loss: -1.5594
Epoch 32 Loss: -1.6067
Epoch 33 Loss: -1.6544
Epoch 34 Loss: -1.7027
Epoch 35 Loss: -1.7516
Epoch 36 Loss: -1.8009
Epoch 37 Loss: -1.8508
Epoch 38 Loss: -1.9010
Epoch 38 best val f1 0.5185 test f1 0.3882509171962738
Epoch 39 Loss: -1.9518
Epoch 40 Loss: -2.0031
Epoch 41 Loss: -2.0548
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.00it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.99it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.03it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.01it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.81it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.01it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.38it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.09it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 42 Loss: -2.1070
Epoch 43 Loss: -2.1603
Epoch 44 Loss: -2.2150
Epoch 45 Loss: -2.2731
Epoch 46 Loss: -2.3352
Epoch 47 Loss: -2.4031
Epoch 48 Loss: -2.4738
Epoch 49 Loss: -2.5446
Epoch 50 Loss: -2.6140
Epoch 51 Loss: -2.6813
Epoch 52 Loss: -2.7470
Epoch 53 Loss: -2.8118
Epoch 54 Loss: -2.8763
Epoch 55 Loss: -2.9410
Epoch 56 Loss: -3.0059
Epoch 57 Loss: -3.0714
Epoch 58 Loss: -3.1373
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.02it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.01it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.88it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.85it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.44it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.82it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 60 Loss: -3.2702
Epoch 61 Loss: -3.3378
Epoch 62 Loss: -3.4062
Epoch 63 Loss: -3.4752
Epoch 64 Loss: -3.5451
Epoch 65 Loss: -3.6153
Epoch 66 Loss: -3.6859
Epoch 67 Loss: -3.7573
Epoch 68 Loss: -3.8288
Epoch 69 Loss: -3.9002
Epoch 70 Loss: -3.9717
Epoch 71 Loss: -4.0440
Epoch 72 Loss: -4.1165
Epoch 73 Loss: -4.1899
Epoch 74 Loss: -4.2643
Epoch 75 Loss: -4.3390
Epoch 76 Loss: -4.4171
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.92it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.92it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.99it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.91it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.92it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
Epoch 78 Loss: -4.6040
Epoch 79 Loss: -4.7077
Epoch 80 Loss: -4.8079
Epoch 81 Loss: -4.9029
Epoch 82 Loss: -5.0045
Epoch 83 Loss: -5.1071
Epoch 84 Loss: -5.2142
Epoch 85 Loss: -5.3246
Epoch 86 Loss: -5.4289
Epoch 87 Loss: -5.5268
Epoch 88 Loss: -5.6217
Epoch 89 Loss: -5.7151
Epoch 90 Loss: -5.8078
Epoch 91 Loss: -5.9005
Epoch 92 Loss: -5.9950
Epoch 93 Loss: -6.0912
Epoch 94 Loss: -6.1872
Epoch 95 Loss: -6.2827
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.99it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.87it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.84it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.68it/s]
Epoch 96 Loss: -6.3775
Epoch 97 Loss: -6.4720
Epoch 98 Loss: -6.5664
Epoch 99 Loss: -6.6620
Epoch 100 Loss: -6.7578