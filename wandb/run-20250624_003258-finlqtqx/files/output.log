/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
num_shots is  1
num_shots is  1
Epoch 1 Loss: 1.5187 Alpha: tensor([0.5010, 0.5010, 0.5010, 0.5010, 0.5010, 0.5010, 0.5010],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 1 best val f1 0.3934 test f1 0.3048006594181061
Epoch 2 Loss: 0.8077 Alpha: tensor([0.5011, 0.5014, 0.5015, 0.5017, 0.5016, 0.5016, 0.5016],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 3 Loss: 0.5485 Alpha: tensor([0.5008, 0.5014, 0.5016, 0.5018, 0.5018, 0.5018, 0.5018],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 Loss: 0.5286 Alpha: tensor([0.5002, 0.5011, 0.5013, 0.5018, 0.5018, 0.5017, 0.5016],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 5 Loss: 0.5221 Alpha: tensor([0.4996, 0.5008, 0.5009, 0.5015, 0.5015, 0.5015, 0.5014],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 6 Loss: 0.5175 Alpha: tensor([0.4989, 0.5004, 0.5004, 0.5011, 0.5012, 0.5011, 0.5010],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 6 best val f1 0.4138 test f1 0.3046509921550751
Epoch 7 Loss: 0.5132 Alpha: tensor([0.4981, 0.4999, 0.4998, 0.5006, 0.5007, 0.5007, 0.5005],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 8 Loss: 0.5094 Alpha: tensor([0.4973, 0.4993, 0.4991, 0.5000, 0.5002, 0.5002, 0.4999],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 9 Loss: 0.5048 Alpha: tensor([0.4964, 0.4987, 0.4984, 0.4994, 0.4997, 0.4996, 0.4993],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 10 Loss: 0.4998 Alpha: tensor([0.4956, 0.4981, 0.4977, 0.4987, 0.4990, 0.4990, 0.4986],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 11 Loss: 0.4942 Alpha: tensor([0.4947, 0.4975, 0.4969, 0.4980, 0.4984, 0.4984, 0.4979],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 12 Loss: 0.4881 Alpha: tensor([0.4938, 0.4968, 0.4961, 0.4972, 0.4977, 0.4977, 0.4971],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 13 Loss: 0.4811 Alpha: tensor([0.4929, 0.4961, 0.4953, 0.4965, 0.4970, 0.4970, 0.4963],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 14 Loss: 0.4737 Alpha: tensor([0.4920, 0.4953, 0.4944, 0.4957, 0.4962, 0.4963, 0.4956],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 15 Loss: 0.4655 Alpha: tensor([0.4911, 0.4946, 0.4936, 0.4949, 0.4955, 0.4955, 0.4947],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 16 Loss: 0.4566 Alpha: tensor([0.4902, 0.4939, 0.4927, 0.4941, 0.4947, 0.4948, 0.4939],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 17 Loss: 0.4464 Alpha: tensor([0.4893, 0.4931, 0.4919, 0.4932, 0.4939, 0.4940, 0.4931],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 18 Loss: 0.4368 Alpha: tensor([0.4884, 0.4924, 0.4910, 0.4924, 0.4931, 0.4932, 0.4922],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 19 Loss: 0.4270 Alpha: tensor([0.4876, 0.4916, 0.4901, 0.4915, 0.4923, 0.4924, 0.4913],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 20 Loss: 0.4168 Alpha: tensor([0.4867, 0.4908, 0.4893, 0.4907, 0.4914, 0.4916, 0.4905],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 21 Loss: 0.4064 Alpha: tensor([0.4859, 0.4901, 0.4884, 0.4898, 0.4906, 0.4908, 0.4896],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 22 Loss: 0.3966 Alpha: tensor([0.4850, 0.4893, 0.4875, 0.4889, 0.4898, 0.4899, 0.4887],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 Loss: 0.3875 Alpha: tensor([0.4842, 0.4886, 0.4867, 0.4880, 0.4889, 0.4891, 0.4878],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 24 Loss: 0.3795 Alpha: tensor([0.4833, 0.4878, 0.4858, 0.4871, 0.4880, 0.4883, 0.4868],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 25 Loss: 0.3718 Alpha: tensor([0.4825, 0.4870, 0.4850, 0.4862, 0.4872, 0.4874, 0.4859],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 Loss: 0.3644 Alpha: tensor([0.4816, 0.4863, 0.4841, 0.4853, 0.4863, 0.4866, 0.4850],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 27 Loss: 0.3571 Alpha: tensor([0.4808, 0.4855, 0.4833, 0.4844, 0.4855, 0.4857, 0.4840],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 28 Loss: 0.3501 Alpha: tensor([0.4799, 0.4846, 0.4824, 0.4835, 0.4846, 0.4848, 0.4831],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 29 Loss: 0.3436 Alpha: tensor([0.4790, 0.4838, 0.4815, 0.4825, 0.4837, 0.4840, 0.4821],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 30 Loss: 0.3375 Alpha: tensor([0.4781, 0.4830, 0.4807, 0.4816, 0.4828, 0.4831, 0.4812],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 31 Loss: 0.3311 Alpha: tensor([0.4772, 0.4821, 0.4798, 0.4807, 0.4820, 0.4822, 0.4802],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 32 Loss: 0.3257 Alpha: tensor([0.4763, 0.4812, 0.4789, 0.4798, 0.4811, 0.4813, 0.4792],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 33 Loss: 0.3203 Alpha: tensor([0.4754, 0.4803, 0.4781, 0.4788, 0.4802, 0.4805, 0.4783],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 34 Loss: 0.3150 Alpha: tensor([0.4745, 0.4794, 0.4772, 0.4779, 0.4793, 0.4796, 0.4773],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 35 Loss: 0.3097 Alpha: tensor([0.4736, 0.4784, 0.4763, 0.4769, 0.4784, 0.4787, 0.4763],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 36 Loss: 0.3047 Alpha: tensor([0.4726, 0.4775, 0.4754, 0.4760, 0.4775, 0.4778, 0.4753],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 37 Loss: 0.3001 Alpha: tensor([0.4716, 0.4765, 0.4745, 0.4750, 0.4766, 0.4768, 0.4743],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 38 Loss: 0.2963 Alpha: tensor([0.4706, 0.4755, 0.4736, 0.4741, 0.4757, 0.4759, 0.4733],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 39 Loss: 0.2970 Alpha: tensor([0.4697, 0.4745, 0.4727, 0.4731, 0.4748, 0.4750, 0.4723],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 40 Loss: 0.2943 Alpha: tensor([0.4686, 0.4734, 0.4718, 0.4722, 0.4739, 0.4741, 0.4713],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 41 Loss: 0.2907 Alpha: tensor([0.4676, 0.4724, 0.4709, 0.4712, 0.4730, 0.4731, 0.4703],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 42 Loss: 0.2856 Alpha: tensor([0.4666, 0.4714, 0.4700, 0.4703, 0.4720, 0.4722, 0.4693],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 43 Loss: 0.2821 Alpha: tensor([0.4656, 0.4703, 0.4691, 0.4693, 0.4711, 0.4712, 0.4683],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 44 Loss: 0.2810 Alpha: tensor([0.4645, 0.4692, 0.4682, 0.4684, 0.4702, 0.4703, 0.4673],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 45 Loss: 0.2777 Alpha: tensor([0.4635, 0.4681, 0.4672, 0.4674, 0.4692, 0.4693, 0.4663],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 46 Loss: 0.2735 Alpha: tensor([0.4624, 0.4670, 0.4663, 0.4664, 0.4683, 0.4683, 0.4653],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 47 Loss: 0.2705 Alpha: tensor([0.4613, 0.4659, 0.4653, 0.4655, 0.4673, 0.4674, 0.4643],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 48 Loss: 0.2679 Alpha: tensor([0.4603, 0.4648, 0.4644, 0.4645, 0.4664, 0.4664, 0.4633],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 49 Loss: 0.2648 Alpha: tensor([0.4592, 0.4637, 0.4634, 0.4636, 0.4654, 0.4654, 0.4623],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 50 Loss: 0.2614 Alpha: tensor([0.4581, 0.4626, 0.4625, 0.4626, 0.4645, 0.4645, 0.4613],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 51 Loss: 0.2590 Alpha: tensor([0.4570, 0.4614, 0.4615, 0.4616, 0.4635, 0.4635, 0.4602],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 52 Loss: 0.2565 Alpha: tensor([0.4559, 0.4603, 0.4606, 0.4607, 0.4626, 0.4625, 0.4592],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 53 Loss: 0.2545 Alpha: tensor([0.4548, 0.4592, 0.4596, 0.4597, 0.4616, 0.4615, 0.4582],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 54 Loss: 0.2525 Alpha: tensor([0.4538, 0.4580, 0.4587, 0.4587, 0.4606, 0.4605, 0.4572],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 55 Loss: 0.2509 Alpha: tensor([0.4527, 0.4569, 0.4577, 0.4578, 0.4597, 0.4596, 0.4562],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 56 Loss: 0.2492 Alpha: tensor([0.4516, 0.4557, 0.4567, 0.4568, 0.4587, 0.4586, 0.4552],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 57 Loss: 0.2482 Alpha: tensor([0.4505, 0.4546, 0.4558, 0.4558, 0.4577, 0.4576, 0.4542],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 58 Loss: 0.2467 Alpha: tensor([0.4494, 0.4535, 0.4548, 0.4549, 0.4568, 0.4566, 0.4532],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 59 Loss: 0.2455 Alpha: tensor([0.4483, 0.4523, 0.4539, 0.4539, 0.4558, 0.4556, 0.4522],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 60 Loss: 0.2446 Alpha: tensor([0.4472, 0.4512, 0.4529, 0.4529, 0.4548, 0.4546, 0.4513],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 61 Loss: 0.2438 Alpha: tensor([0.4461, 0.4500, 0.4519, 0.4520, 0.4538, 0.4536, 0.4503],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 62 Loss: 0.2444 Alpha: tensor([0.4450, 0.4489, 0.4510, 0.4510, 0.4529, 0.4527, 0.4493],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 63 Loss: 0.2435 Alpha: tensor([0.4439, 0.4478, 0.4500, 0.4500, 0.4519, 0.4517, 0.4483],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 64 Loss: 0.2429 Alpha: tensor([0.4428, 0.4466, 0.4490, 0.4491, 0.4509, 0.4507, 0.4473],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 65 Loss: 0.2421 Alpha: tensor([0.4417, 0.4455, 0.4481, 0.4481, 0.4500, 0.4497, 0.4463],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 66 Loss: 0.2411 Alpha: tensor([0.4406, 0.4444, 0.4471, 0.4472, 0.4490, 0.4487, 0.4454],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 67 Loss: 0.2405 Alpha: tensor([0.4395, 0.4432, 0.4462, 0.4462, 0.4480, 0.4477, 0.4444],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 68 Loss: 0.2404 Alpha: tensor([0.4384, 0.4421, 0.4452, 0.4452, 0.4470, 0.4468, 0.4434],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 69 Loss: 0.2394 Alpha: tensor([0.4374, 0.4410, 0.4442, 0.4443, 0.4461, 0.4458, 0.4424],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 70 Loss: 0.2389 Alpha: tensor([0.4363, 0.4399, 0.4433, 0.4433, 0.4451, 0.4448, 0.4415],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 71 Loss: 0.2384 Alpha: tensor([0.4352, 0.4388, 0.4423, 0.4424, 0.4441, 0.4438, 0.4405],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 72 Loss: 0.2385 Alpha: tensor([0.4341, 0.4376, 0.4414, 0.4414, 0.4432, 0.4429, 0.4396],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 73 Loss: 0.2373 Alpha: tensor([0.4331, 0.4365, 0.4404, 0.4405, 0.4422, 0.4419, 0.4386],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 74 Loss: 0.2369 Alpha: tensor([0.4320, 0.4354, 0.4395, 0.4395, 0.4412, 0.4409, 0.4376],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 75 Loss: 0.2365 Alpha: tensor([0.4310, 0.4343, 0.4385, 0.4386, 0.4402, 0.4400, 0.4367],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 76 Loss: 0.2357 Alpha: tensor([0.4299, 0.4332, 0.4376, 0.4376, 0.4393, 0.4390, 0.4357],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 77 Loss: 0.2355 Alpha: tensor([0.4289, 0.4321, 0.4366, 0.4367, 0.4383, 0.4380, 0.4348],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 78 Loss: 0.2358 Alpha: tensor([0.4278, 0.4310, 0.4357, 0.4357, 0.4373, 0.4371, 0.4338],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 79 Loss: 0.2358 Alpha: tensor([0.4268, 0.4299, 0.4347, 0.4348, 0.4364, 0.4361, 0.4329],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 80 Loss: 0.2361 Alpha: tensor([0.4257, 0.4288, 0.4338, 0.4338, 0.4354, 0.4352, 0.4319],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 81 Loss: 0.2352 Alpha: tensor([0.4247, 0.4277, 0.4329, 0.4329, 0.4344, 0.4342, 0.4310],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 82 Loss: 0.2358 Alpha: tensor([0.4236, 0.4267, 0.4319, 0.4320, 0.4335, 0.4333, 0.4300],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 83 Loss: 0.2349 Alpha: tensor([0.4226, 0.4256, 0.4310, 0.4310, 0.4325, 0.4323, 0.4291],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 84 Loss: 0.2346 Alpha: tensor([0.4216, 0.4245, 0.4301, 0.4301, 0.4316, 0.4314, 0.4282],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 85 Loss: 0.2335 Alpha: tensor([0.4206, 0.4234, 0.4292, 0.4292, 0.4306, 0.4304, 0.4272],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 86 Loss: 0.2337 Alpha: tensor([0.4195, 0.4224, 0.4282, 0.4282, 0.4297, 0.4295, 0.4263],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 87 Loss: 0.2329 Alpha: tensor([0.4185, 0.4213, 0.4273, 0.4273, 0.4287, 0.4285, 0.4254],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 88 Loss: 0.2323 Alpha: tensor([0.4175, 0.4202, 0.4264, 0.4264, 0.4278, 0.4276, 0.4244],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 89 Loss: 0.2313 Alpha: tensor([0.4165, 0.4192, 0.4255, 0.4255, 0.4268, 0.4266, 0.4235],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 90 Loss: 0.2305 Alpha: tensor([0.4155, 0.4181, 0.4246, 0.4245, 0.4259, 0.4257, 0.4226],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 91 Loss: 0.2300 Alpha: tensor([0.4145, 0.4171, 0.4236, 0.4236, 0.4249, 0.4248, 0.4217],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 92 Loss: 0.2293 Alpha: tensor([0.4135, 0.4160, 0.4227, 0.4227, 0.4240, 0.4238, 0.4207],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 93 Loss: 0.3036 Alpha: tensor([0.4125, 0.4150, 0.4218, 0.4218, 0.4230, 0.4229, 0.4198],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 94 Loss: 0.3075 Alpha: tensor([0.4115, 0.4140, 0.4209, 0.4209, 0.4221, 0.4220, 0.4189],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 94 best val f1 0.4737 test f1 0.23911046981811523
Epoch 95 Loss: 0.2822 Alpha: tensor([0.4105, 0.4129, 0.4200, 0.4200, 0.4211, 0.4211, 0.4180],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 95 best val f1 0.4762 test f1 0.23899008333683014
Epoch 96 Loss: 0.2731 Alpha: tensor([0.4095, 0.4119, 0.4191, 0.4191, 0.4202, 0.4201, 0.4171],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 97 Loss: 0.2667 Alpha: tensor([0.4085, 0.4109, 0.4182, 0.4182, 0.4192, 0.4192, 0.4162],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 98 Loss: 0.2598 Alpha: tensor([0.4075, 0.4099, 0.4173, 0.4173, 0.4183, 0.4183, 0.4153],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 99 Loss: 0.2534 Alpha: tensor([0.4065, 0.4089, 0.4164, 0.4164, 0.4174, 0.4174, 0.4144],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 100 Loss: 0.2482 Alpha: tensor([0.4056, 0.4078, 0.4155, 0.4155, 0.4164, 0.4165, 0.4135],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 101 Loss: 0.2448 Alpha: tensor([0.4046, 0.4068, 0.4146, 0.4146, 0.4155, 0.4156, 0.4126],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 102 Loss: 0.2416 Alpha: tensor([0.4036, 0.4058, 0.4137, 0.4137, 0.4146, 0.4147, 0.4117],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 103 Loss: 0.2387 Alpha: tensor([0.4026, 0.4048, 0.4129, 0.4128, 0.4136, 0.4138, 0.4108],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 104 Loss: 0.2369 Alpha: tensor([0.4017, 0.4038, 0.4120, 0.4119, 0.4127, 0.4129, 0.4100],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 105 Loss: 0.2487 Alpha: tensor([0.4007, 0.4028, 0.4111, 0.4110, 0.4118, 0.4120, 0.4091],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 106 Loss: 0.2581 Alpha: tensor([0.3998, 0.4018, 0.4103, 0.4101, 0.4109, 0.4111, 0.4082],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 107 Loss: 0.2651 Alpha: tensor([0.3988, 0.4009, 0.4094, 0.4092, 0.4100, 0.4102, 0.4073],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 108 Loss: 0.2652 Alpha: tensor([0.3979, 0.3999, 0.4085, 0.4084, 0.4091, 0.4093, 0.4064],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 109 Loss: 0.2607 Alpha: tensor([0.3969, 0.3989, 0.4077, 0.4075, 0.4082, 0.4084, 0.4056],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 110 Loss: 0.2555 Alpha: tensor([0.3960, 0.3979, 0.4068, 0.4066, 0.4073, 0.4075, 0.4047],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 111 Loss: 0.2507 Alpha: tensor([0.3951, 0.3970, 0.4060, 0.4057, 0.4064, 0.4066, 0.4038],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 112 Loss: 0.2470 Alpha: tensor([0.3941, 0.3960, 0.4051, 0.4048, 0.4055, 0.4058, 0.4030],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 113 Loss: 0.2659 Alpha: tensor([0.3932, 0.3950, 0.4043, 0.4040, 0.4046, 0.4049, 0.4021],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 114 Loss: 0.2744 Alpha: tensor([0.3923, 0.3941, 0.4034, 0.4031, 0.4038, 0.4040, 0.4012],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 115 Loss: 0.2721 Alpha: tensor([0.3913, 0.3931, 0.4026, 0.4022, 0.4029, 0.4031, 0.4004],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 116 Loss: 0.2695 Alpha: tensor([0.3904, 0.3921, 0.4018, 0.4014, 0.4020, 0.4023, 0.3995],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 117 Loss: 0.2656 Alpha: tensor([0.3895, 0.3912, 0.4009, 0.4005, 0.4011, 0.4014, 0.3987],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 118 Loss: 0.2617 Alpha: tensor([0.3886, 0.3902, 0.4001, 0.3997, 0.4003, 0.4006, 0.3978],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 119 Loss: 0.2571 Alpha: tensor([0.3876, 0.3893, 0.3992, 0.3988, 0.3994, 0.3997, 0.3970],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 120 Loss: 0.2573 Alpha: tensor([0.3867, 0.3883, 0.3984, 0.3980, 0.3985, 0.3989, 0.3961],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 121 Loss: 0.2678 Alpha: tensor([0.3858, 0.3874, 0.3976, 0.3971, 0.3976, 0.3980, 0.3953],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 122 Loss: 0.2742 Alpha: tensor([0.3849, 0.3864, 0.3967, 0.3963, 0.3968, 0.3972, 0.3945],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 123 Loss: 0.2738 Alpha: tensor([0.3840, 0.3855, 0.3959, 0.3954, 0.3959, 0.3963, 0.3936],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 124 Loss: 0.2694 Alpha: tensor([0.3831, 0.3846, 0.3951, 0.3946, 0.3951, 0.3955, 0.3928],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 125 Loss: 0.2642 Alpha: tensor([0.3822, 0.3836, 0.3942, 0.3937, 0.3942, 0.3946, 0.3920],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 126 Loss: 0.2595 Alpha: tensor([0.3813, 0.3827, 0.3934, 0.3929, 0.3933, 0.3938, 0.3912],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 127 Loss: 0.2550 Alpha: tensor([0.3804, 0.3818, 0.3926, 0.3920, 0.3925, 0.3929, 0.3904],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 128 Loss: 0.2508 Alpha: tensor([0.3795, 0.3809, 0.3918, 0.3912, 0.3916, 0.3921, 0.3896],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 129 Loss: 0.2472 Alpha: tensor([0.3786, 0.3800, 0.3909, 0.3903, 0.3908, 0.3913, 0.3887],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 130 Loss: 0.2446 Alpha: tensor([0.3777, 0.3790, 0.3901, 0.3895, 0.3900, 0.3904, 0.3879],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 131 Loss: 0.2421 Alpha: tensor([0.3768, 0.3781, 0.3893, 0.3886, 0.3891, 0.3896, 0.3871],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 132 Loss: 0.2397 Alpha: tensor([0.3759, 0.3772, 0.3885, 0.3878, 0.3883, 0.3888, 0.3863],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 133 Loss: 0.2377 Alpha: tensor([0.3750, 0.3763, 0.3877, 0.3870, 0.3874, 0.3879, 0.3855],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 134 Loss: 0.2360 Alpha: tensor([0.3741, 0.3754, 0.3869, 0.3861, 0.3866, 0.3871, 0.3847],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 135 Loss: 0.2341 Alpha: tensor([0.3732, 0.3745, 0.3861, 0.3853, 0.3858, 0.3863, 0.3839],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 136 Loss: 0.2324 Alpha: tensor([0.3723, 0.3736, 0.3853, 0.3845, 0.3849, 0.3855, 0.3831],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 137 Loss: 0.2308 Alpha: tensor([0.3714, 0.3727, 0.3845, 0.3836, 0.3841, 0.3846, 0.3823],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 137 best val f1 0.5000 test f1 0.22935408353805542
Epoch 138 Loss: 0.2293 Alpha: tensor([0.3705, 0.3717, 0.3837, 0.3828, 0.3833, 0.3838, 0.3815],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 138 best val f1 0.5556 test f1 0.22930678725242615
Epoch 139 Loss: 0.2279 Alpha: tensor([0.3696, 0.3708, 0.3829, 0.3820, 0.3824, 0.3830, 0.3808],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 139 best val f1 0.6316 test f1 0.22897890210151672
Epoch 140 Loss: 0.2265 Alpha: tensor([0.3687, 0.3699, 0.3821, 0.3811, 0.3816, 0.3822, 0.3800],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 141 Loss: 0.2251 Alpha: tensor([0.3679, 0.3690, 0.3813, 0.3803, 0.3808, 0.3814, 0.3792],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 142 Loss: 0.2239 Alpha: tensor([0.3670, 0.3681, 0.3805, 0.3795, 0.3800, 0.3806, 0.3784],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 143 Loss: 0.2229 Alpha: tensor([0.3661, 0.3673, 0.3797, 0.3787, 0.3792, 0.3797, 0.3776],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 144 Loss: 0.2218 Alpha: tensor([0.3652, 0.3664, 0.3789, 0.3778, 0.3783, 0.3789, 0.3768],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 145 Loss: 0.2209 Alpha: tensor([0.3643, 0.3655, 0.3781, 0.3770, 0.3775, 0.3781, 0.3761],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 146 Loss: 0.2200 Alpha: tensor([0.3635, 0.3646, 0.3773, 0.3762, 0.3767, 0.3773, 0.3753],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 147 Loss: 0.2196 Alpha: tensor([0.3626, 0.3637, 0.3765, 0.3754, 0.3759, 0.3765, 0.3745],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 148 Loss: 0.2193 Alpha: tensor([0.3617, 0.3628, 0.3757, 0.3746, 0.3751, 0.3757, 0.3737],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 149 Loss: 0.2186 Alpha: tensor([0.3608, 0.3619, 0.3750, 0.3738, 0.3743, 0.3749, 0.3730],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 150 Loss: 0.2177 Alpha: tensor([0.3600, 0.3611, 0.3742, 0.3730, 0.3735, 0.3741, 0.3722],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 151 Loss: 0.2171 Alpha: tensor([0.3591, 0.3602, 0.3734, 0.3722, 0.3727, 0.3733, 0.3714],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 152 Loss: 0.2166 Alpha: tensor([0.3583, 0.3593, 0.3726, 0.3713, 0.3719, 0.3725, 0.3707],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 153 Loss: 0.2160 Alpha: tensor([0.3574, 0.3585, 0.3718, 0.3705, 0.3711, 0.3717, 0.3699],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 154 Loss: 0.2156 Alpha: tensor([0.3565, 0.3576, 0.3711, 0.3697, 0.3703, 0.3709, 0.3691],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 155 Loss: 0.2150 Alpha: tensor([0.3557, 0.3567, 0.3703, 0.3689, 0.3695, 0.3701, 0.3684],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 156 Loss: 0.2146 Alpha: tensor([0.3548, 0.3559, 0.3695, 0.3681, 0.3687, 0.3693, 0.3676],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 157 Loss: 0.2141 Alpha: tensor([0.3540, 0.3550, 0.3687, 0.3673, 0.3679, 0.3685, 0.3669],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 158 Loss: 0.2135 Alpha: tensor([0.3531, 0.3541, 0.3679, 0.3665, 0.3671, 0.3677, 0.3661],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 159 Loss: 0.2130 Alpha: tensor([0.3523, 0.3533, 0.3672, 0.3657, 0.3663, 0.3670, 0.3654],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 160 Loss: 0.2127 Alpha: tensor([0.3514, 0.3524, 0.3664, 0.3649, 0.3655, 0.3662, 0.3646],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 161 Loss: 0.2122 Alpha: tensor([0.3506, 0.3516, 0.3656, 0.3641, 0.3647, 0.3654, 0.3639],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 162 Loss: 0.2119 Alpha: tensor([0.3497, 0.3507, 0.3649, 0.3633, 0.3639, 0.3646, 0.3631],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 163 Loss: 0.2115 Alpha: tensor([0.3489, 0.3499, 0.3641, 0.3626, 0.3631, 0.3638, 0.3624],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 164 Loss: 0.2111 Alpha: tensor([0.3480, 0.3490, 0.3633, 0.3618, 0.3623, 0.3630, 0.3616],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 165 Loss: 0.2108 Alpha: tensor([0.3472, 0.3482, 0.3626, 0.3610, 0.3615, 0.3623, 0.3609],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 166 Loss: 0.2105 Alpha: tensor([0.3463, 0.3473, 0.3618, 0.3602, 0.3607, 0.3615, 0.3601],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 167 Loss: 0.2102 Alpha: tensor([0.3455, 0.3465, 0.3610, 0.3594, 0.3600, 0.3607, 0.3594],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 168 Loss: 0.2106 Alpha: tensor([0.3447, 0.3456, 0.3603, 0.3586, 0.3592, 0.3599, 0.3587],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 169 Loss: 0.2109 Alpha: tensor([0.3438, 0.3448, 0.3595, 0.3578, 0.3584, 0.3592, 0.3579],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 170 Loss: 0.2105 Alpha: tensor([0.3430, 0.3439, 0.3587, 0.3570, 0.3576, 0.3584, 0.3572],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 171 Loss: 0.2101 Alpha: tensor([0.3422, 0.3431, 0.3580, 0.3563, 0.3568, 0.3576, 0.3564],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 172 Loss: 0.2096 Alpha: tensor([0.3413, 0.3423, 0.3572, 0.3555, 0.3561, 0.3569, 0.3557],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 173 Loss: 0.2092 Alpha: tensor([0.3405, 0.3414, 0.3565, 0.3547, 0.3553, 0.3561, 0.3550],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 174 Loss: 0.2087 Alpha: tensor([0.3397, 0.3406, 0.3557, 0.3539, 0.3545, 0.3553, 0.3542],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 175 Loss: 0.2083 Alpha: tensor([0.3388, 0.3398, 0.3550, 0.3531, 0.3537, 0.3546, 0.3535],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 176 Loss: 0.2079 Alpha: tensor([0.3380, 0.3389, 0.3542, 0.3524, 0.3530, 0.3538, 0.3528],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 177 Loss: 0.2076 Alpha: tensor([0.3372, 0.3381, 0.3535, 0.3516, 0.3522, 0.3531, 0.3521],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 178 Loss: 0.2071 Alpha: tensor([0.3364, 0.3373, 0.3527, 0.3508, 0.3514, 0.3523, 0.3513],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 179 Loss: 0.2068 Alpha: tensor([0.3356, 0.3365, 0.3520, 0.3501, 0.3507, 0.3516, 0.3506],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 180 Loss: 0.2065 Alpha: tensor([0.3347, 0.3356, 0.3512, 0.3493, 0.3499, 0.3508, 0.3499],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 181 Loss: 0.2070 Alpha: tensor([0.3339, 0.3348, 0.3505, 0.3485, 0.3491, 0.3500, 0.3491],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 182 Loss: 0.2079 Alpha: tensor([0.3331, 0.3340, 0.3498, 0.3477, 0.3484, 0.3493, 0.3484],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 183 Loss: 0.2069 Alpha: tensor([0.3323, 0.3332, 0.3490, 0.3470, 0.3476, 0.3485, 0.3477],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 184 Loss: 0.2064 Alpha: tensor([0.3315, 0.3323, 0.3483, 0.3462, 0.3468, 0.3478, 0.3470],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 185 Loss: 0.2063 Alpha: tensor([0.3307, 0.3315, 0.3475, 0.3455, 0.3461, 0.3470, 0.3463],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 186 Loss: 0.2061 Alpha: tensor([0.3299, 0.3307, 0.3468, 0.3447, 0.3453, 0.3463, 0.3455],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 187 Loss: 0.2058 Alpha: tensor([0.3290, 0.3299, 0.3461, 0.3439, 0.3446, 0.3455, 0.3448],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 188 Loss: 0.2053 Alpha: tensor([0.3282, 0.3291, 0.3453, 0.3432, 0.3438, 0.3448, 0.3441],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 189 Loss: 0.2047 Alpha: tensor([0.3274, 0.3283, 0.3446, 0.3424, 0.3431, 0.3441, 0.3434],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 190 Loss: 0.2045 Alpha: tensor([0.3266, 0.3274, 0.3439, 0.3417, 0.3423, 0.3433, 0.3427],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 191 Loss: 0.2083 Alpha: tensor([0.3258, 0.3266, 0.3432, 0.3409, 0.3416, 0.3426, 0.3420],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 192 Loss: 0.2097 Alpha: tensor([0.3250, 0.3258, 0.3424, 0.3401, 0.3408, 0.3418, 0.3413],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 193 Loss: 0.2085 Alpha: tensor([0.3242, 0.3250, 0.3417, 0.3394, 0.3401, 0.3411, 0.3405],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 194 Loss: 0.2076 Alpha: tensor([0.3234, 0.3242, 0.3410, 0.3386, 0.3393, 0.3404, 0.3398],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 195 Loss: 0.2073 Alpha: tensor([0.3226, 0.3234, 0.3403, 0.3379, 0.3386, 0.3396, 0.3391],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 196 Loss: 0.2066 Alpha: tensor([0.3218, 0.3226, 0.3395, 0.3371, 0.3378, 0.3389, 0.3384],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 197 Loss: 0.2058 Alpha: tensor([0.3210, 0.3218, 0.3388, 0.3364, 0.3371, 0.3382, 0.3377],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 198 Loss: 0.2054 Alpha: tensor([0.3202, 0.3210, 0.3381, 0.3356, 0.3363, 0.3374, 0.3370],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 199 Loss: 0.2046 Alpha: tensor([0.3194, 0.3202, 0.3374, 0.3349, 0.3356, 0.3367, 0.3363],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 200 Loss: 0.2042 Alpha: tensor([0.3186, 0.3194, 0.3367, 0.3341, 0.3349, 0.3360, 0.3356],
       device='cuda:0', grad_fn=<SelectBackward0>)