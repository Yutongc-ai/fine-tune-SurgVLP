/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
num_shots is  1
num_shots is  1
Epoch 1 Loss: 1.1819 Alpha: tensor([0.4990, 0.5010, 0.5010, 0.5010, 0.5010, 0.5010, 0.5010],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 1 best val f1 0.4194 test f1 0.2991081774234772
Epoch 2 Loss: 0.6346 Alpha: tensor([0.4980, 0.5010, 0.5006, 0.5006, 0.5010, 0.5008, 0.5011],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 3 Loss: 0.5943 Alpha: tensor([0.4970, 0.5005, 0.5000, 0.4999, 0.5006, 0.5003, 0.5008],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 Loss: 0.5741 Alpha: tensor([0.4961, 0.5000, 0.4992, 0.4991, 0.5000, 0.4996, 0.5003],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 5 Loss: 0.5607 Alpha: tensor([0.4952, 0.4993, 0.4984, 0.4983, 0.4993, 0.4989, 0.4997],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 6 Loss: 0.5509 Alpha: tensor([0.4943, 0.4985, 0.4975, 0.4974, 0.4985, 0.4981, 0.4990],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 6 best val f1 0.4262 test f1 0.3040882647037506
Epoch 7 Loss: 0.5424 Alpha: tensor([0.4934, 0.4977, 0.4966, 0.4965, 0.4977, 0.4972, 0.4983],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 8 Loss: 0.5340 Alpha: tensor([0.4925, 0.4969, 0.4957, 0.4955, 0.4969, 0.4964, 0.4976],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 9 Loss: 0.5256 Alpha: tensor([0.4916, 0.4960, 0.4948, 0.4946, 0.4960, 0.4955, 0.4968],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 10 Loss: 0.5174 Alpha: tensor([0.4907, 0.4951, 0.4938, 0.4936, 0.4951, 0.4946, 0.4960],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 11 Loss: 0.5088 Alpha: tensor([0.4899, 0.4942, 0.4929, 0.4927, 0.4942, 0.4937, 0.4952],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 12 Loss: 0.5000 Alpha: tensor([0.4890, 0.4933, 0.4920, 0.4917, 0.4933, 0.4927, 0.4944],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 13 Loss: 0.4911 Alpha: tensor([0.4882, 0.4924, 0.4910, 0.4907, 0.4923, 0.4918, 0.4936],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 14 Loss: 0.4821 Alpha: tensor([0.4873, 0.4915, 0.4901, 0.4898, 0.4914, 0.4908, 0.4927],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 15 Loss: 0.4730 Alpha: tensor([0.4864, 0.4906, 0.4891, 0.4888, 0.4905, 0.4899, 0.4919],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 16 Loss: 0.4634 Alpha: tensor([0.4856, 0.4896, 0.4882, 0.4878, 0.4895, 0.4889, 0.4911],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 17 Loss: 0.4535 Alpha: tensor([0.4847, 0.4887, 0.4873, 0.4869, 0.4886, 0.4880, 0.4902],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 18 Loss: 0.4439 Alpha: tensor([0.4839, 0.4878, 0.4863, 0.4859, 0.4876, 0.4870, 0.4894],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 19 Loss: 0.4343 Alpha: tensor([0.4830, 0.4868, 0.4854, 0.4849, 0.4866, 0.4861, 0.4886],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 20 Loss: 0.4251 Alpha: tensor([0.4821, 0.4859, 0.4844, 0.4839, 0.4857, 0.4851, 0.4877],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 21 Loss: 0.4160 Alpha: tensor([0.4812, 0.4850, 0.4835, 0.4830, 0.4847, 0.4842, 0.4869],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 22 Loss: 0.4072 Alpha: tensor([0.4803, 0.4840, 0.4826, 0.4820, 0.4838, 0.4832, 0.4861],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 Loss: 0.3987 Alpha: tensor([0.4794, 0.4831, 0.4816, 0.4811, 0.4828, 0.4822, 0.4852],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 24 Loss: 0.3906 Alpha: tensor([0.4784, 0.4822, 0.4807, 0.4801, 0.4818, 0.4813, 0.4844],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 25 Loss: 0.3821 Alpha: tensor([0.4775, 0.4812, 0.4798, 0.4791, 0.4809, 0.4803, 0.4835],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 Loss: 0.3740 Alpha: tensor([0.4765, 0.4803, 0.4789, 0.4782, 0.4799, 0.4794, 0.4827],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 27 Loss: 0.3810 Alpha: tensor([0.4755, 0.4794, 0.4779, 0.4772, 0.4789, 0.4784, 0.4818],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 27 best val f1 0.5263 test f1 0.34266045689582825
Epoch 28 Loss: 0.3897 Alpha: tensor([0.4745, 0.4785, 0.4770, 0.4763, 0.4780, 0.4774, 0.4809],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 29 Loss: 0.3878 Alpha: tensor([0.4735, 0.4775, 0.4761, 0.4753, 0.4770, 0.4765, 0.4801],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 29 best val f1 0.6000 test f1 0.346089631319046
Epoch 30 Loss: 0.3796 Alpha: tensor([0.4725, 0.4766, 0.4751, 0.4743, 0.4760, 0.4755, 0.4792],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 31 Loss: 0.3740 Alpha: tensor([0.4714, 0.4757, 0.4742, 0.4734, 0.4751, 0.4746, 0.4783],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 32 Loss: 0.3692 Alpha: tensor([0.4704, 0.4747, 0.4732, 0.4724, 0.4741, 0.4736, 0.4774],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 33 Loss: 0.3613 Alpha: tensor([0.4693, 0.4738, 0.4723, 0.4714, 0.4731, 0.4726, 0.4765],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 34 Loss: 0.3537 Alpha: tensor([0.4682, 0.4729, 0.4713, 0.4705, 0.4721, 0.4717, 0.4756],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 35 Loss: 0.3469 Alpha: tensor([0.4671, 0.4719, 0.4704, 0.4695, 0.4712, 0.4707, 0.4746],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 36 Loss: 0.3407 Alpha: tensor([0.4660, 0.4710, 0.4695, 0.4685, 0.4702, 0.4698, 0.4737],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 37 Loss: 0.3348 Alpha: tensor([0.4648, 0.4701, 0.4685, 0.4675, 0.4692, 0.4688, 0.4728],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 38 Loss: 0.3290 Alpha: tensor([0.4637, 0.4691, 0.4676, 0.4666, 0.4682, 0.4679, 0.4718],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 39 Loss: 0.3230 Alpha: tensor([0.4626, 0.4682, 0.4667, 0.4656, 0.4673, 0.4669, 0.4709],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 40 Loss: 0.3178 Alpha: tensor([0.4614, 0.4673, 0.4657, 0.4646, 0.4663, 0.4660, 0.4699],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 41 Loss: 0.3129 Alpha: tensor([0.4603, 0.4664, 0.4648, 0.4636, 0.4653, 0.4650, 0.4689],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 42 Loss: 0.3080 Alpha: tensor([0.4591, 0.4654, 0.4639, 0.4627, 0.4644, 0.4641, 0.4679],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 43 Loss: 0.3033 Alpha: tensor([0.4579, 0.4645, 0.4630, 0.4617, 0.4634, 0.4632, 0.4670],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 44 Loss: 0.2989 Alpha: tensor([0.4567, 0.4636, 0.4621, 0.4608, 0.4625, 0.4622, 0.4660],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 45 Loss: 0.2948 Alpha: tensor([0.4556, 0.4627, 0.4611, 0.4598, 0.4615, 0.4613, 0.4650],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 46 Loss: 0.2908 Alpha: tensor([0.4544, 0.4618, 0.4602, 0.4588, 0.4606, 0.4604, 0.4640],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 47 Loss: 0.2871 Alpha: tensor([0.4532, 0.4608, 0.4593, 0.4579, 0.4596, 0.4595, 0.4629],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 48 Loss: 0.2834 Alpha: tensor([0.4520, 0.4599, 0.4584, 0.4569, 0.4587, 0.4586, 0.4619],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 49 Loss: 0.2800 Alpha: tensor([0.4508, 0.4590, 0.4576, 0.4560, 0.4578, 0.4577, 0.4609],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 50 Loss: 0.2768 Alpha: tensor([0.4497, 0.4581, 0.4567, 0.4550, 0.4568, 0.4568, 0.4599],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 51 Loss: 0.2739 Alpha: tensor([0.4485, 0.4572, 0.4558, 0.4541, 0.4559, 0.4559, 0.4589],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 52 Loss: 0.2710 Alpha: tensor([0.4473, 0.4563, 0.4549, 0.4531, 0.4550, 0.4550, 0.4578],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 53 Loss: 0.2683 Alpha: tensor([0.4461, 0.4553, 0.4540, 0.4522, 0.4540, 0.4541, 0.4568],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 54 Loss: 0.2658 Alpha: tensor([0.4449, 0.4544, 0.4531, 0.4513, 0.4531, 0.4532, 0.4558],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 55 Loss: 0.2710 Alpha: tensor([0.4437, 0.4535, 0.4522, 0.4503, 0.4522, 0.4523, 0.4547],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 56 Loss: 0.2726 Alpha: tensor([0.4426, 0.4526, 0.4513, 0.4494, 0.4513, 0.4514, 0.4537],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 57 Loss: 0.2707 Alpha: tensor([0.4414, 0.4517, 0.4504, 0.4485, 0.4504, 0.4505, 0.4526],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 58 Loss: 0.2674 Alpha: tensor([0.4402, 0.4508, 0.4495, 0.4475, 0.4494, 0.4497, 0.4516],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 59 Loss: 0.2641 Alpha: tensor([0.4390, 0.4499, 0.4487, 0.4466, 0.4485, 0.4488, 0.4505],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 60 Loss: 0.2618 Alpha: tensor([0.4378, 0.4489, 0.4478, 0.4457, 0.4476, 0.4479, 0.4495],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 61 Loss: 0.2599 Alpha: tensor([0.4367, 0.4480, 0.4469, 0.4447, 0.4467, 0.4470, 0.4484],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 62 Loss: 0.2575 Alpha: tensor([0.4355, 0.4471, 0.4460, 0.4438, 0.4458, 0.4461, 0.4474],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 63 Loss: 0.2552 Alpha: tensor([0.4343, 0.4462, 0.4451, 0.4429, 0.4449, 0.4453, 0.4463],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 64 Loss: 0.2532 Alpha: tensor([0.4332, 0.4453, 0.4442, 0.4420, 0.4440, 0.4444, 0.4453],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 65 Loss: 0.2511 Alpha: tensor([0.4320, 0.4444, 0.4433, 0.4410, 0.4431, 0.4435, 0.4442],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 66 Loss: 0.2493 Alpha: tensor([0.4309, 0.4435, 0.4424, 0.4401, 0.4422, 0.4427, 0.4432],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 67 Loss: 0.2476 Alpha: tensor([0.4297, 0.4426, 0.4415, 0.4392, 0.4413, 0.4418, 0.4421],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 68 Loss: 0.2461 Alpha: tensor([0.4286, 0.4417, 0.4406, 0.4383, 0.4404, 0.4409, 0.4411],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 69 Loss: 0.2446 Alpha: tensor([0.4274, 0.4407, 0.4397, 0.4373, 0.4395, 0.4401, 0.4400],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 70 Loss: 0.2433 Alpha: tensor([0.4263, 0.4398, 0.4388, 0.4364, 0.4387, 0.4392, 0.4390],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 71 Loss: 0.2422 Alpha: tensor([0.4251, 0.4389, 0.4379, 0.4355, 0.4378, 0.4384, 0.4379],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 72 Loss: 0.2409 Alpha: tensor([0.4240, 0.4380, 0.4370, 0.4346, 0.4369, 0.4375, 0.4369],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 73 Loss: 0.2401 Alpha: tensor([0.4229, 0.4371, 0.4361, 0.4336, 0.4360, 0.4367, 0.4358],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 74 Loss: 0.2391 Alpha: tensor([0.4217, 0.4362, 0.4352, 0.4327, 0.4351, 0.4358, 0.4348],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 75 Loss: 0.2380 Alpha: tensor([0.4206, 0.4353, 0.4343, 0.4318, 0.4343, 0.4349, 0.4338],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 76 Loss: 0.2372 Alpha: tensor([0.4195, 0.4344, 0.4334, 0.4309, 0.4334, 0.4341, 0.4327],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 77 Loss: 0.2362 Alpha: tensor([0.4184, 0.4335, 0.4325, 0.4300, 0.4325, 0.4332, 0.4317],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 78 Loss: 0.2354 Alpha: tensor([0.4173, 0.4326, 0.4316, 0.4291, 0.4316, 0.4324, 0.4306],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 79 Loss: 0.2346 Alpha: tensor([0.4161, 0.4317, 0.4307, 0.4282, 0.4308, 0.4315, 0.4296],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 80 Loss: 0.2336 Alpha: tensor([0.4150, 0.4308, 0.4298, 0.4272, 0.4299, 0.4307, 0.4286],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 81 Loss: 0.2330 Alpha: tensor([0.4139, 0.4299, 0.4289, 0.4263, 0.4290, 0.4298, 0.4275],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 82 Loss: 0.2324 Alpha: tensor([0.4128, 0.4290, 0.4281, 0.4254, 0.4282, 0.4290, 0.4265],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 83 Loss: 0.2318 Alpha: tensor([0.4117, 0.4281, 0.4272, 0.4245, 0.4273, 0.4281, 0.4255],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 84 Loss: 0.2310 Alpha: tensor([0.4107, 0.4272, 0.4263, 0.4236, 0.4264, 0.4273, 0.4244],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 85 Loss: 0.2304 Alpha: tensor([0.4096, 0.4263, 0.4254, 0.4227, 0.4256, 0.4264, 0.4234],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 86 Loss: 0.2304 Alpha: tensor([0.4085, 0.4254, 0.4245, 0.4218, 0.4247, 0.4256, 0.4224],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 87 Loss: 0.2303 Alpha: tensor([0.4074, 0.4246, 0.4236, 0.4209, 0.4239, 0.4247, 0.4214],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 88 Loss: 0.2299 Alpha: tensor([0.4063, 0.4237, 0.4227, 0.4200, 0.4230, 0.4239, 0.4203],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 89 Loss: 0.2293 Alpha: tensor([0.4052, 0.4228, 0.4218, 0.4191, 0.4222, 0.4230, 0.4193],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 90 Loss: 0.2293 Alpha: tensor([0.4042, 0.4219, 0.4210, 0.4182, 0.4213, 0.4222, 0.4183],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 91 Loss: 0.2290 Alpha: tensor([0.4031, 0.4210, 0.4201, 0.4173, 0.4204, 0.4213, 0.4173],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 92 Loss: 0.2290 Alpha: tensor([0.4020, 0.4202, 0.4192, 0.4164, 0.4196, 0.4205, 0.4162],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 93 Loss: 0.2280 Alpha: tensor([0.4010, 0.4193, 0.4183, 0.4155, 0.4187, 0.4196, 0.4152],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 94 Loss: 0.2273 Alpha: tensor([0.3999, 0.4184, 0.4174, 0.4147, 0.4179, 0.4188, 0.4142],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 95 Loss: 0.2268 Alpha: tensor([0.3988, 0.4175, 0.4166, 0.4138, 0.4171, 0.4179, 0.4132],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 96 Loss: 0.2261 Alpha: tensor([0.3978, 0.4167, 0.4157, 0.4129, 0.4162, 0.4171, 0.4122],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 97 Loss: 0.2257 Alpha: tensor([0.3967, 0.4158, 0.4148, 0.4120, 0.4154, 0.4162, 0.4112],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 98 Loss: 0.2259 Alpha: tensor([0.3957, 0.4149, 0.4139, 0.4111, 0.4145, 0.4154, 0.4102],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 99 Loss: 0.2255 Alpha: tensor([0.3946, 0.4141, 0.4131, 0.4102, 0.4137, 0.4145, 0.4092],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 100 Loss: 0.2253 Alpha: tensor([0.3936, 0.4132, 0.4122, 0.4094, 0.4128, 0.4137, 0.4081],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 101 Loss: 0.2247 Alpha: tensor([0.3925, 0.4123, 0.4113, 0.4085, 0.4120, 0.4128, 0.4071],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 102 Loss: 0.2243 Alpha: tensor([0.3915, 0.4115, 0.4105, 0.4076, 0.4112, 0.4120, 0.4061],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 103 Loss: 0.2237 Alpha: tensor([0.3905, 0.4106, 0.4096, 0.4067, 0.4103, 0.4112, 0.4051],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 104 Loss: 0.2235 Alpha: tensor([0.3894, 0.4097, 0.4087, 0.4059, 0.4095, 0.4103, 0.4041],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 105 Loss: 0.2231 Alpha: tensor([0.3884, 0.4089, 0.4079, 0.4050, 0.4087, 0.4095, 0.4031],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 106 Loss: 0.2226 Alpha: tensor([0.3874, 0.4080, 0.4070, 0.4041, 0.4078, 0.4087, 0.4021],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 107 Loss: 0.2227 Alpha: tensor([0.3863, 0.4072, 0.4061, 0.4032, 0.4070, 0.4078, 0.4011],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 108 Loss: 0.2225 Alpha: tensor([0.3853, 0.4063, 0.4053, 0.4024, 0.4062, 0.4070, 0.4001],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 109 Loss: 0.2222 Alpha: tensor([0.3843, 0.4055, 0.4044, 0.4015, 0.4053, 0.4062, 0.3992],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 110 Loss: 0.2218 Alpha: tensor([0.3832, 0.4046, 0.4036, 0.4007, 0.4045, 0.4053, 0.3982],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 111 Loss: 0.2216 Alpha: tensor([0.3822, 0.4037, 0.4027, 0.3998, 0.4037, 0.4045, 0.3972],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 112 Loss: 0.2211 Alpha: tensor([0.3812, 0.4029, 0.4019, 0.3989, 0.4029, 0.4037, 0.3962],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 113 Loss: 0.2208 Alpha: tensor([0.3802, 0.4021, 0.4010, 0.3981, 0.4021, 0.4029, 0.3952],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 114 Loss: 0.2219 Alpha: tensor([0.3792, 0.4012, 0.4002, 0.3972, 0.4012, 0.4020, 0.3942],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 115 Loss: 0.2212 Alpha: tensor([0.3781, 0.4004, 0.3993, 0.3963, 0.4004, 0.4012, 0.3932],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 116 Loss: 0.2207 Alpha: tensor([0.3771, 0.3995, 0.3985, 0.3955, 0.3996, 0.4004, 0.3923],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 117 Loss: 0.2200 Alpha: tensor([0.3761, 0.3987, 0.3976, 0.3946, 0.3988, 0.3996, 0.3913],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 118 Loss: 0.2196 Alpha: tensor([0.3751, 0.3978, 0.3968, 0.3938, 0.3980, 0.3987, 0.3903],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 119 Loss: 0.2196 Alpha: tensor([0.3741, 0.3970, 0.3959, 0.3929, 0.3972, 0.3979, 0.3893],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 120 Loss: 0.2192 Alpha: tensor([0.3731, 0.3962, 0.3951, 0.3921, 0.3964, 0.3971, 0.3884],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 121 Loss: 0.2190 Alpha: tensor([0.3721, 0.3953, 0.3943, 0.3912, 0.3956, 0.3963, 0.3874],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 122 Loss: 0.2189 Alpha: tensor([0.3711, 0.3945, 0.3934, 0.3904, 0.3948, 0.3955, 0.3864],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 123 Loss: 0.2183 Alpha: tensor([0.3701, 0.3937, 0.3926, 0.3895, 0.3940, 0.3947, 0.3855],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 124 Loss: 0.3723 Alpha: tensor([0.3691, 0.3928, 0.3917, 0.3887, 0.3932, 0.3939, 0.3845],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 125 Loss: 0.3683 Alpha: tensor([0.3681, 0.3920, 0.3909, 0.3878, 0.3923, 0.3930, 0.3835],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 126 Loss: 0.3693 Alpha: tensor([0.3671, 0.3911, 0.3900, 0.3870, 0.3915, 0.3922, 0.3826],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 127 Loss: 0.3686 Alpha: tensor([0.3661, 0.3903, 0.3891, 0.3861, 0.3907, 0.3914, 0.3816],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 128 Loss: 0.3495 Alpha: tensor([0.3651, 0.3894, 0.3882, 0.3853, 0.3899, 0.3905, 0.3807],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 129 Loss: 0.3378 Alpha: tensor([0.3641, 0.3886, 0.3873, 0.3845, 0.3891, 0.3897, 0.3797],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 130 Loss: 0.3247 Alpha: tensor([0.3631, 0.3877, 0.3864, 0.3837, 0.3883, 0.3889, 0.3788],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 131 Loss: 0.3161 Alpha: tensor([0.3621, 0.3868, 0.3855, 0.3828, 0.3875, 0.3881, 0.3779],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 132 Loss: 0.3071 Alpha: tensor([0.3611, 0.3860, 0.3846, 0.3820, 0.3867, 0.3873, 0.3769],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 133 Loss: 0.2986 Alpha: tensor([0.3601, 0.3851, 0.3838, 0.3812, 0.3859, 0.3865, 0.3760],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 134 Loss: 0.2924 Alpha: tensor([0.3591, 0.3843, 0.3829, 0.3804, 0.3852, 0.3857, 0.3751],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 135 Loss: 0.2873 Alpha: tensor([0.3581, 0.3834, 0.3821, 0.3796, 0.3844, 0.3849, 0.3742],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 136 Loss: 0.2823 Alpha: tensor([0.3572, 0.3826, 0.3812, 0.3788, 0.3836, 0.3841, 0.3733],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 137 Loss: 0.2777 Alpha: tensor([0.3562, 0.3818, 0.3804, 0.3780, 0.3828, 0.3834, 0.3724],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 138 Loss: 0.2732 Alpha: tensor([0.3552, 0.3810, 0.3796, 0.3772, 0.3821, 0.3826, 0.3715],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 139 Loss: 0.2688 Alpha: tensor([0.3543, 0.3802, 0.3788, 0.3764, 0.3813, 0.3819, 0.3706],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 140 Loss: 0.2645 Alpha: tensor([0.3533, 0.3794, 0.3780, 0.3756, 0.3805, 0.3811, 0.3697],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 141 Loss: 0.2605 Alpha: tensor([0.3524, 0.3786, 0.3772, 0.3748, 0.3798, 0.3804, 0.3688],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 142 Loss: 0.2566 Alpha: tensor([0.3514, 0.3778, 0.3765, 0.3740, 0.3790, 0.3796, 0.3679],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 143 Loss: 0.2529 Alpha: tensor([0.3504, 0.3770, 0.3757, 0.3732, 0.3783, 0.3789, 0.3670],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 144 Loss: 0.2495 Alpha: tensor([0.3495, 0.3763, 0.3750, 0.3724, 0.3775, 0.3782, 0.3661],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 144 best val f1 0.6364 test f1 0.44025954604148865
Epoch 145 Loss: 0.2463 Alpha: tensor([0.3485, 0.3755, 0.3743, 0.3716, 0.3768, 0.3774, 0.3651],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 146 Loss: 0.2431 Alpha: tensor([0.3476, 0.3748, 0.3735, 0.3708, 0.3760, 0.3767, 0.3642],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 147 Loss: 0.2402 Alpha: tensor([0.3466, 0.3740, 0.3728, 0.3700, 0.3753, 0.3760, 0.3633],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 148 Loss: 0.2375 Alpha: tensor([0.3457, 0.3733, 0.3721, 0.3693, 0.3746, 0.3753, 0.3624],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 149 Loss: 0.2349 Alpha: tensor([0.3447, 0.3726, 0.3714, 0.3685, 0.3738, 0.3746, 0.3615],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 150 Loss: 0.2324 Alpha: tensor([0.3438, 0.3718, 0.3706, 0.3677, 0.3731, 0.3739, 0.3606],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 151 Loss: 0.2300 Alpha: tensor([0.3428, 0.3711, 0.3699, 0.3669, 0.3723, 0.3731, 0.3597],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 152 Loss: 0.2277 Alpha: tensor([0.3419, 0.3704, 0.3692, 0.3661, 0.3716, 0.3724, 0.3588],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 153 Loss: 0.2257 Alpha: tensor([0.3409, 0.3697, 0.3685, 0.3653, 0.3709, 0.3717, 0.3579],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 154 Loss: 0.2239 Alpha: tensor([0.3400, 0.3689, 0.3677, 0.3645, 0.3701, 0.3710, 0.3570],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 155 Loss: 0.2222 Alpha: tensor([0.3391, 0.3682, 0.3670, 0.3638, 0.3694, 0.3703, 0.3561],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 156 Loss: 0.2204 Alpha: tensor([0.3381, 0.3675, 0.3663, 0.3630, 0.3686, 0.3696, 0.3552],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 157 Loss: 0.2191 Alpha: tensor([0.3372, 0.3667, 0.3655, 0.3622, 0.3679, 0.3688, 0.3543],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 158 Loss: 0.2178 Alpha: tensor([0.3362, 0.3660, 0.3648, 0.3614, 0.3672, 0.3681, 0.3534],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 159 Loss: 0.2167 Alpha: tensor([0.3353, 0.3653, 0.3640, 0.3606, 0.3664, 0.3674, 0.3525],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 160 Loss: 0.2158 Alpha: tensor([0.3343, 0.3645, 0.3633, 0.3598, 0.3657, 0.3667, 0.3516],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 161 Loss: 0.2149 Alpha: tensor([0.3334, 0.3638, 0.3625, 0.3591, 0.3650, 0.3660, 0.3507],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 162 Loss: 0.2140 Alpha: tensor([0.3325, 0.3630, 0.3618, 0.3583, 0.3642, 0.3653, 0.3498],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 163 Loss: 0.2135 Alpha: tensor([0.3315, 0.3623, 0.3610, 0.3575, 0.3635, 0.3645, 0.3488],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 164 Loss: 0.2129 Alpha: tensor([0.3306, 0.3615, 0.3602, 0.3567, 0.3628, 0.3638, 0.3479],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 165 Loss: 0.2123 Alpha: tensor([0.3296, 0.3608, 0.3595, 0.3559, 0.3620, 0.3631, 0.3470],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 166 Loss: 0.2118 Alpha: tensor([0.3287, 0.3600, 0.3587, 0.3552, 0.3613, 0.3624, 0.3461],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 167 Loss: 0.2113 Alpha: tensor([0.3278, 0.3593, 0.3579, 0.3544, 0.3606, 0.3616, 0.3452],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 168 Loss: 0.2109 Alpha: tensor([0.3268, 0.3585, 0.3571, 0.3536, 0.3599, 0.3609, 0.3443],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 169 Loss: 0.2105 Alpha: tensor([0.3259, 0.3578, 0.3564, 0.3528, 0.3591, 0.3602, 0.3434],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 170 Loss: 0.2102 Alpha: tensor([0.3250, 0.3570, 0.3556, 0.3521, 0.3584, 0.3595, 0.3426],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 171 Loss: 0.2098 Alpha: tensor([0.3240, 0.3563, 0.3548, 0.3513, 0.3577, 0.3588, 0.3417],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 172 Loss: 0.2095 Alpha: tensor([0.3231, 0.3555, 0.3540, 0.3505, 0.3569, 0.3580, 0.3408],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 173 Loss: 0.2092 Alpha: tensor([0.3222, 0.3548, 0.3533, 0.3497, 0.3562, 0.3573, 0.3399],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 174 Loss: 0.2089 Alpha: tensor([0.3213, 0.3541, 0.3525, 0.3490, 0.3555, 0.3566, 0.3390],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 175 Loss: 0.2087 Alpha: tensor([0.3203, 0.3533, 0.3517, 0.3482, 0.3548, 0.3559, 0.3381],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 176 Loss: 0.2085 Alpha: tensor([0.3194, 0.3526, 0.3509, 0.3474, 0.3541, 0.3552, 0.3372],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 177 Loss: 0.2082 Alpha: tensor([0.3185, 0.3518, 0.3502, 0.3467, 0.3533, 0.3544, 0.3363],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 178 Loss: 0.2083 Alpha: tensor([0.3176, 0.3511, 0.3494, 0.3459, 0.3526, 0.3537, 0.3355],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 179 Loss: 0.2081 Alpha: tensor([0.3166, 0.3503, 0.3486, 0.3452, 0.3519, 0.3530, 0.3346],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 180 Loss: 0.2079 Alpha: tensor([0.3157, 0.3496, 0.3479, 0.3444, 0.3512, 0.3523, 0.3337],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 181 Loss: 0.2079 Alpha: tensor([0.3148, 0.3489, 0.3471, 0.3436, 0.3505, 0.3516, 0.3328],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 182 Loss: 0.2075 Alpha: tensor([0.3139, 0.3481, 0.3464, 0.3429, 0.3498, 0.3509, 0.3319],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 183 Loss: 0.2079 Alpha: tensor([0.3130, 0.3474, 0.3456, 0.3421, 0.3490, 0.3502, 0.3311],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 184 Loss: 0.2079 Alpha: tensor([0.3121, 0.3467, 0.3448, 0.3414, 0.3483, 0.3495, 0.3302],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 185 Loss: 0.2073 Alpha: tensor([0.3112, 0.3459, 0.3441, 0.3406, 0.3476, 0.3487, 0.3293],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 186 Loss: 0.2070 Alpha: tensor([0.3102, 0.3452, 0.3433, 0.3399, 0.3469, 0.3480, 0.3285],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 187 Loss: 0.2074 Alpha: tensor([0.3093, 0.3445, 0.3426, 0.3391, 0.3462, 0.3473, 0.3276],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 188 Loss: 0.2070 Alpha: tensor([0.3084, 0.3437, 0.3418, 0.3384, 0.3455, 0.3466, 0.3267],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 189 Loss: 0.2066 Alpha: tensor([0.3075, 0.3430, 0.3411, 0.3376, 0.3448, 0.3459, 0.3259],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 190 Loss: 0.2061 Alpha: tensor([0.3066, 0.3423, 0.3403, 0.3369, 0.3441, 0.3452, 0.3250],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 191 Loss: 0.2058 Alpha: tensor([0.3057, 0.3415, 0.3396, 0.3361, 0.3434, 0.3445, 0.3241],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 192 Loss: 0.2053 Alpha: tensor([0.3048, 0.3408, 0.3388, 0.3354, 0.3427, 0.3438, 0.3233],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 193 Loss: 0.2051 Alpha: tensor([0.3039, 0.3401, 0.3381, 0.3347, 0.3420, 0.3431, 0.3224],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 194 Loss: 0.2051 Alpha: tensor([0.3030, 0.3394, 0.3374, 0.3339, 0.3413, 0.3424, 0.3216],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 195 Loss: 0.2047 Alpha: tensor([0.3021, 0.3387, 0.3366, 0.3332, 0.3406, 0.3417, 0.3207],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 196 Loss: 0.2045 Alpha: tensor([0.3012, 0.3379, 0.3359, 0.3324, 0.3399, 0.3410, 0.3198],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 197 Loss: 0.2042 Alpha: tensor([0.3003, 0.3372, 0.3351, 0.3317, 0.3392, 0.3403, 0.3190],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 198 Loss: 0.2039 Alpha: tensor([0.2995, 0.3365, 0.3344, 0.3310, 0.3385, 0.3396, 0.3181],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 199 Loss: 0.2036 Alpha: tensor([0.2986, 0.3358, 0.3337, 0.3302, 0.3378, 0.3389, 0.3173],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 200 Loss: 0.2033 Alpha: tensor([0.2977, 0.3351, 0.3329, 0.3295, 0.3371, 0.3382, 0.3164],
       device='cuda:0', grad_fn=<SelectBackward0>)