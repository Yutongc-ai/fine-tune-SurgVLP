/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.77it/s]
num_shots is  1
num_shots is  1
Epoch 1 Loss: 6.8380
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.00it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.14it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.14it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 1 best val f1 0.4444 test f1 0.17934687435626984
Epoch 2 Loss: 2.6773
Epoch 3 Loss: -0.5763
Epoch 4 Loss: -1.1913
Epoch 5 Loss: -1.5359
Epoch 6 Loss: -2.0034
Epoch 7 Loss: -2.4401
Epoch 8 Loss: -2.8256
Epoch 9 Loss: -3.1501
Epoch 10 Loss: -3.4702
Epoch 11 Loss: -3.7637
Epoch 12 Loss: -4.0339
Epoch 13 Loss: -4.2901
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.11it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.04it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.96it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.01it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.00it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.34it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 15 Loss: -4.7703
Epoch 16 Loss: -4.9955
Epoch 17 Loss: -5.2311
Epoch 18 Loss: -5.4463
Epoch 19 Loss: -5.6358
Epoch 20 Loss: -5.8195
Epoch 21 Loss: -6.0016
Epoch 22 Loss: -6.1676
Epoch 23 Loss: -6.3285
Epoch 24 Loss: -6.4904
Epoch 25 Loss: -6.6334
Epoch 26 Loss: -6.7785
Epoch 27 Loss: -6.9355
Epoch 28 Loss: -7.0733
Epoch 29 Loss: -7.1526
Epoch 30 Loss: -7.2015
Epoch 31 Loss: -7.2502
Epoch 32 Loss: -7.3170
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.51it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.65it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.44it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.05it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.72it/s]
Epoch 34 Loss: -7.5018
Epoch 35 Loss: -7.6096
Epoch 36 Loss: -7.7126
Epoch 37 Loss: -7.8132
Epoch 38 Loss: -7.9239
Epoch 39 Loss: -8.0275
Epoch 40 Loss: -8.1144
Epoch 41 Loss: -8.2050
Epoch 42 Loss: -8.2935
Epoch 43 Loss: -8.3879
Epoch 44 Loss: -8.4739
Epoch 45 Loss: -8.5618
Epoch 46 Loss: -8.6524
Epoch 47 Loss: -8.7278
Epoch 48 Loss: -8.7981
Epoch 49 Loss: -8.8760
Epoch 50 Loss: -8.9468
Epoch 51 Loss: -9.0082
Epoch 52 Loss: -9.0699
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.76it/s]
Epoch 53 Loss: -9.1294
Epoch 54 Loss: -9.2005
Epoch 55 Loss: -9.2626
Epoch 56 Loss: -9.3211
Epoch 57 Loss: -9.3847
Epoch 58 Loss: -9.4372
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.67it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.59it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.40it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.61it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.62it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.76it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.81it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.68it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.78it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.77it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.75it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.64it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.36it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.51it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.06it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.38it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.35it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.37it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.66it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.70it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.60it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.03it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.74it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.98it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.44it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.45it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.03it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.17it/s]
Epoch 59 Loss: -9.4818
Epoch 60 Loss: -9.5296
Epoch 61 Loss: -9.5817
Epoch 62 Loss: -9.6321
Epoch 63 Loss: -9.6771
Epoch 64 Loss: -9.7169
Epoch 65 Loss: -9.7581
Epoch 66 Loss: -9.7981
Epoch 67 Loss: -9.8392
Epoch 68 Loss: -9.8830
Epoch 69 Loss: -9.9250
Epoch 70 Loss: -9.9600
Epoch 71 Loss: -9.9939
Epoch 72 Loss: -10.0249
Epoch 73 Loss: -10.0590
Epoch 74 Loss: -10.0917
Epoch 75 Loss: -10.1266
Epoch 75 best val f1 0.4828 test f1 0.17934687435626984
Epoch 76 Loss: -10.1625
Epoch 77 Loss: -10.1910
Epoch 78 Loss: -10.2203
Epoch 79 Loss: -10.2545
Epoch 80 Loss: -10.2866
Epoch 81 Loss: -10.3100
Epoch 82 Loss: -10.3310
Epoch 83 Loss: -10.3655
Epoch 84 Loss: -10.3898
Epoch 85 Loss: -10.4101
Epoch 86 Loss: -10.4371
Epoch 87 Loss: -10.4652
Epoch 88 Loss: -10.4888
Epoch 89 Loss: -10.5165
Epoch 90 Loss: -10.5376
Epoch 91 Loss: -10.5602
Epoch 92 Loss: -10.5776
Epoch 93 Loss: -10.5977
Epoch 94 Loss: -10.6123
Epoch 95 Loss: -10.6388
Epoch 96 Loss: -10.6524
Epoch 97 Loss: -10.6774
Epoch 98 Loss: -10.6927
Epoch 99 Loss: -10.7149
Epoch 100 Loss: -10.7358
Epoch 101 Loss: -10.7541
Epoch 102 Loss: -10.7691
Epoch 103 Loss: -10.7873
Epoch 104 Loss: -10.7966
Epoch 105 Loss: -10.8172
Epoch 106 Loss: -10.8320
Epoch 107 Loss: -10.8456
Epoch 108 Loss: -10.8642
Epoch 109 Loss: -10.8816
Epoch 110 Loss: -10.8966
Epoch 111 Loss: -10.9077
Epoch 112 Loss: -10.9198
Epoch 113 Loss: -10.9375
Epoch 114 Loss: -10.9525
Epoch 115 Loss: -10.9621
Epoch 116 Loss: -10.9707
Epoch 117 Loss: -10.9881
Epoch 118 Loss: -11.0063
Epoch 119 Loss: -11.0184
Epoch 120 Loss: -11.0307
Epoch 121 Loss: -11.0429
Epoch 122 Loss: -11.0584
Epoch 123 Loss: -11.0737
Epoch 124 Loss: -11.0742
Epoch 125 Loss: -11.0854
Epoch 126 Loss: -11.0902
Epoch 127 Loss: -11.0995
Epoch 128 Loss: -11.1062
Epoch 129 Loss: -11.1174
Epoch 130 Loss: -11.1312
Epoch 131 Loss: -11.1483
Epoch 132 Loss: -11.1584
Epoch 133 Loss: -11.1721
Epoch 134 Loss: -11.1846
Epoch 135 Loss: -11.1984
Epoch 136 Loss: -11.2039
Epoch 137 Loss: -11.2192
Epoch 138 Loss: -11.2246
Epoch 139 Loss: -11.2304
Epoch 140 Loss: -11.2461
Epoch 141 Loss: -11.2564
Epoch 142 Loss: -11.2740
Epoch 143 Loss: -11.2789
Epoch 144 Loss: -11.2870
Epoch 145 Loss: -11.2985
Epoch 146 Loss: -11.3104
Epoch 147 Loss: -11.3170
Epoch 148 Loss: -11.3220
Epoch 149 Loss: -11.3266
Epoch 150 Loss: -11.3379
Epoch 151 Loss: -11.3462
Epoch 152 Loss: -11.3569
Epoch 153 Loss: -11.3743
Epoch 154 Loss: -11.3795
Epoch 155 Loss: -11.3944
Epoch 156 Loss: -11.4047
Epoch 157 Loss: -11.4069
Epoch 158 Loss: -11.4094
Epoch 159 Loss: -11.4197
Epoch 160 Loss: -11.4236
Epoch 161 Loss: -11.4258
Epoch 162 Loss: -11.4423
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "few_shot.py", line 80, in <module>
    main(configs[args.method], args.method)
  File "few_shot.py", line 56, in main
    metrics = method(dataset)
  File "/home/yongxuan/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/yongxuan/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yongxuan/SurgVLP/methods/zoom_in.py", line 202, in forward
    for i, (images, target) in enumerate(tqdm(train_loader)):
  File "/home/yongxuan/.local/lib/python3.8/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/home/yongxuan/.local/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/yongxuan/.local/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/yongxuan/.local/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/yongxuan/.local/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/yongxuan/SurgVLP/datasets/utils.py", line 303, in __getitem__
    img0 = read_image(item.impath)
  File "/home/yongxuan/SurgVLP/datasets/utils.py", line 146, in read_image
    img = Image.open(path).convert('RGB')
  File "/home/yongxuan/.local/lib/python3.8/site-packages/PIL/Image.py", line 921, in convert
    self.load()
  File "/home/yongxuan/.local/lib/python3.8/site-packages/PIL/ImageFile.py", line 242, in load
    s = read(self.decodermaxblock)
  File "/home/yongxuan/.local/lib/python3.8/site-packages/PIL/PngImagePlugin.py", line 955, in load_read
    read_bytes = min(read_bytes, self.__idat)
KeyboardInterrupt