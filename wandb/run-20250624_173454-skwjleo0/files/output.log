/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
num_shots is  4
num_shots is  4
Epoch 1 Loss: 1.0213
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.40it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.51it/s]
Epoch 1 best val f1 0.2895 test f1 0.2127850353717804
Epoch 2 Loss: 0.1218
Epoch 2 best val f1 0.3810 test f1 0.3951960802078247
Epoch 3 Loss: -0.2304
Epoch 3 best val f1 0.4783 test f1 0.5214868187904358
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.34it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 4 Loss: -0.3400
Epoch 4 best val f1 0.5253 test f1 0.5730065107345581
Epoch 5 Loss: -0.3913
Epoch 5 best val f1 0.5455 test f1 0.5947651863098145
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.59it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 7 Loss: -0.4799
Epoch 7 best val f1 0.5567 test f1 0.6094497442245483
Epoch 8 Loss: -0.5215
Epoch 9 Loss: -0.5646
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  3.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
Epoch 10 best val f1 0.5657 test f1 0.6091431975364685
Epoch 11 Loss: -0.6518
Epoch 12 Loss: -0.6945
Epoch 13 Loss: -0.7376
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.53it/s]
Epoch 14 Loss: -0.7815
Epoch 14 best val f1 0.5714 test f1 0.6164506077766418
Epoch 15 Loss: -0.8265
Epoch 16 Loss: -0.8728
Epoch 17 Loss: -0.9204
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 18 Loss: -0.9694
Epoch 19 Loss: -1.0197
Epoch 20 Loss: -1.0708
Epoch 21 Loss: -1.1226
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.50it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 23 Loss: -1.2290
Epoch 23 best val f1 0.5743 test f1 0.6534322500228882
Epoch 24 Loss: -1.2846
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 25 best val f1 0.5882 test f1 0.6544345021247864
Epoch 26 Loss: -1.4006
Epoch 26 best val f1 0.5962 test f1 0.6548336148262024
Epoch 27 Loss: -1.4603
Epoch 28 Loss: -1.5204
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 29 Loss: -1.5808
Epoch 30 Loss: -1.6425
Epoch 31 Loss: -1.7064
Epoch 32 Loss: -1.7719
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
Epoch 34 Loss: -1.9052
Epoch 35 Loss: -1.9726
Epoch 36 Loss: -2.0406
Epoch 37 Loss: -2.1096
Epoch 38 Loss: -2.1813
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
Epoch 39 Loss: -2.2541
Epoch 40 Loss: -2.3281
Epoch 41 Loss: -2.4036
Epoch 42 Loss: -2.4809
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.07it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.49it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 43 Loss: -2.5606
Epoch 44 Loss: -2.6428
Epoch 45 Loss: -2.7274
Epoch 46 Loss: -2.8123
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.53it/s]
Epoch 48 Loss: -2.9878
Epoch 49 Loss: -3.0778
Epoch 50 Loss: -3.1690
Epoch 51 Loss: -3.2617
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.58it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 52 Loss: -3.3539
Epoch 53 Loss: -3.4467
Epoch 54 Loss: -3.5389
Epoch 55 Loss: -3.6119
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 57 Loss: -3.7791
Epoch 58 Loss: -3.9027
Epoch 59 Loss: -3.9755
Epoch 60 Loss: -4.0753
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
Epoch 62 Loss: -4.2683
Epoch 63 Loss: -4.3697
Epoch 64 Loss: -4.4730
Epoch 65 Loss: -4.5765
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 66 Loss: -4.6810
Epoch 67 Loss: -4.7861
Epoch 68 Loss: -4.8904
Epoch 69 Loss: -4.9940
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 71 Loss: -5.1888
Epoch 72 Loss: -5.2998
Epoch 73 Loss: -5.3928
Epoch 74 Loss: -5.5136
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
Epoch 76 Loss: -5.7379
Epoch 77 Loss: -5.8543
Epoch 78 Loss: -5.9709
Epoch 79 Loss: -6.0837
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 80 Loss: -6.2078
Epoch 81 Loss: -6.3452
Epoch 82 Loss: -6.4171
Epoch 83 Loss: -6.5645
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 85 Loss: -6.8279
Epoch 86 Loss: -6.9542
Epoch 87 Loss: -7.0753
Epoch 88 Loss: -7.2052
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.56it/s]
Epoch 90 Loss: -7.4476
Epoch 91 Loss: -7.5636
Epoch 92 Loss: -7.6818
Epoch 93 Loss: -7.8011
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.54it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 94 Loss: -7.9169
Epoch 95 Loss: -8.0353
Epoch 96 Loss: -8.1565
Epoch 97 Loss: -8.2785
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  4.52it/s]
Epoch 99 Loss: -8.5197
Epoch 100 Loss: -8.6399