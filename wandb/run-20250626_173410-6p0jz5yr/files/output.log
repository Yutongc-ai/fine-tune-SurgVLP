/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
num_shots is  16
num_shots is  16
Epoch 1 Loss: 1.4009 Alpha: tensor([0.4980, 0.4980, 0.4980, 0.4981, 0.4980, 0.4980, 0.4981],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 1 best val f1 0.4111 test f1 0.29679349064826965
Epoch 2 Loss: 1.4118 Alpha: tensor([0.4960, 0.4961, 0.4960, 0.4962, 0.4960, 0.4960, 0.4962],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 2 best val f1 0.4122 test f1 0.29651951789855957
Epoch 3 Loss: 1.3938 Alpha: tensor([0.4940, 0.4941, 0.4940, 0.4942, 0.4940, 0.4940, 0.4943],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 Loss: 1.3743 Alpha: tensor([0.4921, 0.4921, 0.4920, 0.4923, 0.4920, 0.4920, 0.4924],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 best val f1 0.4133 test f1 0.2955455482006073
Epoch 5 Loss: 1.3683 Alpha: tensor([0.4901, 0.4901, 0.4900, 0.4903, 0.4900, 0.4900, 0.4904],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 6 Loss: 1.3558 Alpha: tensor([0.4881, 0.4881, 0.4880, 0.4884, 0.4880, 0.4880, 0.4885],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 7 Loss: 1.3339 Alpha: tensor([0.4861, 0.4861, 0.4860, 0.4864, 0.4860, 0.4860, 0.4866],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 8 Loss: 1.3238 Alpha: tensor([0.4841, 0.4841, 0.4841, 0.4844, 0.4840, 0.4840, 0.4846],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 8 best val f1 0.4145 test f1 0.2943464517593384
Epoch 9 Loss: 1.3238 Alpha: tensor([0.4821, 0.4822, 0.4821, 0.4823, 0.4820, 0.4820, 0.4827],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 9 best val f1 0.4151 test f1 0.2938297986984253
Epoch 10 Loss: 1.3155 Alpha: tensor([0.4801, 0.4802, 0.4801, 0.4803, 0.4800, 0.4800, 0.4807],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 11 Loss: 1.2976 Alpha: tensor([0.4781, 0.4782, 0.4781, 0.4783, 0.4780, 0.4780, 0.4787],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 11 best val f1 0.4163 test f1 0.29321470856666565
Epoch 12 Loss: 1.2926 Alpha: tensor([0.4761, 0.4762, 0.4761, 0.4763, 0.4760, 0.4760, 0.4767],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 13 Loss: 1.2705 Alpha: tensor([0.4741, 0.4742, 0.4741, 0.4742, 0.4739, 0.4739, 0.4747],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 14 Loss: 1.2788 Alpha: tensor([0.4721, 0.4722, 0.4721, 0.4722, 0.4719, 0.4719, 0.4727],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 14 best val f1 0.4164 test f1 0.2920684516429901
Epoch 15 Loss: 1.2628 Alpha: tensor([0.4701, 0.4701, 0.4700, 0.4701, 0.4699, 0.4699, 0.4707],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 16 Loss: 1.2542 Alpha: tensor([0.4682, 0.4681, 0.4680, 0.4681, 0.4679, 0.4679, 0.4687],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 17 Loss: 1.2576 Alpha: tensor([0.4662, 0.4661, 0.4659, 0.4660, 0.4658, 0.4658, 0.4666],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 18 Loss: 1.2241 Alpha: tensor([0.4642, 0.4640, 0.4639, 0.4640, 0.4638, 0.4638, 0.4646],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 19 Loss: 1.2152 Alpha: tensor([0.4622, 0.4620, 0.4618, 0.4619, 0.4617, 0.4617, 0.4626],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 20 Loss: 1.2208 Alpha: tensor([0.4603, 0.4599, 0.4598, 0.4598, 0.4597, 0.4597, 0.4606],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 21 Loss: 1.2096 Alpha: tensor([0.4583, 0.4579, 0.4577, 0.4577, 0.4576, 0.4576, 0.4585],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 22 Loss: 1.2077 Alpha: tensor([0.4563, 0.4559, 0.4557, 0.4556, 0.4556, 0.4556, 0.4565],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 Loss: 1.1937 Alpha: tensor([0.4543, 0.4538, 0.4536, 0.4535, 0.4535, 0.4535, 0.4545],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 24 Loss: 1.1906 Alpha: tensor([0.4524, 0.4517, 0.4515, 0.4514, 0.4515, 0.4514, 0.4524],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 25 Loss: 1.1889 Alpha: tensor([0.4504, 0.4497, 0.4495, 0.4494, 0.4494, 0.4494, 0.4504],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 Loss: 1.1655 Alpha: tensor([0.4484, 0.4477, 0.4474, 0.4473, 0.4473, 0.4473, 0.4483],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 27 Loss: 1.1651 Alpha: tensor([0.4464, 0.4456, 0.4453, 0.4452, 0.4452, 0.4452, 0.4463],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 28 Loss: 1.1643 Alpha: tensor([0.4445, 0.4435, 0.4432, 0.4431, 0.4431, 0.4432, 0.4443],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 29 Loss: 1.1499 Alpha: tensor([0.4425, 0.4414, 0.4411, 0.4410, 0.4410, 0.4411, 0.4422],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 30 Loss: 1.1463 Alpha: tensor([0.4405, 0.4393, 0.4391, 0.4389, 0.4389, 0.4390, 0.4402],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 31 Loss: 1.1433 Alpha: tensor([0.4385, 0.4373, 0.4370, 0.4368, 0.4369, 0.4370, 0.4382],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 32 Loss: 1.1317 Alpha: tensor([0.4365, 0.4352, 0.4349, 0.4347, 0.4348, 0.4349, 0.4361],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 33 Loss: 1.1377 Alpha: tensor([0.4346, 0.4331, 0.4328, 0.4326, 0.4327, 0.4328, 0.4341],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 34 Loss: 1.1222 Alpha: tensor([0.4326, 0.4310, 0.4307, 0.4305, 0.4306, 0.4308, 0.4320],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 35 Loss: 1.1246 Alpha: tensor([0.4306, 0.4290, 0.4286, 0.4284, 0.4285, 0.4287, 0.4300],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 36 Loss: 1.1148 Alpha: tensor([0.4286, 0.4269, 0.4266, 0.4263, 0.4264, 0.4266, 0.4279],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 37 Loss: 1.0978 Alpha: tensor([0.4267, 0.4248, 0.4245, 0.4242, 0.4243, 0.4245, 0.4258],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 38 Loss: 1.0986 Alpha: tensor([0.4247, 0.4227, 0.4224, 0.4221, 0.4222, 0.4225, 0.4237],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 39 Loss: 1.0999 Alpha: tensor([0.4228, 0.4206, 0.4203, 0.4200, 0.4201, 0.4204, 0.4217],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 40 Loss: 1.0858 Alpha: tensor([0.4208, 0.4185, 0.4182, 0.4179, 0.4180, 0.4184, 0.4196],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 41 Loss: 1.0958 Alpha: tensor([0.4188, 0.4164, 0.4162, 0.4159, 0.4160, 0.4163, 0.4176],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 42 Loss: 1.0872 Alpha: tensor([0.4169, 0.4143, 0.4141, 0.4138, 0.4139, 0.4142, 0.4155],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 43 Loss: 1.0757 Alpha: tensor([0.4149, 0.4123, 0.4121, 0.4117, 0.4118, 0.4122, 0.4135],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 44 Loss: 1.0710 Alpha: tensor([0.4129, 0.4102, 0.4100, 0.4096, 0.4097, 0.4101, 0.4114],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 45 Loss: 1.0843 Alpha: tensor([0.4110, 0.4081, 0.4079, 0.4075, 0.4076, 0.4080, 0.4094],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 46 Loss: 1.0762 Alpha: tensor([0.4090, 0.4060, 0.4059, 0.4054, 0.4056, 0.4060, 0.4073],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 47 Loss: 1.0655 Alpha: tensor([0.4070, 0.4039, 0.4038, 0.4033, 0.4035, 0.4039, 0.4053],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 48 Loss: 1.0771 Alpha: tensor([0.4050, 0.4018, 0.4017, 0.4012, 0.4014, 0.4018, 0.4033],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 49 Loss: 1.0542 Alpha: tensor([0.4030, 0.3997, 0.3996, 0.3991, 0.3993, 0.3997, 0.4013],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 50 Loss: 1.0630 Alpha: tensor([0.4010, 0.3976, 0.3976, 0.3970, 0.3973, 0.3977, 0.3992],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 51 Loss: 1.0497 Alpha: tensor([0.3990, 0.3955, 0.3955, 0.3950, 0.3952, 0.3956, 0.3972],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 52 Loss: 1.0501 Alpha: tensor([0.3970, 0.3934, 0.3935, 0.3929, 0.3931, 0.3935, 0.3952],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 53 Loss: 1.0459 Alpha: tensor([0.3951, 0.3913, 0.3914, 0.3908, 0.3910, 0.3914, 0.3931],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 54 Loss: 1.0483 Alpha: tensor([0.3931, 0.3892, 0.3893, 0.3887, 0.3889, 0.3893, 0.3911],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 55 Loss: 1.0330 Alpha: tensor([0.3911, 0.3871, 0.3872, 0.3867, 0.3869, 0.3872, 0.3891],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 56 Loss: 1.0315 Alpha: tensor([0.3892, 0.3851, 0.3851, 0.3846, 0.3848, 0.3851, 0.3870],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 57 Loss: 1.0312 Alpha: tensor([0.3872, 0.3830, 0.3831, 0.3825, 0.3827, 0.3830, 0.3850],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 58 Loss: 1.0239 Alpha: tensor([0.3852, 0.3809, 0.3810, 0.3805, 0.3806, 0.3809, 0.3830],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 59 Loss: 1.0247 Alpha: tensor([0.3833, 0.3788, 0.3789, 0.3784, 0.3785, 0.3788, 0.3810],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 60 Loss: 1.0282 Alpha: tensor([0.3814, 0.3767, 0.3769, 0.3763, 0.3764, 0.3767, 0.3790],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 61 Loss: 1.0136 Alpha: tensor([0.3795, 0.3746, 0.3748, 0.3742, 0.3744, 0.3746, 0.3770],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 62 Loss: 1.0190 Alpha: tensor([0.3776, 0.3725, 0.3728, 0.3721, 0.3723, 0.3725, 0.3750],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 63 Loss: 1.0082 Alpha: tensor([0.3757, 0.3704, 0.3707, 0.3701, 0.3702, 0.3704, 0.3730],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 64 Loss: 1.0157 Alpha: tensor([0.3737, 0.3683, 0.3686, 0.3680, 0.3681, 0.3683, 0.3710],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 65 Loss: 1.0052 Alpha: tensor([0.3718, 0.3662, 0.3665, 0.3660, 0.3660, 0.3663, 0.3690],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 66 Loss: 1.0086 Alpha: tensor([0.3699, 0.3642, 0.3644, 0.3639, 0.3639, 0.3642, 0.3669],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 67 Loss: 1.0011 Alpha: tensor([0.3680, 0.3621, 0.3623, 0.3618, 0.3618, 0.3621, 0.3649],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 68 Loss: 0.9975 Alpha: tensor([0.3660, 0.3600, 0.3603, 0.3598, 0.3598, 0.3600, 0.3629],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 69 Loss: 0.9927 Alpha: tensor([0.3641, 0.3579, 0.3582, 0.3577, 0.3577, 0.3579, 0.3609],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 70 Loss: 0.9855 Alpha: tensor([0.3622, 0.3558, 0.3562, 0.3556, 0.3556, 0.3559, 0.3589],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 71 Loss: 0.9947 Alpha: tensor([0.3602, 0.3537, 0.3541, 0.3536, 0.3536, 0.3538, 0.3569],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 72 Loss: 0.9923 Alpha: tensor([0.3583, 0.3516, 0.3521, 0.3515, 0.3515, 0.3517, 0.3549],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 73 Loss: 0.9849 Alpha: tensor([0.3563, 0.3496, 0.3500, 0.3495, 0.3494, 0.3496, 0.3529],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 74 Loss: 0.9773 Alpha: tensor([0.3544, 0.3475, 0.3480, 0.3475, 0.3474, 0.3475, 0.3508],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 75 Loss: 0.9795 Alpha: tensor([0.3525, 0.3454, 0.3459, 0.3455, 0.3453, 0.3454, 0.3488],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 76 Loss: 0.9853 Alpha: tensor([0.3505, 0.3434, 0.3438, 0.3434, 0.3433, 0.3433, 0.3468],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 77 Loss: 0.9785 Alpha: tensor([0.3486, 0.3413, 0.3418, 0.3414, 0.3412, 0.3412, 0.3447],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 78 Loss: 0.9722 Alpha: tensor([0.3466, 0.3392, 0.3397, 0.3393, 0.3392, 0.3392, 0.3427],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 79 Loss: 0.9738 Alpha: tensor([0.3447, 0.3371, 0.3377, 0.3373, 0.3372, 0.3371, 0.3407],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 80 Loss: 0.9678 Alpha: tensor([0.3427, 0.3350, 0.3356, 0.3353, 0.3351, 0.3350, 0.3387],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 81 Loss: 0.9659 Alpha: tensor([0.3407, 0.3329, 0.3336, 0.3333, 0.3330, 0.3329, 0.3366],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 82 Loss: 0.9598 Alpha: tensor([0.3388, 0.3308, 0.3316, 0.3313, 0.3310, 0.3308, 0.3346],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 83 Loss: 0.9610 Alpha: tensor([0.3369, 0.3287, 0.3295, 0.3292, 0.3289, 0.3288, 0.3326],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 84 Loss: 0.9540 Alpha: tensor([0.3349, 0.3267, 0.3275, 0.3273, 0.3268, 0.3267, 0.3305],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 85 Loss: 0.9465 Alpha: tensor([0.3330, 0.3246, 0.3254, 0.3253, 0.3248, 0.3246, 0.3285],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 86 Loss: 0.9527 Alpha: tensor([0.3310, 0.3225, 0.3234, 0.3233, 0.3227, 0.3225, 0.3265],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 87 Loss: 0.9460 Alpha: tensor([0.3291, 0.3204, 0.3213, 0.3213, 0.3207, 0.3204, 0.3245],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 88 Loss: 0.9474 Alpha: tensor([0.3272, 0.3183, 0.3193, 0.3194, 0.3186, 0.3184, 0.3225],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 89 Loss: 0.9366 Alpha: tensor([0.3252, 0.3163, 0.3172, 0.3174, 0.3165, 0.3163, 0.3205],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 90 Loss: 0.9443 Alpha: tensor([0.3233, 0.3142, 0.3152, 0.3154, 0.3145, 0.3142, 0.3185],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 91 Loss: 0.9378 Alpha: tensor([0.3214, 0.3121, 0.3132, 0.3134, 0.3124, 0.3121, 0.3165],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 92 Loss: 0.9349 Alpha: tensor([0.3194, 0.3101, 0.3111, 0.3114, 0.3104, 0.3100, 0.3146],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 93 Loss: 0.9318 Alpha: tensor([0.3175, 0.3080, 0.3090, 0.3094, 0.3083, 0.3079, 0.3126],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 94 Loss: 0.9265 Alpha: tensor([0.3156, 0.3059, 0.3069, 0.3075, 0.3063, 0.3058, 0.3106],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 95 Loss: 0.9225 Alpha: tensor([0.3137, 0.3039, 0.3049, 0.3055, 0.3042, 0.3037, 0.3086],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 96 Loss: 0.9234 Alpha: tensor([0.3119, 0.3018, 0.3028, 0.3036, 0.3022, 0.3016, 0.3066],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 97 Loss: 0.9215 Alpha: tensor([0.3099, 0.2998, 0.3008, 0.3016, 0.3002, 0.2995, 0.3046],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 98 Loss: 0.9109 Alpha: tensor([0.3080, 0.2977, 0.2988, 0.2996, 0.2981, 0.2974, 0.3026],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 99 Loss: 0.9091 Alpha: tensor([0.3062, 0.2956, 0.2967, 0.2977, 0.2961, 0.2953, 0.3006],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 100 Loss: 0.9107 Alpha: tensor([0.3043, 0.2936, 0.2947, 0.2958, 0.2940, 0.2932, 0.2987],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 101 Loss: 0.9165 Alpha: tensor([0.3024, 0.2915, 0.2927, 0.2938, 0.2920, 0.2912, 0.2967],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 102 Loss: 0.9075 Alpha: tensor([0.3005, 0.2894, 0.2906, 0.2919, 0.2899, 0.2891, 0.2948],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 103 Loss: 0.9068 Alpha: tensor([0.2986, 0.2873, 0.2886, 0.2900, 0.2879, 0.2870, 0.2928],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 104 Loss: 0.8970 Alpha: tensor([0.2967, 0.2853, 0.2866, 0.2881, 0.2859, 0.2849, 0.2908],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 105 Loss: 0.9070 Alpha: tensor([0.2948, 0.2832, 0.2846, 0.2862, 0.2838, 0.2828, 0.2889],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 106 Loss: 0.9025 Alpha: tensor([0.2930, 0.2812, 0.2826, 0.2842, 0.2818, 0.2807, 0.2870],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 107 Loss: 0.8899 Alpha: tensor([0.2911, 0.2791, 0.2806, 0.2823, 0.2797, 0.2786, 0.2850],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 108 Loss: 0.8940 Alpha: tensor([0.2892, 0.2770, 0.2786, 0.2804, 0.2777, 0.2765, 0.2830],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 109 Loss: 0.8888 Alpha: tensor([0.2873, 0.2750, 0.2765, 0.2785, 0.2756, 0.2743, 0.2811],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 110 Loss: 0.8845 Alpha: tensor([0.2855, 0.2729, 0.2745, 0.2766, 0.2736, 0.2722, 0.2791],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 111 Loss: 0.8855 Alpha: tensor([0.2836, 0.2709, 0.2725, 0.2747, 0.2716, 0.2701, 0.2772],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 112 Loss: 0.8804 Alpha: tensor([0.2817, 0.2688, 0.2705, 0.2728, 0.2695, 0.2680, 0.2752],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 113 Loss: 0.8853 Alpha: tensor([0.2798, 0.2668, 0.2685, 0.2709, 0.2675, 0.2659, 0.2733],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 114 Loss: 0.8840 Alpha: tensor([0.2780, 0.2647, 0.2665, 0.2690, 0.2655, 0.2638, 0.2714],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 115 Loss: 0.8648 Alpha: tensor([0.2761, 0.2626, 0.2645, 0.2671, 0.2635, 0.2617, 0.2695],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 116 Loss: 0.8750 Alpha: tensor([0.2742, 0.2606, 0.2625, 0.2652, 0.2615, 0.2596, 0.2676],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 117 Loss: 0.8678 Alpha: tensor([0.2724, 0.2585, 0.2604, 0.2633, 0.2594, 0.2575, 0.2656],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 118 Loss: 0.8584 Alpha: tensor([0.2705, 0.2565, 0.2584, 0.2614, 0.2574, 0.2554, 0.2637],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 119 Loss: 0.8623 Alpha: tensor([0.2687, 0.2544, 0.2564, 0.2595, 0.2554, 0.2534, 0.2618],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 120 Loss: 0.8640 Alpha: tensor([0.2668, 0.2524, 0.2544, 0.2576, 0.2534, 0.2513, 0.2599],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 121 Loss: 0.8625 Alpha: tensor([0.2649, 0.2503, 0.2524, 0.2557, 0.2514, 0.2492, 0.2580],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 122 Loss: 0.8555 Alpha: tensor([0.2631, 0.2483, 0.2504, 0.2537, 0.2494, 0.2471, 0.2561],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 123 Loss: 0.8608 Alpha: tensor([0.2613, 0.2463, 0.2484, 0.2519, 0.2473, 0.2450, 0.2542],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 124 Loss: 0.8492 Alpha: tensor([0.2594, 0.2443, 0.2464, 0.2500, 0.2453, 0.2429, 0.2523],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 125 Loss: 0.8454 Alpha: tensor([0.2576, 0.2422, 0.2444, 0.2481, 0.2433, 0.2409, 0.2504],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 126 Loss: 0.8483 Alpha: tensor([0.2557, 0.2402, 0.2424, 0.2462, 0.2413, 0.2388, 0.2485],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 127 Loss: 0.8433 Alpha: tensor([0.2539, 0.2381, 0.2404, 0.2444, 0.2393, 0.2367, 0.2466],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 128 Loss: 0.8439 Alpha: tensor([0.2521, 0.2361, 0.2384, 0.2425, 0.2373, 0.2346, 0.2446],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 129 Loss: 0.8395 Alpha: tensor([0.2503, 0.2341, 0.2365, 0.2406, 0.2353, 0.2326, 0.2427],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 130 Loss: 0.8352 Alpha: tensor([0.2485, 0.2321, 0.2345, 0.2388, 0.2333, 0.2305, 0.2408],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 131 Loss: 0.8438 Alpha: tensor([0.2467, 0.2301, 0.2325, 0.2369, 0.2313, 0.2284, 0.2389],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 132 Loss: 0.8366 Alpha: tensor([0.2448, 0.2280, 0.2305, 0.2350, 0.2293, 0.2263, 0.2370],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 133 Loss: 0.8234 Alpha: tensor([0.2430, 0.2260, 0.2285, 0.2332, 0.2273, 0.2242, 0.2352],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 134 Loss: 0.8233 Alpha: tensor([0.2411, 0.2240, 0.2265, 0.2313, 0.2253, 0.2221, 0.2332],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 135 Loss: 0.8256 Alpha: tensor([0.2393, 0.2220, 0.2246, 0.2295, 0.2233, 0.2201, 0.2314],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 136 Loss: 0.8215 Alpha: tensor([0.2375, 0.2200, 0.2226, 0.2276, 0.2213, 0.2180, 0.2295],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 137 Loss: 0.8120 Alpha: tensor([0.2357, 0.2180, 0.2206, 0.2258, 0.2193, 0.2159, 0.2276],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 138 Loss: 0.8091 Alpha: tensor([0.2338, 0.2160, 0.2187, 0.2240, 0.2173, 0.2138, 0.2257],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 139 Loss: 0.8131 Alpha: tensor([0.2320, 0.2141, 0.2167, 0.2222, 0.2153, 0.2118, 0.2239],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 140 Loss: 0.8150 Alpha: tensor([0.2303, 0.2121, 0.2147, 0.2204, 0.2134, 0.2097, 0.2221],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 141 Loss: 0.8082 Alpha: tensor([0.2286, 0.2101, 0.2128, 0.2186, 0.2114, 0.2077, 0.2202],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 142 Loss: 0.8061 Alpha: tensor([0.2268, 0.2081, 0.2108, 0.2168, 0.2094, 0.2056, 0.2183],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 143 Loss: 0.7976 Alpha: tensor([0.2251, 0.2061, 0.2088, 0.2151, 0.2075, 0.2035, 0.2165],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 144 Loss: 0.8023 Alpha: tensor([0.2233, 0.2041, 0.2069, 0.2133, 0.2055, 0.2015, 0.2146],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 145 Loss: 0.8054 Alpha: tensor([0.2216, 0.2022, 0.2050, 0.2115, 0.2036, 0.1994, 0.2128],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 146 Loss: 0.7939 Alpha: tensor([0.2198, 0.2002, 0.2030, 0.2097, 0.2016, 0.1974, 0.2110],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 147 Loss: 0.7962 Alpha: tensor([0.2181, 0.1982, 0.2011, 0.2079, 0.1996, 0.1953, 0.2091],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 148 Loss: 0.7884 Alpha: tensor([0.2163, 0.1962, 0.1992, 0.2061, 0.1977, 0.1933, 0.2073],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 149 Loss: 0.7907 Alpha: tensor([0.2146, 0.1943, 0.1973, 0.2044, 0.1957, 0.1912, 0.2055],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 150 Loss: 0.7872 Alpha: tensor([0.2129, 0.1923, 0.1954, 0.2026, 0.1938, 0.1892, 0.2036],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 151 Loss: 0.7844 Alpha: tensor([0.2112, 0.1903, 0.1935, 0.2008, 0.1919, 0.1871, 0.2018],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 152 Loss: 0.7814 Alpha: tensor([0.2095, 0.1884, 0.1916, 0.1990, 0.1899, 0.1850, 0.2000],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 153 Loss: 0.7823 Alpha: tensor([0.2078, 0.1864, 0.1898, 0.1973, 0.1880, 0.1830, 0.1982],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 154 Loss: 0.7734 Alpha: tensor([0.2060, 0.1845, 0.1878, 0.1956, 0.1861, 0.1809, 0.1964],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 155 Loss: 0.7820 Alpha: tensor([0.2043, 0.1825, 0.1860, 0.1939, 0.1842, 0.1789, 0.1946],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 156 Loss: 0.7739 Alpha: tensor([0.2025, 0.1806, 0.1841, 0.1921, 0.1824, 0.1769, 0.1928],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 157 Loss: 0.7696 Alpha: tensor([0.2008, 0.1786, 0.1822, 0.1904, 0.1804, 0.1748, 0.1910],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 158 Loss: 0.7633 Alpha: tensor([0.1991, 0.1767, 0.1804, 0.1887, 0.1785, 0.1728, 0.1891],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 159 Loss: 0.7655 Alpha: tensor([0.1974, 0.1748, 0.1785, 0.1870, 0.1766, 0.1708, 0.1873],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 160 Loss: 0.7636 Alpha: tensor([0.1957, 0.1729, 0.1766, 0.1853, 0.1747, 0.1688, 0.1856],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 161 Loss: 0.7621 Alpha: tensor([0.1940, 0.1709, 0.1748, 0.1836, 0.1729, 0.1668, 0.1838],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 162 Loss: 0.7615 Alpha: tensor([0.1924, 0.1690, 0.1729, 0.1819, 0.1710, 0.1648, 0.1821],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 163 Loss: 0.7573 Alpha: tensor([0.1908, 0.1671, 0.1711, 0.1802, 0.1691, 0.1628, 0.1803],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 164 Loss: 0.7560 Alpha: tensor([0.1891, 0.1652, 0.1692, 0.1785, 0.1672, 0.1608, 0.1786],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 165 Loss: 0.7504 Alpha: tensor([0.1875, 0.1633, 0.1674, 0.1768, 0.1653, 0.1587, 0.1769],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 166 Loss: 0.7455 Alpha: tensor([0.1858, 0.1614, 0.1656, 0.1751, 0.1635, 0.1567, 0.1751],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 167 Loss: 0.7479 Alpha: tensor([0.1842, 0.1595, 0.1638, 0.1735, 0.1616, 0.1547, 0.1734],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 168 Loss: 0.7448 Alpha: tensor([0.1826, 0.1577, 0.1619, 0.1718, 0.1598, 0.1527, 0.1718],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 168 best val f1 0.4167 test f1 0.30006757378578186
Epoch 169 Loss: 0.7445 Alpha: tensor([0.1809, 0.1558, 0.1601, 0.1701, 0.1579, 0.1507, 0.1701],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 169 best val f1 0.4180 test f1 0.300632119178772
Epoch 170 Loss: 0.7388 Alpha: tensor([0.1793, 0.1539, 0.1584, 0.1685, 0.1560, 0.1487, 0.1684],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 171 Loss: 0.7465 Alpha: tensor([0.1777, 0.1521, 0.1566, 0.1668, 0.1542, 0.1467, 0.1668],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 171 best val f1 0.4219 test f1 0.3010905981063843
Epoch 172 Loss: 0.7381 Alpha: tensor([0.1760, 0.1502, 0.1548, 0.1651, 0.1524, 0.1447, 0.1651],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 173 Loss: 0.7348 Alpha: tensor([0.1744, 0.1484, 0.1531, 0.1635, 0.1505, 0.1427, 0.1634],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 174 Loss: 0.7307 Alpha: tensor([0.1728, 0.1466, 0.1513, 0.1619, 0.1487, 0.1407, 0.1617],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 175 Loss: 0.7321 Alpha: tensor([0.1712, 0.1447, 0.1495, 0.1603, 0.1469, 0.1387, 0.1601],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 175 best val f1 0.4226 test f1 0.3017452657222748
Epoch 176 Loss: 0.7306 Alpha: tensor([0.1696, 0.1429, 0.1478, 0.1586, 0.1450, 0.1368, 0.1585],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 176 best val f1 0.4253 test f1 0.30182674527168274
Epoch 177 Loss: 0.7287 Alpha: tensor([0.1679, 0.1412, 0.1460, 0.1570, 0.1432, 0.1348, 0.1568],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 177 best val f1 0.4267 test f1 0.3019844591617584
Epoch 178 Loss: 0.7278 Alpha: tensor([0.1664, 0.1393, 0.1443, 0.1554, 0.1414, 0.1329, 0.1552],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 179 Loss: 0.7239 Alpha: tensor([0.1648, 0.1375, 0.1426, 0.1538, 0.1396, 0.1309, 0.1535],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 179 best val f1 0.4274 test f1 0.30233338475227356
Epoch 180 Loss: 0.7188 Alpha: tensor([0.1633, 0.1357, 0.1408, 0.1523, 0.1378, 0.1289, 0.1518],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 181 Loss: 0.7201 Alpha: tensor([0.1617, 0.1339, 0.1391, 0.1508, 0.1361, 0.1270, 0.1502],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 181 best val f1 0.4281 test f1 0.3027082085609436
Epoch 182 Loss: 0.7203 Alpha: tensor([0.1601, 0.1321, 0.1374, 0.1492, 0.1343, 0.1250, 0.1486],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 182 best val f1 0.4288 test f1 0.3028637766838074
Epoch 183 Loss: 0.7188 Alpha: tensor([0.1586, 0.1303, 0.1356, 0.1477, 0.1326, 0.1231, 0.1469],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 183 best val f1 0.4295 test f1 0.3032490909099579
Epoch 184 Loss: 0.7108 Alpha: tensor([0.1570, 0.1284, 0.1339, 0.1462, 0.1308, 0.1212, 0.1453],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 185 Loss: 0.7130 Alpha: tensor([0.1555, 0.1267, 0.1322, 0.1447, 0.1290, 0.1192, 0.1437],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 185 best val f1 0.4309 test f1 0.30386587977409363
Epoch 186 Loss: 0.7103 Alpha: tensor([0.1540, 0.1249, 0.1305, 0.1431, 0.1273, 0.1173, 0.1421],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 187 Loss: 0.7112 Alpha: tensor([0.1525, 0.1231, 0.1288, 0.1416, 0.1255, 0.1154, 0.1405],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 188 Loss: 0.7086 Alpha: tensor([0.1510, 0.1214, 0.1271, 0.1401, 0.1238, 0.1135, 0.1389],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 189 Loss: 0.7040 Alpha: tensor([0.1495, 0.1196, 0.1255, 0.1386, 0.1220, 0.1116, 0.1373],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 189 best val f1 0.4312 test f1 0.3050096035003662
Epoch 190 Loss: 0.7033 Alpha: tensor([0.1480, 0.1179, 0.1238, 0.1371, 0.1203, 0.1097, 0.1357],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 190 best val f1 0.4319 test f1 0.3052791655063629
Epoch 191 Loss: 0.7014 Alpha: tensor([0.1465, 0.1162, 0.1221, 0.1356, 0.1186, 0.1078, 0.1341],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 192 Loss: 0.6981 Alpha: tensor([0.1450, 0.1145, 0.1205, 0.1341, 0.1169, 0.1059, 0.1326],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 193 Loss: 0.6968 Alpha: tensor([0.1436, 0.1128, 0.1188, 0.1327, 0.1152, 0.1040, 0.1311],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 194 Loss: 0.6952 Alpha: tensor([0.1421, 0.1111, 0.1171, 0.1312, 0.1135, 0.1022, 0.1296],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 195 Loss: 0.6959 Alpha: tensor([0.1407, 0.1094, 0.1155, 0.1298, 0.1118, 0.1003, 0.1281],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 196 Loss: 0.6954 Alpha: tensor([0.1393, 0.1078, 0.1138, 0.1283, 0.1101, 0.0984, 0.1266],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 197 Loss: 0.6911 Alpha: tensor([0.1378, 0.1061, 0.1122, 0.1268, 0.1085, 0.0966, 0.1251],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 198 Loss: 0.6893 Alpha: tensor([0.1364, 0.1045, 0.1106, 0.1254, 0.1068, 0.0947, 0.1236],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 199 Loss: 0.6882 Alpha: tensor([0.1350, 0.1028, 0.1090, 0.1239, 0.1052, 0.0929, 0.1222],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 200 Loss: 0.6863 Alpha: tensor([0.1335, 0.1012, 0.1074, 0.1226, 0.1035, 0.0910, 0.1207],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 201 Loss: 0.6843 Alpha: tensor([0.1321, 0.0996, 0.1058, 0.1212, 0.1019, 0.0892, 0.1192],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 202 Loss: 0.6815 Alpha: tensor([0.1307, 0.0980, 0.1042, 0.1199, 0.1003, 0.0873, 0.1177],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 203 Loss: 0.6816 Alpha: tensor([0.1293, 0.0964, 0.1027, 0.1186, 0.0987, 0.0855, 0.1163],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 204 Loss: 0.6787 Alpha: tensor([0.1279, 0.0948, 0.1011, 0.1172, 0.0971, 0.0837, 0.1148],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 205 Loss: 0.6808 Alpha: tensor([0.1266, 0.0933, 0.0995, 0.1159, 0.0955, 0.0819, 0.1134],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 206 Loss: 0.6744 Alpha: tensor([0.1252, 0.0918, 0.0980, 0.1146, 0.0939, 0.0801, 0.1120],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 207 Loss: 0.6746 Alpha: tensor([0.1239, 0.0903, 0.0964, 0.1132, 0.0923, 0.0783, 0.1106],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 208 Loss: 0.6736 Alpha: tensor([0.1225, 0.0888, 0.0949, 0.1119, 0.0908, 0.0765, 0.1093],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 209 Loss: 0.6730 Alpha: tensor([0.1212, 0.0873, 0.0934, 0.1106, 0.0892, 0.0747, 0.1079],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 210 Loss: 0.6699 Alpha: tensor([0.1199, 0.0858, 0.0919, 0.1093, 0.0876, 0.0730, 0.1065],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 211 Loss: 0.6683 Alpha: tensor([0.1187, 0.0844, 0.0903, 0.1081, 0.0861, 0.0712, 0.1052],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 212 Loss: 0.6696 Alpha: tensor([0.1175, 0.0829, 0.0888, 0.1068, 0.0845, 0.0695, 0.1039],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 213 Loss: 0.6677 Alpha: tensor([0.1162, 0.0815, 0.0873, 0.1056, 0.0829, 0.0678, 0.1025],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 214 Loss: 0.6643 Alpha: tensor([0.1150, 0.0800, 0.0858, 0.1043, 0.0814, 0.0660, 0.1013],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 215 Loss: 0.6643 Alpha: tensor([0.1138, 0.0786, 0.0844, 0.1031, 0.0799, 0.0643, 0.1000],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 216 Loss: 0.6607 Alpha: tensor([0.1126, 0.0771, 0.0829, 0.1019, 0.0783, 0.0626, 0.0987],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 217 Loss: 0.6613 Alpha: tensor([0.1114, 0.0757, 0.0815, 0.1006, 0.0768, 0.0609, 0.0975],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 218 Loss: 0.6624 Alpha: tensor([0.1101, 0.0744, 0.0802, 0.0994, 0.0753, 0.0592, 0.0963],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 219 Loss: 0.6600 Alpha: tensor([0.1089, 0.0730, 0.0788, 0.0982, 0.0738, 0.0575, 0.0951],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 220 Loss: 0.6597 Alpha: tensor([0.1077, 0.0716, 0.0775, 0.0969, 0.0724, 0.0559, 0.0939],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 221 Loss: 0.6567 Alpha: tensor([0.1066, 0.0703, 0.0761, 0.0957, 0.0709, 0.0542, 0.0927],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 222 Loss: 0.6545 Alpha: tensor([0.1053, 0.0689, 0.0748, 0.0945, 0.0695, 0.0526, 0.0915],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 223 Loss: 0.6542 Alpha: tensor([0.1042, 0.0676, 0.0734, 0.0933, 0.0680, 0.0509, 0.0903],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 224 Loss: 0.6543 Alpha: tensor([0.1032, 0.0663, 0.0721, 0.0921, 0.0666, 0.0493, 0.0892],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 225 Loss: 0.6540 Alpha: tensor([0.1020, 0.0651, 0.0708, 0.0909, 0.0651, 0.0477, 0.0880],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 226 Loss: 0.6503 Alpha: tensor([0.1009, 0.0639, 0.0695, 0.0897, 0.0637, 0.0461, 0.0868],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 227 Loss: 0.6513 Alpha: tensor([0.0998, 0.0626, 0.0682, 0.0886, 0.0623, 0.0445, 0.0857],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 228 Loss: 0.6512 Alpha: tensor([0.0987, 0.0614, 0.0669, 0.0874, 0.0609, 0.0429, 0.0846],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 229 Loss: 0.6481 Alpha: tensor([0.0976, 0.0602, 0.0656, 0.0863, 0.0596, 0.0413, 0.0835],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 230 Loss: 0.6484 Alpha: tensor([0.0965, 0.0590, 0.0644, 0.0852, 0.0582, 0.0397, 0.0824],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 231 Loss: 0.6462 Alpha: tensor([0.0954, 0.0578, 0.0631, 0.0842, 0.0569, 0.0382, 0.0813],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 232 Loss: 0.6463 Alpha: tensor([0.0944, 0.0566, 0.0618, 0.0831, 0.0555, 0.0366, 0.0802],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 233 Loss: 0.6450 Alpha: tensor([0.0933, 0.0554, 0.0606, 0.0820, 0.0542, 0.0351, 0.0792],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 233 best val f1 0.4343 test f1 0.32913652062416077
Epoch 234 Loss: 0.6448 Alpha: tensor([0.0923, 0.0543, 0.0593, 0.0810, 0.0529, 0.0336, 0.0781],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 234 best val f1 0.4363 test f1 0.3301994800567627
Epoch 235 Loss: 0.6438 Alpha: tensor([0.0914, 0.0532, 0.0581, 0.0799, 0.0516, 0.0321, 0.0770],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 235 best val f1 0.4388 test f1 0.33159637451171875
Epoch 236 Loss: 0.6428 Alpha: tensor([0.0904, 0.0520, 0.0569, 0.0789, 0.0503, 0.0306, 0.0759],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 236 best val f1 0.4440 test f1 0.33314114809036255
Epoch 237 Loss: 0.6396 Alpha: tensor([0.0893, 0.0508, 0.0557, 0.0779, 0.0490, 0.0291, 0.0749],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 237 best val f1 0.4444 test f1 0.33427730202674866
Epoch 238 Loss: 0.6409 Alpha: tensor([0.0883, 0.0498, 0.0545, 0.0769, 0.0477, 0.0276, 0.0739],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 238 best val f1 0.4480 test f1 0.33513909578323364
Epoch 239 Loss: 0.6389 Alpha: tensor([0.0874, 0.0487, 0.0533, 0.0759, 0.0465, 0.0262, 0.0729],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 240 Loss: 0.6392 Alpha: tensor([0.0865, 0.0476, 0.0522, 0.0749, 0.0452, 0.0248, 0.0719],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 240 best val f1 0.4481 test f1 0.3382953405380249
Epoch 241 Loss: 0.6393 Alpha: tensor([0.0855, 0.0465, 0.0510, 0.0739, 0.0440, 0.0234, 0.0710],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 242 Loss: 0.6366 Alpha: tensor([0.0846, 0.0455, 0.0498, 0.0729, 0.0427, 0.0220, 0.0700],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 242 best val f1 0.4500 test f1 0.3403501510620117
Epoch 243 Loss: 0.6361 Alpha: tensor([0.0836, 0.0445, 0.0487, 0.0719, 0.0415, 0.0206, 0.0691],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 243 best val f1 0.4547 test f1 0.34166455268859863
Epoch 244 Loss: 0.6362 Alpha: tensor([0.0827, 0.0436, 0.0476, 0.0710, 0.0403, 0.0192, 0.0681],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 244 best val f1 0.4586 test f1 0.34299519658088684
Epoch 245 Loss: 0.6368 Alpha: tensor([0.0819, 0.0426, 0.0466, 0.0700, 0.0391, 0.0178, 0.0672],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 246 Loss: 0.6343 Alpha: tensor([0.0810, 0.0416, 0.0455, 0.0690, 0.0379, 0.0165, 0.0663],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 246 best val f1 0.4622 test f1 0.3454519212245941
Epoch 247 Loss: 0.6346 Alpha: tensor([0.0801, 0.0407, 0.0445, 0.0681, 0.0367, 0.0151, 0.0653],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 248 Loss: 0.6344 Alpha: tensor([0.0793, 0.0397, 0.0434, 0.0672, 0.0355, 0.0138, 0.0645],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 248 best val f1 0.4636 test f1 0.34701383113861084
Epoch 249 Loss: 0.6330 Alpha: tensor([0.0785, 0.0388, 0.0423, 0.0663, 0.0344, 0.0125, 0.0636],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 249 best val f1 0.4698 test f1 0.34734809398651123
Epoch 250 Loss: 0.6320 Alpha: tensor([0.0776, 0.0379, 0.0413, 0.0655, 0.0332, 0.0112, 0.0627],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 251 Loss: 0.6302 Alpha: tensor([0.0768, 0.0370, 0.0403, 0.0645, 0.0321, 0.0099, 0.0618],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 252 Loss: 0.6298 Alpha: tensor([0.0760, 0.0361, 0.0393, 0.0637, 0.0310, 0.0087, 0.0610],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 253 Loss: 0.6305 Alpha: tensor([0.0753, 0.0352, 0.0383, 0.0628, 0.0298, 0.0074, 0.0602],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 254 Loss: 0.6296 Alpha: tensor([0.0745, 0.0344, 0.0374, 0.0619, 0.0287, 0.0062, 0.0594],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 255 Loss: 0.6293 Alpha: tensor([0.0738, 0.0335, 0.0365, 0.0611, 0.0276, 0.0050, 0.0587],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 256 Loss: 0.6295 Alpha: tensor([0.0731, 0.0328, 0.0356, 0.0603, 0.0266, 0.0037, 0.0579],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 257 Loss: 0.6277 Alpha: tensor([0.0723, 0.0320, 0.0347, 0.0595, 0.0255, 0.0025, 0.0572],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 258 Loss: 0.6266 Alpha: tensor([0.0716, 0.0312, 0.0338, 0.0587, 0.0244, 0.0013, 0.0564],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 259 Loss: 0.6277 Alpha: tensor([0.0709, 0.0304, 0.0330, 0.0580, 0.0234, 0.0002, 0.0557],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 260 Loss: 0.6269 Alpha: tensor([ 0.0702,  0.0297,  0.0321,  0.0572,  0.0224, -0.0010,  0.0550],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 261 Loss: 0.6274 Alpha: tensor([ 0.0695,  0.0289,  0.0313,  0.0564,  0.0214, -0.0022,  0.0543],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 262 Loss: 0.6259 Alpha: tensor([ 0.0688,  0.0282,  0.0305,  0.0556,  0.0204, -0.0033,  0.0536],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 263 Loss: 0.6255 Alpha: tensor([ 0.0681,  0.0275,  0.0298,  0.0549,  0.0194, -0.0044,  0.0529],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 264 Loss: 0.6248 Alpha: tensor([ 0.0675,  0.0268,  0.0290,  0.0542,  0.0184, -0.0055,  0.0522],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 265 Loss: 0.6252 Alpha: tensor([ 0.0668,  0.0260,  0.0283,  0.0535,  0.0174, -0.0066,  0.0515],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 266 Loss: 0.6256 Alpha: tensor([ 0.0662,  0.0253,  0.0275,  0.0527,  0.0165, -0.0077,  0.0509],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 267 Loss: 0.6252 Alpha: tensor([ 0.0656,  0.0246,  0.0268,  0.0520,  0.0155, -0.0087,  0.0502],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 268 Loss: 0.6244 Alpha: tensor([ 0.0650,  0.0239,  0.0261,  0.0513,  0.0146, -0.0098,  0.0495],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 268 best val f1 0.4734 test f1 0.35781288146972656
Epoch 269 Loss: 0.6228 Alpha: tensor([ 0.0644,  0.0233,  0.0254,  0.0506,  0.0136, -0.0108,  0.0488],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 270 Loss: 0.6237 Alpha: tensor([ 0.0638,  0.0226,  0.0247,  0.0499,  0.0127, -0.0119,  0.0482],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 271 Loss: 0.6228 Alpha: tensor([ 0.0633,  0.0219,  0.0240,  0.0491,  0.0117, -0.0129,  0.0476],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 272 Loss: 0.6214 Alpha: tensor([ 0.0627,  0.0213,  0.0233,  0.0485,  0.0109, -0.0139,  0.0469],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 273 Loss: 0.6216 Alpha: tensor([ 0.0621,  0.0207,  0.0226,  0.0478,  0.0099, -0.0149,  0.0463],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 274 Loss: 0.6215 Alpha: tensor([ 0.0616,  0.0201,  0.0219,  0.0472,  0.0090, -0.0159,  0.0457],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 275 Loss: 0.6212 Alpha: tensor([ 0.0611,  0.0196,  0.0213,  0.0466,  0.0081, -0.0168,  0.0451],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 276 Loss: 0.6222 Alpha: tensor([ 0.0606,  0.0190,  0.0206,  0.0460,  0.0073, -0.0178,  0.0446],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 277 Loss: 0.6213 Alpha: tensor([ 0.0601,  0.0184,  0.0200,  0.0454,  0.0065, -0.0188,  0.0440],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 278 Loss: 0.6220 Alpha: tensor([ 0.0596,  0.0179,  0.0193,  0.0448,  0.0056, -0.0197,  0.0435],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 279 Loss: 0.6223 Alpha: tensor([ 0.0591,  0.0174,  0.0187,  0.0442,  0.0048, -0.0207,  0.0429],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 280 Loss: 0.6196 Alpha: tensor([ 0.0586,  0.0168,  0.0182,  0.0436,  0.0040, -0.0216,  0.0423],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 281 Loss: 0.6199 Alpha: tensor([ 0.0581,  0.0163,  0.0176,  0.0429,  0.0032, -0.0225,  0.0418],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 282 Loss: 0.6198 Alpha: tensor([ 0.0576,  0.0158,  0.0171,  0.0424,  0.0024, -0.0234,  0.0412],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 283 Loss: 0.6192 Alpha: tensor([ 0.0571,  0.0154,  0.0166,  0.0418,  0.0017, -0.0242,  0.0407],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 284 Loss: 0.6202 Alpha: tensor([ 0.0566,  0.0149,  0.0160,  0.0413,  0.0009, -0.0251,  0.0402],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 285 Loss: 0.6191 Alpha: tensor([ 0.0561,  0.0145,  0.0154,  0.0407,  0.0001, -0.0260,  0.0398],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 286 Loss: 0.6185 Alpha: tensor([ 0.0556,  0.0140,  0.0149,  0.0402, -0.0007, -0.0269,  0.0394],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 287 Loss: 0.6177 Alpha: tensor([ 0.0551,  0.0136,  0.0143,  0.0396, -0.0015, -0.0278,  0.0389],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 288 Loss: 0.6184 Alpha: tensor([ 0.0546,  0.0132,  0.0138,  0.0392, -0.0022, -0.0286,  0.0386],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 289 Loss: 0.6189 Alpha: tensor([ 0.0542,  0.0127,  0.0133,  0.0387, -0.0030, -0.0295,  0.0382],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 290 Loss: 0.6195 Alpha: tensor([ 0.0538,  0.0123,  0.0127,  0.0383, -0.0037, -0.0303,  0.0379],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 291 Loss: 0.6194 Alpha: tensor([ 0.0533,  0.0119,  0.0122,  0.0378, -0.0044, -0.0311,  0.0375],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 292 Loss: 0.6182 Alpha: tensor([ 0.0528,  0.0115,  0.0117,  0.0374, -0.0051, -0.0319,  0.0371],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 293 Loss: 0.6183 Alpha: tensor([ 0.0524,  0.0110,  0.0113,  0.0369, -0.0058, -0.0327,  0.0368],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 294 Loss: 0.6180 Alpha: tensor([ 0.0519,  0.0106,  0.0109,  0.0364, -0.0064, -0.0335,  0.0364],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 295 Loss: 0.6184 Alpha: tensor([ 0.0516,  0.0102,  0.0104,  0.0359, -0.0071, -0.0342,  0.0361],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 296 Loss: 0.6188 Alpha: tensor([ 0.0512,  0.0098,  0.0099,  0.0355, -0.0078, -0.0350,  0.0357],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 297 Loss: 0.6178 Alpha: tensor([ 0.0508,  0.0095,  0.0095,  0.0351, -0.0084, -0.0357,  0.0354],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 298 Loss: 0.6173 Alpha: tensor([ 0.0504,  0.0092,  0.0091,  0.0346, -0.0090, -0.0364,  0.0350],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 299 Loss: 0.6180 Alpha: tensor([ 0.0501,  0.0089,  0.0087,  0.0342, -0.0096, -0.0371,  0.0347],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 300 Loss: 0.6182 Alpha: tensor([ 0.0497,  0.0086,  0.0082,  0.0337, -0.0102, -0.0377,  0.0344],
       device='cuda:0', grad_fn=<SelectBackward0>)