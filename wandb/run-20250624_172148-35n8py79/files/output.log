/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  0
num_shots is  1
num_shots is  1
Epoch 1 Loss: 0.5468
Epoch 1 best val f1 0.2857 test f1 0.19820179045200348
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.13it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.39it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.34it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.33it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.41it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.23it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 2 Loss: 0.3355
Epoch 2 best val f1 0.4000 test f1 0.3445180654525757
Epoch 3 Loss: -0.1764
Epoch 3 best val f1 0.5600 test f1 0.4541999399662018
Epoch 4 Loss: -0.3870
Epoch 5 Loss: -0.4338
Epoch 6 Loss: -0.4839
Epoch 7 Loss: -0.5317
Epoch 8 Loss: -0.5774
Epoch 9 Loss: -0.6213
Epoch 10 Loss: -0.6645
Epoch 11 Loss: -0.7086
Epoch 12 Loss: -0.7543
Epoch 13 Loss: -0.8012
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.48it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.40it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.42it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.48it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.46it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.39it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.37it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.11it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.17it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 15 Loss: -0.8956
Epoch 16 Loss: -0.9433
Epoch 17 Loss: -0.9912
Epoch 18 Loss: -1.0397
Epoch 18 best val f1 0.5714 test f1 0.5646053552627563
Epoch 19 Loss: -1.0887
Epoch 20 Loss: -1.1380
Epoch 21 Loss: -1.1883
Epoch 22 Loss: -1.2398
Epoch 22 best val f1 0.5926 test f1 0.5777756571769714
Epoch 23 Loss: -1.2929
Epoch 24 Loss: -1.3475
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.72it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 12.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.01it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 12.80it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.94it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.41it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.26it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 25 best val f1 0.6667 test f1 0.5817774534225464
Epoch 26 Loss: -1.4592
Epoch 27 Loss: -1.5158
Epoch 28 Loss: -1.5733
Epoch 29 Loss: -1.6314
Epoch 30 Loss: -1.6913
Epoch 31 Loss: -1.7529
Epoch 32 Loss: -1.8154
Epoch 33 Loss: -1.8807
Epoch 34 Loss: -1.9466
Epoch 35 Loss: -2.0136
Epoch 36 Loss: -2.0833
Epoch 37 Loss: -2.1535
Epoch 38 Loss: -2.2240
Epoch 39 Loss: -2.2943
Epoch 40 Loss: -2.3647
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.98it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.53it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.06it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.14it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.12it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.30it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 42 Loss: -2.5067
Epoch 43 Loss: -2.5783
Epoch 44 Loss: -2.6509
Epoch 45 Loss: -2.7253
Epoch 46 Loss: -2.8013
Epoch 47 Loss: -2.8784
Epoch 48 Loss: -2.9569
Epoch 49 Loss: -3.0369
Epoch 50 Loss: -3.1170
Epoch 51 Loss: -3.1973
Epoch 52 Loss: -3.2789
Epoch 53 Loss: -3.3634
Epoch 54 Loss: -3.4478
Epoch 55 Loss: -3.5333
Epoch 56 Loss: -3.6202
Epoch 57 Loss: -3.7079
Epoch 58 Loss: -3.7969
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.69it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.08it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.18it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 60 Loss: -3.9806
Epoch 61 Loss: -4.0728
Epoch 62 Loss: -4.1648
Epoch 63 Loss: -4.2571
Epoch 64 Loss: -4.3507
Epoch 65 Loss: -4.4458
Epoch 66 Loss: -4.5463
Epoch 67 Loss: -4.6556
Epoch 68 Loss: -4.7670
Epoch 69 Loss: -4.8793
Epoch 70 Loss: -4.9982
Epoch 71 Loss: -5.1231
Epoch 72 Loss: -5.2559
Epoch 73 Loss: -5.3810
Epoch 74 Loss: -5.5001
Epoch 75 Loss: -5.6147
Epoch 76 Loss: -5.7270
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.12it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.00it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.18it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.04it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
Epoch 78 Loss: -5.9474
Epoch 79 Loss: -6.0573
Epoch 80 Loss: -6.1676
Epoch 81 Loss: -6.2781
Epoch 82 Loss: -6.3887
Epoch 83 Loss: -6.4998
Epoch 84 Loss: -6.6112
Epoch 85 Loss: -6.7226
Epoch 86 Loss: -6.8343
Epoch 87 Loss: -6.9462
Epoch 88 Loss: -7.0583
Epoch 89 Loss: -7.1704
Epoch 90 Loss: -7.2826
Epoch 91 Loss: -7.3950
Epoch 92 Loss: -7.5075
Epoch 93 Loss: -7.6202
Epoch 94 Loss: -7.7331
Epoch 95 Loss: -7.8460
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.86it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.34it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.06it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.33it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.65it/s]
Epoch 96 Loss: -7.9591
Epoch 97 Loss: -8.0722
Epoch 98 Loss: -8.1856
Epoch 99 Loss: -8.2989
Epoch 100 Loss: -8.4124