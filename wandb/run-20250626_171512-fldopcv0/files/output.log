/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
loading num parts:  1
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
loading num parts:  2
loading num parts:  3
loading num parts:  4
num_shots is  16
num_shots is  16
Epoch 1 Loss: 1.5547 Alpha: tensor([0.4980, 0.4980, 0.4980, 0.4980, 0.4980, 0.4980, 0.4980],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 1 best val f1 0.3984 test f1 0.29680711030960083
Epoch 2 Loss: 1.5413 Alpha: tensor([0.4960, 0.4960, 0.4960, 0.4960, 0.4960, 0.4960, 0.4960],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 2 best val f1 0.3995 test f1 0.29646092653274536
Epoch 3 Loss: 1.5237 Alpha: tensor([0.4940, 0.4940, 0.4940, 0.4940, 0.4940, 0.4941, 0.4940],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 4 Loss: 1.5154 Alpha: tensor([0.4920, 0.4920, 0.4921, 0.4920, 0.4920, 0.4921, 0.4920],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 5 Loss: 1.5085 Alpha: tensor([0.4901, 0.4900, 0.4901, 0.4900, 0.4900, 0.4901, 0.4900],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 6 Loss: 1.4862 Alpha: tensor([0.4881, 0.4880, 0.4881, 0.4880, 0.4880, 0.4881, 0.4880],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 7 Loss: 1.4639 Alpha: tensor([0.4861, 0.4860, 0.4861, 0.4861, 0.4860, 0.4861, 0.4861],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 8 Loss: 1.4652 Alpha: tensor([0.4841, 0.4840, 0.4841, 0.4840, 0.4840, 0.4841, 0.4841],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 9 Loss: 1.4546 Alpha: tensor([0.4822, 0.4820, 0.4821, 0.4820, 0.4820, 0.4821, 0.4822],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 10 Loss: 1.4344 Alpha: tensor([0.4802, 0.4800, 0.4801, 0.4800, 0.4800, 0.4801, 0.4802],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 11 Loss: 1.4409 Alpha: tensor([0.4782, 0.4780, 0.4781, 0.4780, 0.4780, 0.4780, 0.4782],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 12 Loss: 1.4152 Alpha: tensor([0.4762, 0.4760, 0.4761, 0.4760, 0.4760, 0.4760, 0.4762],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 13 Loss: 1.3995 Alpha: tensor([0.4742, 0.4740, 0.4741, 0.4739, 0.4740, 0.4740, 0.4743],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 14 Loss: 1.3836 Alpha: tensor([0.4722, 0.4720, 0.4721, 0.4719, 0.4719, 0.4720, 0.4723],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 15 Loss: 1.3819 Alpha: tensor([0.4702, 0.4699, 0.4700, 0.4699, 0.4699, 0.4700, 0.4703],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 16 Loss: 1.3628 Alpha: tensor([0.4682, 0.4679, 0.4680, 0.4679, 0.4678, 0.4680, 0.4683],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 17 Loss: 1.3583 Alpha: tensor([0.4663, 0.4659, 0.4660, 0.4658, 0.4658, 0.4659, 0.4663],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 18 Loss: 1.3477 Alpha: tensor([0.4643, 0.4639, 0.4639, 0.4638, 0.4638, 0.4639, 0.4642],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 19 Loss: 1.3445 Alpha: tensor([0.4623, 0.4618, 0.4619, 0.4618, 0.4617, 0.4618, 0.4622],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 20 Loss: 1.3266 Alpha: tensor([0.4603, 0.4598, 0.4598, 0.4597, 0.4597, 0.4598, 0.4602],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 21 Loss: 1.3235 Alpha: tensor([0.4583, 0.4578, 0.4578, 0.4576, 0.4576, 0.4578, 0.4582],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 22 Loss: 1.3152 Alpha: tensor([0.4563, 0.4557, 0.4557, 0.4556, 0.4556, 0.4557, 0.4561],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 23 Loss: 1.2917 Alpha: tensor([0.4543, 0.4536, 0.4536, 0.4535, 0.4536, 0.4537, 0.4541],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 24 Loss: 1.2933 Alpha: tensor([0.4524, 0.4516, 0.4516, 0.4515, 0.4515, 0.4516, 0.4520],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 25 Loss: 1.2771 Alpha: tensor([0.4504, 0.4495, 0.4496, 0.4494, 0.4495, 0.4495, 0.4500],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 26 Loss: 1.2746 Alpha: tensor([0.4484, 0.4475, 0.4475, 0.4474, 0.4474, 0.4475, 0.4479],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 27 Loss: 1.2619 Alpha: tensor([0.4464, 0.4455, 0.4455, 0.4453, 0.4453, 0.4454, 0.4458],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 28 Loss: 1.2635 Alpha: tensor([0.4444, 0.4434, 0.4434, 0.4433, 0.4433, 0.4434, 0.4438],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 29 Loss: 1.2523 Alpha: tensor([0.4424, 0.4414, 0.4414, 0.4412, 0.4412, 0.4413, 0.4417],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 30 Loss: 1.2488 Alpha: tensor([0.4404, 0.4393, 0.4393, 0.4391, 0.4391, 0.4392, 0.4397],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 31 Loss: 1.2329 Alpha: tensor([0.4385, 0.4373, 0.4373, 0.4371, 0.4370, 0.4372, 0.4376],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 32 Loss: 1.2544 Alpha: tensor([0.4365, 0.4352, 0.4352, 0.4350, 0.4350, 0.4351, 0.4356],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 33 Loss: 1.2234 Alpha: tensor([0.4345, 0.4331, 0.4332, 0.4329, 0.4329, 0.4330, 0.4336],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 34 Loss: 1.2200 Alpha: tensor([0.4325, 0.4311, 0.4311, 0.4308, 0.4308, 0.4309, 0.4315],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 35 Loss: 1.2100 Alpha: tensor([0.4305, 0.4290, 0.4290, 0.4287, 0.4287, 0.4289, 0.4295],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 36 Loss: 1.2133 Alpha: tensor([0.4285, 0.4269, 0.4270, 0.4267, 0.4266, 0.4268, 0.4274],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 37 Loss: 1.2199 Alpha: tensor([0.4266, 0.4249, 0.4249, 0.4246, 0.4245, 0.4247, 0.4253],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 38 Loss: 1.1939 Alpha: tensor([0.4246, 0.4228, 0.4229, 0.4225, 0.4224, 0.4226, 0.4232],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 39 Loss: 1.1927 Alpha: tensor([0.4226, 0.4207, 0.4208, 0.4204, 0.4203, 0.4205, 0.4212],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 40 Loss: 1.1905 Alpha: tensor([0.4207, 0.4186, 0.4187, 0.4183, 0.4182, 0.4185, 0.4191],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 41 Loss: 1.1916 Alpha: tensor([0.4187, 0.4165, 0.4167, 0.4162, 0.4162, 0.4164, 0.4171],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 42 Loss: 1.1772 Alpha: tensor([0.4167, 0.4144, 0.4146, 0.4141, 0.4141, 0.4143, 0.4150],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 43 Loss: 1.1613 Alpha: tensor([0.4148, 0.4123, 0.4126, 0.4120, 0.4120, 0.4122, 0.4130],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 44 Loss: 1.1637 Alpha: tensor([0.4128, 0.4102, 0.4105, 0.4099, 0.4099, 0.4102, 0.4109],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 45 Loss: 1.1538 Alpha: tensor([0.4108, 0.4081, 0.4085, 0.4079, 0.4078, 0.4081, 0.4089],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 46 Loss: 1.1521 Alpha: tensor([0.4088, 0.4061, 0.4064, 0.4058, 0.4057, 0.4061, 0.4068],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 47 Loss: 1.1518 Alpha: tensor([0.4068, 0.4040, 0.4044, 0.4037, 0.4036, 0.4040, 0.4047],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 48 Loss: 1.1607 Alpha: tensor([0.4048, 0.4019, 0.4024, 0.4017, 0.4015, 0.4020, 0.4027],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 49 Loss: 1.1505 Alpha: tensor([0.4029, 0.3998, 0.4003, 0.3996, 0.3994, 0.3999, 0.4006],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 50 Loss: 1.1409 Alpha: tensor([0.4009, 0.3977, 0.3983, 0.3975, 0.3973, 0.3978, 0.3985],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 51 Loss: 1.1385 Alpha: tensor([0.3989, 0.3956, 0.3962, 0.3955, 0.3952, 0.3958, 0.3965],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 52 Loss: 1.1298 Alpha: tensor([0.3969, 0.3935, 0.3942, 0.3934, 0.3931, 0.3937, 0.3944],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 53 Loss: 1.1326 Alpha: tensor([0.3949, 0.3914, 0.3922, 0.3913, 0.3910, 0.3917, 0.3924],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 54 Loss: 1.1233 Alpha: tensor([0.3929, 0.3893, 0.3901, 0.3892, 0.3889, 0.3896, 0.3903],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 55 Loss: 1.1206 Alpha: tensor([0.3909, 0.3872, 0.3880, 0.3872, 0.3868, 0.3875, 0.3883],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 56 Loss: 1.1197 Alpha: tensor([0.3889, 0.3851, 0.3860, 0.3851, 0.3847, 0.3854, 0.3862],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 57 Loss: 1.1210 Alpha: tensor([0.3870, 0.3830, 0.3839, 0.3831, 0.3826, 0.3834, 0.3842],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 58 Loss: 1.1017 Alpha: tensor([0.3850, 0.3809, 0.3819, 0.3810, 0.3805, 0.3813, 0.3821],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 59 Loss: 1.1046 Alpha: tensor([0.3830, 0.3788, 0.3798, 0.3789, 0.3784, 0.3792, 0.3801],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 60 Loss: 1.0977 Alpha: tensor([0.3810, 0.3766, 0.3778, 0.3769, 0.3763, 0.3771, 0.3780],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 61 Loss: 1.1019 Alpha: tensor([0.3790, 0.3745, 0.3757, 0.3748, 0.3742, 0.3750, 0.3760],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 62 Loss: 1.0933 Alpha: tensor([0.3771, 0.3724, 0.3737, 0.3727, 0.3721, 0.3729, 0.3740],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 63 Loss: 1.0776 Alpha: tensor([0.3751, 0.3703, 0.3716, 0.3707, 0.3700, 0.3708, 0.3719],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 64 Loss: 1.0867 Alpha: tensor([0.3731, 0.3682, 0.3696, 0.3686, 0.3680, 0.3687, 0.3699],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 65 Loss: 1.0945 Alpha: tensor([0.3711, 0.3661, 0.3676, 0.3666, 0.3659, 0.3667, 0.3679],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 66 Loss: 1.0940 Alpha: tensor([0.3691, 0.3640, 0.3655, 0.3645, 0.3638, 0.3646, 0.3658],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 67 Loss: 1.0876 Alpha: tensor([0.3671, 0.3619, 0.3635, 0.3625, 0.3617, 0.3625, 0.3638],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 68 Loss: 1.0770 Alpha: tensor([0.3651, 0.3598, 0.3614, 0.3604, 0.3596, 0.3604, 0.3618],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 69 Loss: 1.0672 Alpha: tensor([0.3631, 0.3577, 0.3594, 0.3583, 0.3575, 0.3583, 0.3597],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 70 Loss: 1.0718 Alpha: tensor([0.3611, 0.3556, 0.3573, 0.3563, 0.3554, 0.3562, 0.3577],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 71 Loss: 1.0599 Alpha: tensor([0.3591, 0.3535, 0.3553, 0.3542, 0.3532, 0.3541, 0.3556],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 72 Loss: 1.0558 Alpha: tensor([0.3571, 0.3513, 0.3532, 0.3522, 0.3511, 0.3521, 0.3536],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 73 Loss: 1.0606 Alpha: tensor([0.3551, 0.3492, 0.3512, 0.3502, 0.3490, 0.3500, 0.3515],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 74 Loss: 1.0552 Alpha: tensor([0.3531, 0.3471, 0.3492, 0.3481, 0.3469, 0.3479, 0.3496],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 75 Loss: 1.0487 Alpha: tensor([0.3511, 0.3449, 0.3471, 0.3461, 0.3448, 0.3458, 0.3475],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 76 Loss: 1.0399 Alpha: tensor([0.3491, 0.3428, 0.3451, 0.3441, 0.3427, 0.3438, 0.3455],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 77 Loss: 1.0464 Alpha: tensor([0.3471, 0.3407, 0.3431, 0.3421, 0.3406, 0.3417, 0.3435],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 78 Loss: 1.0409 Alpha: tensor([0.3451, 0.3386, 0.3411, 0.3400, 0.3385, 0.3396, 0.3415],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 79 Loss: 1.0344 Alpha: tensor([0.3431, 0.3364, 0.3391, 0.3380, 0.3363, 0.3376, 0.3395],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 80 Loss: 1.0312 Alpha: tensor([0.3411, 0.3343, 0.3371, 0.3360, 0.3342, 0.3355, 0.3375],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 81 Loss: 1.0296 Alpha: tensor([0.3391, 0.3322, 0.3351, 0.3340, 0.3321, 0.3335, 0.3355],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 82 Loss: 1.0233 Alpha: tensor([0.3371, 0.3300, 0.3330, 0.3319, 0.3301, 0.3314, 0.3336],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 83 Loss: 1.0175 Alpha: tensor([0.3351, 0.3279, 0.3310, 0.3299, 0.3280, 0.3293, 0.3316],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 84 Loss: 1.0271 Alpha: tensor([0.3331, 0.3258, 0.3290, 0.3279, 0.3259, 0.3272, 0.3296],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 85 Loss: 1.0158 Alpha: tensor([0.3311, 0.3237, 0.3270, 0.3258, 0.3238, 0.3251, 0.3276],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 86 Loss: 1.0145 Alpha: tensor([0.3291, 0.3216, 0.3250, 0.3238, 0.3217, 0.3230, 0.3256],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 87 Loss: 1.0130 Alpha: tensor([0.3271, 0.3194, 0.3230, 0.3218, 0.3196, 0.3210, 0.3237],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 88 Loss: 1.0108 Alpha: tensor([0.3251, 0.3173, 0.3210, 0.3198, 0.3175, 0.3189, 0.3217],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 89 Loss: 1.0047 Alpha: tensor([0.3232, 0.3152, 0.3190, 0.3177, 0.3154, 0.3168, 0.3197],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 90 Loss: 1.0012 Alpha: tensor([0.3212, 0.3131, 0.3170, 0.3157, 0.3133, 0.3147, 0.3178],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 91 Loss: 1.0015 Alpha: tensor([0.3192, 0.3110, 0.3150, 0.3137, 0.3112, 0.3126, 0.3158],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 92 Loss: 0.9922 Alpha: tensor([0.3171, 0.3089, 0.3129, 0.3116, 0.3092, 0.3105, 0.3138],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 93 Loss: 0.9942 Alpha: tensor([0.3151, 0.3068, 0.3109, 0.3096, 0.3071, 0.3085, 0.3118],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 94 Loss: 0.9848 Alpha: tensor([0.3131, 0.3046, 0.3089, 0.3076, 0.3050, 0.3064, 0.3099],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 95 Loss: 0.9954 Alpha: tensor([0.3111, 0.3025, 0.3070, 0.3056, 0.3029, 0.3043, 0.3079],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 96 Loss: 0.9873 Alpha: tensor([0.3091, 0.3004, 0.3050, 0.3036, 0.3008, 0.3022, 0.3059],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 97 Loss: 0.9801 Alpha: tensor([0.3071, 0.2983, 0.3030, 0.3016, 0.2987, 0.3001, 0.3039],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 98 Loss: 0.9823 Alpha: tensor([0.3051, 0.2962, 0.3010, 0.2996, 0.2967, 0.2980, 0.3019],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 99 Loss: 0.9765 Alpha: tensor([0.3031, 0.2940, 0.2989, 0.2977, 0.2946, 0.2959, 0.3000],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 100 Loss: 0.9716 Alpha: tensor([0.3011, 0.2919, 0.2970, 0.2957, 0.2925, 0.2938, 0.2980],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 101 Loss: 0.9594 Alpha: tensor([0.2991, 0.2898, 0.2950, 0.2937, 0.2904, 0.2917, 0.2960],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 102 Loss: 0.9716 Alpha: tensor([0.2972, 0.2877, 0.2930, 0.2917, 0.2883, 0.2896, 0.2940],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 103 Loss: 0.9651 Alpha: tensor([0.2952, 0.2855, 0.2910, 0.2897, 0.2862, 0.2875, 0.2921],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 104 Loss: 0.9611 Alpha: tensor([0.2932, 0.2834, 0.2890, 0.2877, 0.2842, 0.2854, 0.2901],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 105 Loss: 0.9562 Alpha: tensor([0.2912, 0.2813, 0.2869, 0.2857, 0.2821, 0.2834, 0.2882],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 106 Loss: 0.9455 Alpha: tensor([0.2892, 0.2791, 0.2849, 0.2836, 0.2800, 0.2813, 0.2862],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 107 Loss: 0.9506 Alpha: tensor([0.2872, 0.2770, 0.2829, 0.2816, 0.2779, 0.2792, 0.2843],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 108 Loss: 0.9504 Alpha: tensor([0.2852, 0.2749, 0.2809, 0.2796, 0.2759, 0.2771, 0.2824],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 109 Loss: 0.9506 Alpha: tensor([0.2833, 0.2728, 0.2789, 0.2777, 0.2738, 0.2750, 0.2804],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 110 Loss: 0.9422 Alpha: tensor([0.2813, 0.2706, 0.2770, 0.2757, 0.2717, 0.2729, 0.2784],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 111 Loss: 0.9420 Alpha: tensor([0.2793, 0.2685, 0.2750, 0.2737, 0.2697, 0.2709, 0.2765],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 112 Loss: 0.9333 Alpha: tensor([0.2773, 0.2664, 0.2730, 0.2717, 0.2676, 0.2688, 0.2745],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 113 Loss: 0.9285 Alpha: tensor([0.2754, 0.2642, 0.2710, 0.2697, 0.2655, 0.2667, 0.2725],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 114 Loss: 0.9263 Alpha: tensor([0.2734, 0.2621, 0.2690, 0.2677, 0.2634, 0.2646, 0.2706],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 115 Loss: 0.9236 Alpha: tensor([0.2714, 0.2600, 0.2671, 0.2657, 0.2613, 0.2625, 0.2687],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 116 Loss: 0.9252 Alpha: tensor([0.2695, 0.2579, 0.2651, 0.2637, 0.2593, 0.2605, 0.2667],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 117 Loss: 0.9225 Alpha: tensor([0.2675, 0.2557, 0.2631, 0.2617, 0.2572, 0.2584, 0.2648],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 118 Loss: 0.9191 Alpha: tensor([0.2656, 0.2536, 0.2612, 0.2598, 0.2551, 0.2563, 0.2628],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 119 Loss: 0.9121 Alpha: tensor([0.2636, 0.2515, 0.2592, 0.2578, 0.2530, 0.2542, 0.2608],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 120 Loss: 0.9011 Alpha: tensor([0.2616, 0.2493, 0.2573, 0.2559, 0.2509, 0.2522, 0.2589],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 121 Loss: 0.8976 Alpha: tensor([0.2596, 0.2472, 0.2553, 0.2539, 0.2489, 0.2501, 0.2570],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 122 Loss: 0.9070 Alpha: tensor([0.2577, 0.2451, 0.2533, 0.2520, 0.2468, 0.2481, 0.2551],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 123 Loss: 0.8984 Alpha: tensor([0.2557, 0.2430, 0.2514, 0.2500, 0.2447, 0.2460, 0.2532],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 124 Loss: 0.8873 Alpha: tensor([0.2537, 0.2409, 0.2494, 0.2481, 0.2427, 0.2439, 0.2513],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 125 Loss: 0.8930 Alpha: tensor([0.2518, 0.2388, 0.2475, 0.2461, 0.2406, 0.2419, 0.2494],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 126 Loss: 0.8853 Alpha: tensor([0.2498, 0.2367, 0.2455, 0.2442, 0.2386, 0.2399, 0.2475],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 127 Loss: 0.8840 Alpha: tensor([0.2479, 0.2345, 0.2435, 0.2423, 0.2365, 0.2378, 0.2456],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 128 Loss: 0.8752 Alpha: tensor([0.2460, 0.2325, 0.2416, 0.2403, 0.2345, 0.2358, 0.2437],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 129 Loss: 0.8826 Alpha: tensor([0.2440, 0.2304, 0.2397, 0.2384, 0.2324, 0.2337, 0.2418],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 130 Loss: 0.8735 Alpha: tensor([0.2421, 0.2283, 0.2378, 0.2365, 0.2304, 0.2317, 0.2399],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 131 Loss: 0.8631 Alpha: tensor([0.2402, 0.2262, 0.2359, 0.2346, 0.2283, 0.2296, 0.2380],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 132 Loss: 0.8734 Alpha: tensor([0.2383, 0.2241, 0.2340, 0.2327, 0.2262, 0.2276, 0.2362],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 133 Loss: 0.8672 Alpha: tensor([0.2364, 0.2220, 0.2321, 0.2308, 0.2242, 0.2256, 0.2343],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 134 Loss: 0.8646 Alpha: tensor([0.2344, 0.2200, 0.2302, 0.2288, 0.2222, 0.2236, 0.2324],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 135 Loss: 0.8622 Alpha: tensor([0.2325, 0.2179, 0.2283, 0.2270, 0.2202, 0.2215, 0.2306],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 136 Loss: 0.8592 Alpha: tensor([0.2305, 0.2158, 0.2264, 0.2250, 0.2181, 0.2195, 0.2287],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 137 Loss: 0.8565 Alpha: tensor([0.2286, 0.2137, 0.2245, 0.2231, 0.2161, 0.2175, 0.2269],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 138 Loss: 0.8518 Alpha: tensor([0.2267, 0.2117, 0.2225, 0.2213, 0.2140, 0.2155, 0.2250],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 139 Loss: 0.8474 Alpha: tensor([0.2247, 0.2096, 0.2207, 0.2194, 0.2120, 0.2135, 0.2232],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 140 Loss: 0.8517 Alpha: tensor([0.2228, 0.2075, 0.2188, 0.2175, 0.2100, 0.2115, 0.2214],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 141 Loss: 0.8411 Alpha: tensor([0.2208, 0.2055, 0.2169, 0.2156, 0.2080, 0.2094, 0.2195],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 142 Loss: 0.8435 Alpha: tensor([0.2189, 0.2034, 0.2150, 0.2137, 0.2059, 0.2074, 0.2178],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 143 Loss: 0.8346 Alpha: tensor([0.2169, 0.2013, 0.2131, 0.2118, 0.2039, 0.2054, 0.2159],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 144 Loss: 0.8357 Alpha: tensor([0.2150, 0.1992, 0.2113, 0.2099, 0.2019, 0.2034, 0.2141],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 145 Loss: 0.8378 Alpha: tensor([0.2131, 0.1971, 0.2094, 0.2080, 0.1999, 0.2014, 0.2124],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 146 Loss: 0.8317 Alpha: tensor([0.2111, 0.1951, 0.2075, 0.2062, 0.1979, 0.1994, 0.2106],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 147 Loss: 0.8272 Alpha: tensor([0.2092, 0.1930, 0.2056, 0.2043, 0.1959, 0.1974, 0.2088],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 148 Loss: 0.8296 Alpha: tensor([0.2073, 0.1909, 0.2038, 0.2024, 0.1939, 0.1954, 0.2070],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 149 Loss: 0.8244 Alpha: tensor([0.2054, 0.1889, 0.2019, 0.2006, 0.1918, 0.1934, 0.2052],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 150 Loss: 0.8234 Alpha: tensor([0.2034, 0.1868, 0.2000, 0.1987, 0.1898, 0.1914, 0.2034],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 151 Loss: 0.8100 Alpha: tensor([0.2015, 0.1847, 0.1981, 0.1968, 0.1879, 0.1894, 0.2017],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 152 Loss: 0.8107 Alpha: tensor([0.1996, 0.1826, 0.1962, 0.1949, 0.1858, 0.1874, 0.2000],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 153 Loss: 0.8055 Alpha: tensor([0.1977, 0.1806, 0.1944, 0.1930, 0.1838, 0.1854, 0.1982],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 154 Loss: 0.8081 Alpha: tensor([0.1958, 0.1786, 0.1925, 0.1912, 0.1818, 0.1834, 0.1965],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 155 Loss: 0.8049 Alpha: tensor([0.1939, 0.1766, 0.1907, 0.1893, 0.1798, 0.1815, 0.1948],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 156 Loss: 0.7982 Alpha: tensor([0.1920, 0.1746, 0.1888, 0.1875, 0.1778, 0.1795, 0.1931],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 157 Loss: 0.8001 Alpha: tensor([0.1901, 0.1726, 0.1870, 0.1856, 0.1758, 0.1775, 0.1914],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 158 Loss: 0.7919 Alpha: tensor([0.1882, 0.1705, 0.1852, 0.1838, 0.1738, 0.1755, 0.1897],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 159 Loss: 0.7974 Alpha: tensor([0.1863, 0.1685, 0.1834, 0.1819, 0.1718, 0.1736, 0.1880],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 160 Loss: 0.7873 Alpha: tensor([0.1844, 0.1665, 0.1815, 0.1801, 0.1698, 0.1717, 0.1863],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 161 Loss: 0.7907 Alpha: tensor([0.1826, 0.1645, 0.1797, 0.1783, 0.1678, 0.1698, 0.1846],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 162 Loss: 0.7800 Alpha: tensor([0.1807, 0.1625, 0.1779, 0.1764, 0.1658, 0.1678, 0.1829],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 163 Loss: 0.7823 Alpha: tensor([0.1788, 0.1605, 0.1762, 0.1746, 0.1639, 0.1659, 0.1812],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 164 Loss: 0.7811 Alpha: tensor([0.1770, 0.1585, 0.1744, 0.1728, 0.1619, 0.1639, 0.1795],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 165 Loss: 0.7755 Alpha: tensor([0.1751, 0.1565, 0.1726, 0.1710, 0.1599, 0.1620, 0.1779],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 166 Loss: 0.7710 Alpha: tensor([0.1733, 0.1545, 0.1708, 0.1692, 0.1579, 0.1601, 0.1762],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 167 Loss: 0.7692 Alpha: tensor([0.1714, 0.1525, 0.1691, 0.1675, 0.1559, 0.1582, 0.1746],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 168 Loss: 0.7705 Alpha: tensor([0.1696, 0.1506, 0.1673, 0.1657, 0.1540, 0.1563, 0.1730],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 169 Loss: 0.7665 Alpha: tensor([0.1677, 0.1486, 0.1656, 0.1639, 0.1520, 0.1544, 0.1714],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 170 Loss: 0.7625 Alpha: tensor([0.1658, 0.1467, 0.1639, 0.1621, 0.1501, 0.1525, 0.1697],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 171 Loss: 0.7602 Alpha: tensor([0.1640, 0.1447, 0.1621, 0.1604, 0.1482, 0.1506, 0.1681],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 172 Loss: 0.7617 Alpha: tensor([0.1621, 0.1428, 0.1604, 0.1586, 0.1462, 0.1487, 0.1666],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 173 Loss: 0.7603 Alpha: tensor([0.1603, 0.1408, 0.1587, 0.1569, 0.1443, 0.1469, 0.1650],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 174 Loss: 0.7543 Alpha: tensor([0.1585, 0.1389, 0.1569, 0.1551, 0.1423, 0.1450, 0.1634],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 175 Loss: 0.7488 Alpha: tensor([0.1567, 0.1370, 0.1552, 0.1534, 0.1404, 0.1431, 0.1618],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 176 Loss: 0.7453 Alpha: tensor([0.1548, 0.1350, 0.1534, 0.1517, 0.1385, 0.1412, 0.1603],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 177 Loss: 0.7477 Alpha: tensor([0.1530, 0.1331, 0.1517, 0.1500, 0.1365, 0.1393, 0.1588],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 178 Loss: 0.7398 Alpha: tensor([0.1512, 0.1312, 0.1500, 0.1482, 0.1346, 0.1375, 0.1572],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 179 Loss: 0.7393 Alpha: tensor([0.1494, 0.1293, 0.1483, 0.1465, 0.1327, 0.1356, 0.1557],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 180 Loss: 0.7416 Alpha: tensor([0.1476, 0.1275, 0.1466, 0.1448, 0.1308, 0.1338, 0.1543],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 181 Loss: 0.7391 Alpha: tensor([0.1458, 0.1256, 0.1449, 0.1431, 0.1289, 0.1320, 0.1528],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 182 Loss: 0.7340 Alpha: tensor([0.1440, 0.1238, 0.1432, 0.1413, 0.1271, 0.1301, 0.1513],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 183 Loss: 0.7306 Alpha: tensor([0.1423, 0.1219, 0.1415, 0.1396, 0.1252, 0.1283, 0.1498],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 184 Loss: 0.7287 Alpha: tensor([0.1405, 0.1201, 0.1398, 0.1379, 0.1233, 0.1265, 0.1484],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 185 Loss: 0.7281 Alpha: tensor([0.1388, 0.1182, 0.1381, 0.1362, 0.1215, 0.1247, 0.1470],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 186 Loss: 0.7243 Alpha: tensor([0.1370, 0.1164, 0.1364, 0.1345, 0.1196, 0.1228, 0.1456],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 187 Loss: 0.7237 Alpha: tensor([0.1352, 0.1146, 0.1348, 0.1329, 0.1178, 0.1210, 0.1442],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 188 Loss: 0.7222 Alpha: tensor([0.1335, 0.1127, 0.1331, 0.1312, 0.1160, 0.1192, 0.1428],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 189 Loss: 0.7171 Alpha: tensor([0.1318, 0.1109, 0.1315, 0.1295, 0.1141, 0.1174, 0.1413],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 190 Loss: 0.7137 Alpha: tensor([0.1300, 0.1091, 0.1299, 0.1279, 0.1123, 0.1156, 0.1400],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 191 Loss: 0.7125 Alpha: tensor([0.1283, 0.1073, 0.1282, 0.1262, 0.1105, 0.1138, 0.1386],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 192 Loss: 0.7130 Alpha: tensor([0.1266, 0.1056, 0.1266, 0.1246, 0.1087, 0.1121, 0.1372],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 193 Loss: 0.7101 Alpha: tensor([0.1250, 0.1038, 0.1250, 0.1229, 0.1068, 0.1103, 0.1358],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 194 Loss: 0.7121 Alpha: tensor([0.1233, 0.1021, 0.1234, 0.1213, 0.1051, 0.1086, 0.1345],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 195 Loss: 0.7056 Alpha: tensor([0.1215, 0.1004, 0.1218, 0.1197, 0.1033, 0.1068, 0.1331],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 196 Loss: 0.7037 Alpha: tensor([0.1198, 0.0986, 0.1202, 0.1181, 0.1015, 0.1051, 0.1317],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 197 Loss: 0.6989 Alpha: tensor([0.1181, 0.0969, 0.1186, 0.1165, 0.0998, 0.1033, 0.1304],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 198 Loss: 0.7025 Alpha: tensor([0.1164, 0.0952, 0.1170, 0.1150, 0.0980, 0.1017, 0.1292],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 199 Loss: 0.6970 Alpha: tensor([0.1147, 0.0935, 0.1154, 0.1134, 0.0963, 0.0999, 0.1279],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 200 Loss: 0.6962 Alpha: tensor([0.1131, 0.0918, 0.1139, 0.1118, 0.0945, 0.0983, 0.1266],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 201 Loss: 0.6917 Alpha: tensor([0.1114, 0.0901, 0.1123, 0.1103, 0.0928, 0.0966, 0.1253],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 202 Loss: 0.6929 Alpha: tensor([0.1098, 0.0885, 0.1107, 0.1087, 0.0911, 0.0949, 0.1241],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 203 Loss: 0.6920 Alpha: tensor([0.1081, 0.0868, 0.1092, 0.1072, 0.0894, 0.0933, 0.1228],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 204 Loss: 0.6903 Alpha: tensor([0.1065, 0.0852, 0.1078, 0.1056, 0.0877, 0.0917, 0.1216],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 205 Loss: 0.6842 Alpha: tensor([0.1048, 0.0835, 0.1062, 0.1041, 0.0859, 0.0900, 0.1205],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 206 Loss: 0.6874 Alpha: tensor([0.1033, 0.0819, 0.1048, 0.1026, 0.0842, 0.0884, 0.1193],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 207 Loss: 0.6838 Alpha: tensor([0.1017, 0.0803, 0.1033, 0.1010, 0.0825, 0.0868, 0.1181],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 208 Loss: 0.6805 Alpha: tensor([0.1001, 0.0787, 0.1018, 0.0995, 0.0809, 0.0851, 0.1170],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 208 best val f1 0.4000 test f1 0.32751503586769104
Epoch 209 Loss: 0.6817 Alpha: tensor([0.0985, 0.0771, 0.1004, 0.0980, 0.0792, 0.0836, 0.1159],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 209 best val f1 0.4022 test f1 0.3287421464920044
Epoch 210 Loss: 0.6725 Alpha: tensor([0.0969, 0.0755, 0.0989, 0.0965, 0.0775, 0.0820, 0.1147],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 210 best val f1 0.4022 test f1 0.3295869827270508
Epoch 211 Loss: 0.6773 Alpha: tensor([0.0954, 0.0739, 0.0975, 0.0950, 0.0759, 0.0804, 0.1136],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 211 best val f1 0.4059 test f1 0.33067646622657776
Epoch 212 Loss: 0.6762 Alpha: tensor([0.0938, 0.0724, 0.0961, 0.0936, 0.0743, 0.0788, 0.1125],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 212 best val f1 0.4067 test f1 0.33171483874320984
Epoch 213 Loss: 0.6746 Alpha: tensor([0.0923, 0.0709, 0.0947, 0.0921, 0.0726, 0.0773, 0.1115],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 213 best val f1 0.4074 test f1 0.33268797397613525
Epoch 214 Loss: 0.6711 Alpha: tensor([0.0907, 0.0694, 0.0932, 0.0906, 0.0710, 0.0758, 0.1104],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 215 Loss: 0.6725 Alpha: tensor([0.0892, 0.0680, 0.0918, 0.0892, 0.0694, 0.0742, 0.1094],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 216 Loss: 0.6687 Alpha: tensor([0.0877, 0.0665, 0.0904, 0.0877, 0.0678, 0.0728, 0.1083],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 216 best val f1 0.4104 test f1 0.3356066048145294
Epoch 217 Loss: 0.6668 Alpha: tensor([0.0862, 0.0650, 0.0890, 0.0863, 0.0662, 0.0712, 0.1073],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 218 Loss: 0.6681 Alpha: tensor([0.0847, 0.0636, 0.0877, 0.0848, 0.0646, 0.0697, 0.1063],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 219 Loss: 0.6630 Alpha: tensor([0.0832, 0.0621, 0.0863, 0.0834, 0.0631, 0.0683, 0.1052],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 220 Loss: 0.6635 Alpha: tensor([0.0817, 0.0607, 0.0850, 0.0820, 0.0616, 0.0668, 0.1042],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 221 Loss: 0.6629 Alpha: tensor([0.0803, 0.0593, 0.0837, 0.0806, 0.0601, 0.0653, 0.1032],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 222 Loss: 0.6609 Alpha: tensor([0.0788, 0.0580, 0.0823, 0.0792, 0.0586, 0.0639, 0.1022],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 222 best val f1 0.4109 test f1 0.3432275950908661
Epoch 223 Loss: 0.6593 Alpha: tensor([0.0773, 0.0566, 0.0810, 0.0778, 0.0571, 0.0624, 0.1013],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 224 Loss: 0.6587 Alpha: tensor([0.0758, 0.0553, 0.0798, 0.0764, 0.0556, 0.0610, 0.1003],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 224 best val f1 0.4163 test f1 0.34583279490470886
Epoch 225 Loss: 0.6579 Alpha: tensor([0.0744, 0.0539, 0.0785, 0.0750, 0.0541, 0.0596, 0.0993],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 226 Loss: 0.6564 Alpha: tensor([0.0730, 0.0526, 0.0772, 0.0737, 0.0527, 0.0583, 0.0984],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 227 Loss: 0.6584 Alpha: tensor([0.0716, 0.0513, 0.0760, 0.0723, 0.0512, 0.0569, 0.0975],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 228 Loss: 0.6546 Alpha: tensor([0.0702, 0.0500, 0.0747, 0.0710, 0.0498, 0.0555, 0.0965],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 228 best val f1 0.4165 test f1 0.35220032930374146
Epoch 229 Loss: 0.6543 Alpha: tensor([0.0687, 0.0487, 0.0735, 0.0697, 0.0483, 0.0542, 0.0956],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 230 Loss: 0.6510 Alpha: tensor([0.0673, 0.0475, 0.0722, 0.0683, 0.0469, 0.0528, 0.0947],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 230 best val f1 0.4173 test f1 0.3564445972442627
Epoch 231 Loss: 0.6498 Alpha: tensor([0.0659, 0.0462, 0.0710, 0.0670, 0.0456, 0.0515, 0.0938],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 231 best val f1 0.4215 test f1 0.35859617590904236
Epoch 232 Loss: 0.6495 Alpha: tensor([0.0645, 0.0451, 0.0698, 0.0657, 0.0442, 0.0502, 0.0929],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 232 best val f1 0.4232 test f1 0.3609597086906433
Epoch 233 Loss: 0.6478 Alpha: tensor([0.0631, 0.0439, 0.0686, 0.0644, 0.0428, 0.0489, 0.0920],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 234 Loss: 0.6474 Alpha: tensor([0.0618, 0.0427, 0.0674, 0.0632, 0.0414, 0.0477, 0.0912],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 234 best val f1 0.4236 test f1 0.3651849031448364
Epoch 235 Loss: 0.6469 Alpha: tensor([0.0604, 0.0415, 0.0662, 0.0619, 0.0400, 0.0464, 0.0904],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 235 best val f1 0.4239 test f1 0.36772477626800537
Epoch 236 Loss: 0.6454 Alpha: tensor([0.0590, 0.0404, 0.0651, 0.0607, 0.0386, 0.0452, 0.0896],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 237 Loss: 0.6436 Alpha: tensor([0.0578, 0.0393, 0.0639, 0.0595, 0.0373, 0.0440, 0.0888],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 237 best val f1 0.4250 test f1 0.3726699650287628
Epoch 238 Loss: 0.6439 Alpha: tensor([0.0565, 0.0381, 0.0627, 0.0583, 0.0360, 0.0428, 0.0880],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 238 best val f1 0.4277 test f1 0.3751084506511688
Epoch 239 Loss: 0.6429 Alpha: tensor([0.0552, 0.0371, 0.0616, 0.0570, 0.0346, 0.0415, 0.0873],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 240 Loss: 0.6436 Alpha: tensor([0.0539, 0.0360, 0.0605, 0.0558, 0.0333, 0.0403, 0.0866],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 241 Loss: 0.6393 Alpha: tensor([0.0526, 0.0349, 0.0594, 0.0547, 0.0320, 0.0391, 0.0859],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 242 Loss: 0.6419 Alpha: tensor([0.0514, 0.0339, 0.0583, 0.0535, 0.0307, 0.0380, 0.0852],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 243 Loss: 0.6405 Alpha: tensor([0.0501, 0.0328, 0.0573, 0.0523, 0.0294, 0.0368, 0.0845],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 244 Loss: 0.6386 Alpha: tensor([0.0489, 0.0318, 0.0562, 0.0511, 0.0282, 0.0356, 0.0838],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 245 Loss: 0.6382 Alpha: tensor([0.0476, 0.0308, 0.0551, 0.0500, 0.0270, 0.0345, 0.0832],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 245 best val f1 0.4289 test f1 0.3947630822658539
Epoch 246 Loss: 0.6363 Alpha: tensor([0.0464, 0.0298, 0.0541, 0.0489, 0.0257, 0.0334, 0.0825],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 246 best val f1 0.4358 test f1 0.3977680504322052
Epoch 247 Loss: 0.6365 Alpha: tensor([0.0452, 0.0288, 0.0531, 0.0477, 0.0245, 0.0322, 0.0818],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 248 Loss: 0.6364 Alpha: tensor([0.0440, 0.0278, 0.0521, 0.0466, 0.0234, 0.0312, 0.0812],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 249 Loss: 0.6348 Alpha: tensor([0.0428, 0.0268, 0.0511, 0.0454, 0.0222, 0.0301, 0.0806],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 250 Loss: 0.6340 Alpha: tensor([0.0415, 0.0258, 0.0501, 0.0443, 0.0211, 0.0290, 0.0800],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 251 Loss: 0.6342 Alpha: tensor([0.0404, 0.0249, 0.0492, 0.0433, 0.0199, 0.0280, 0.0794],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 252 Loss: 0.6333 Alpha: tensor([0.0392, 0.0240, 0.0482, 0.0422, 0.0187, 0.0269, 0.0788],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 253 Loss: 0.6338 Alpha: tensor([0.0380, 0.0231, 0.0473, 0.0411, 0.0176, 0.0259, 0.0783],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 253 best val f1 0.4400 test f1 0.4243876039981842
Epoch 254 Loss: 0.6328 Alpha: tensor([0.0369, 0.0222, 0.0463, 0.0401, 0.0165, 0.0249, 0.0777],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 254 best val f1 0.4405 test f1 0.42748507857322693
Epoch 255 Loss: 0.6316 Alpha: tensor([0.0357, 0.0213, 0.0454, 0.0390, 0.0154, 0.0239, 0.0772],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 255 best val f1 0.4439 test f1 0.4300766885280609
Epoch 256 Loss: 0.6310 Alpha: tensor([0.0346, 0.0204, 0.0445, 0.0380, 0.0143, 0.0229, 0.0766],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 256 best val f1 0.4473 test f1 0.4336121678352356
Epoch 257 Loss: 0.6301 Alpha: tensor([0.0335, 0.0196, 0.0436, 0.0369, 0.0132, 0.0219, 0.0761],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 257 best val f1 0.4691 test f1 0.436884343624115
Epoch 258 Loss: 0.6288 Alpha: tensor([0.0324, 0.0187, 0.0427, 0.0359, 0.0121, 0.0209, 0.0756],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 258 best val f1 0.4712 test f1 0.44042104482650757
Epoch 259 Loss: 0.6308 Alpha: tensor([0.0313, 0.0179, 0.0418, 0.0348, 0.0110, 0.0200, 0.0752],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 260 Loss: 0.6298 Alpha: tensor([0.0303, 0.0171, 0.0408, 0.0339, 0.0100, 0.0191, 0.0747],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 261 Loss: 0.6286 Alpha: tensor([0.0292, 0.0163, 0.0399, 0.0329, 0.0090, 0.0181, 0.0742],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 262 Loss: 0.6290 Alpha: tensor([0.0282, 0.0155, 0.0390, 0.0319, 0.0079, 0.0172, 0.0737],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 263 Loss: 0.6285 Alpha: tensor([0.0272, 0.0147, 0.0380, 0.0310, 0.0069, 0.0163, 0.0733],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 264 Loss: 0.6277 Alpha: tensor([0.0262, 0.0140, 0.0371, 0.0301, 0.0059, 0.0155, 0.0728],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 265 Loss: 0.6283 Alpha: tensor([0.0252, 0.0132, 0.0362, 0.0292, 0.0049, 0.0146, 0.0724],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 266 Loss: 0.6269 Alpha: tensor([0.0242, 0.0125, 0.0354, 0.0283, 0.0039, 0.0137, 0.0719],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 267 Loss: 0.6259 Alpha: tensor([0.0232, 0.0118, 0.0345, 0.0274, 0.0029, 0.0129, 0.0714],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 268 Loss: 0.6265 Alpha: tensor([0.0222, 0.0111, 0.0337, 0.0265, 0.0019, 0.0121, 0.0710],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 269 Loss: 0.6255 Alpha: tensor([0.0212, 0.0104, 0.0329, 0.0256, 0.0009, 0.0112, 0.0706],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 270 Loss: 0.6253 Alpha: tensor([ 2.0263e-02,  9.7259e-03,  3.2056e-02,  2.4718e-02, -7.8917e-05,
         1.0443e-02,  7.0165e-02], device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 271 Loss: 0.6232 Alpha: tensor([ 0.0194,  0.0090,  0.0312,  0.0239, -0.0010,  0.0097,  0.0697],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 272 Loss: 0.6240 Alpha: tensor([ 0.0185,  0.0083,  0.0305,  0.0230, -0.0019,  0.0089,  0.0693],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 273 Loss: 0.6235 Alpha: tensor([ 0.0176,  0.0077,  0.0297,  0.0222, -0.0028,  0.0082,  0.0689],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 274 Loss: 0.6243 Alpha: tensor([ 0.0167,  0.0070,  0.0290,  0.0214, -0.0038,  0.0074,  0.0686],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 275 Loss: 0.6232 Alpha: tensor([ 0.0159,  0.0064,  0.0283,  0.0205, -0.0047,  0.0067,  0.0683],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 276 Loss: 0.6232 Alpha: tensor([ 0.0150,  0.0058,  0.0276,  0.0198, -0.0056,  0.0060,  0.0679],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 277 Loss: 0.6229 Alpha: tensor([ 0.0142,  0.0051,  0.0269,  0.0189, -0.0065,  0.0053,  0.0675],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 278 Loss: 0.6215 Alpha: tensor([ 0.0134,  0.0045,  0.0262,  0.0181, -0.0074,  0.0045,  0.0672],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 279 Loss: 0.6218 Alpha: tensor([ 0.0126,  0.0039,  0.0255,  0.0172, -0.0082,  0.0038,  0.0669],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 280 Loss: 0.6221 Alpha: tensor([ 0.0118,  0.0033,  0.0248,  0.0164, -0.0091,  0.0032,  0.0666],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 281 Loss: 0.6216 Alpha: tensor([ 0.0111,  0.0027,  0.0241,  0.0156, -0.0099,  0.0025,  0.0663],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 282 Loss: 0.6223 Alpha: tensor([ 0.0103,  0.0022,  0.0235,  0.0149, -0.0107,  0.0019,  0.0661],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 283 Loss: 0.6212 Alpha: tensor([ 0.0095,  0.0016,  0.0229,  0.0142, -0.0115,  0.0012,  0.0658],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 283 best val f1 0.4725 test f1 0.45812731981277466
Epoch 284 Loss: 0.6202 Alpha: tensor([ 0.0088,  0.0012,  0.0222,  0.0134, -0.0123,  0.0005,  0.0655],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 285 Loss: 0.6200 Alpha: tensor([ 0.0080,  0.0006,  0.0216,  0.0127, -0.0131, -0.0001,  0.0652],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 286 Loss: 0.6200 Alpha: tensor([ 0.0073,  0.0001,  0.0210,  0.0119, -0.0139, -0.0008,  0.0650],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 286 best val f1 0.4738 test f1 0.4534767270088196
Epoch 287 Loss: 0.6202 Alpha: tensor([ 0.0066, -0.0004,  0.0204,  0.0112, -0.0147, -0.0013,  0.0648],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 288 Loss: 0.6193 Alpha: tensor([ 0.0058, -0.0008,  0.0198,  0.0106, -0.0154, -0.0019,  0.0646],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 289 Loss: 0.6192 Alpha: tensor([ 0.0051, -0.0013,  0.0192,  0.0099, -0.0162, -0.0025,  0.0645],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 290 Loss: 0.6203 Alpha: tensor([ 0.0044, -0.0018,  0.0187,  0.0092, -0.0169, -0.0031,  0.0644],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 291 Loss: 0.6194 Alpha: tensor([ 0.0038, -0.0023,  0.0181,  0.0085, -0.0177, -0.0036,  0.0643],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 292 Loss: 0.6191 Alpha: tensor([ 0.0031, -0.0028,  0.0176,  0.0078, -0.0184, -0.0042,  0.0641],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 292 best val f1 0.4751 test f1 0.444160521030426
Epoch 293 Loss: 0.6190 Alpha: tensor([ 0.0024, -0.0032,  0.0171,  0.0071, -0.0191, -0.0047,  0.0640],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 293 best val f1 0.4765 test f1 0.442907452583313
Epoch 294 Loss: 0.6187 Alpha: tensor([ 0.0018, -0.0036,  0.0166,  0.0065, -0.0198, -0.0052,  0.0638],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 295 Loss: 0.6191 Alpha: tensor([ 0.0012, -0.0041,  0.0161,  0.0058, -0.0205, -0.0057,  0.0637],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 296 Loss: 0.6186 Alpha: tensor([ 0.0005, -0.0045,  0.0156,  0.0051, -0.0212, -0.0062,  0.0636],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 297 Loss: 0.6185 Alpha: tensor([-0.0001, -0.0049,  0.0151,  0.0045, -0.0219, -0.0067,  0.0635],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 298 Loss: 0.6182 Alpha: tensor([-0.0007, -0.0053,  0.0147,  0.0039, -0.0226, -0.0072,  0.0634],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 299 Loss: 0.6196 Alpha: tensor([-0.0013, -0.0057,  0.0142,  0.0033, -0.0233, -0.0076,  0.0632],
       device='cuda:0', grad_fn=<SelectBackward0>)
Epoch 300 Loss: 0.6181 Alpha: tensor([-0.0019, -0.0060,  0.0138,  0.0027, -0.0240, -0.0080,  0.0631],
       device='cuda:0', grad_fn=<SelectBackward0>)