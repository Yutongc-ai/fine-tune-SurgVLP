/home/yongxuan/anaconda3/envs/clip/lib/python3.8/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/yongxuan/SurgVLP/datasets/utils.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  features = torch.load(f"{cfg.cache_dir}/{split}local_f_part{part_idx}.pt")
loading num parts:  0
num_shots is  1
num_shots is  1
Epoch 1 Loss: 0.6538
/home/yongxuan/SurgVLP/datasets/utils.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  labels = torch.load(f"{cfg.cache_dir}/{split}local_l_part{part_idx}.pt")
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.35it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.73it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.85it/s]
Epoch 1 best val f1 0.2857 test f1 0.20883110165596008
Epoch 2 Loss: 0.4973
Epoch 2 best val f1 0.3636 test f1 0.3574766218662262
Epoch 3 Loss: 0.0024
Epoch 3 best val f1 0.6154 test f1 0.46364620327949524
Epoch 4 Loss: -0.1743
Epoch 5 Loss: -0.2018
Epoch 6 Loss: -0.2321
Epoch 7 Loss: -0.2585
Epoch 8 Loss: -0.2812
Epoch 9 Loss: -0.3024
Epoch 10 Loss: -0.3243
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.12it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.33it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.63it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.15it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.00it/s]
Epoch 11 Loss: -0.3482
Epoch 12 Loss: -0.3728
Epoch 13 Loss: -0.3971
Epoch 14 Loss: -0.4212
Epoch 15 Loss: -0.4453
Epoch 15 best val f1 0.6207 test f1 0.5069195032119751
Epoch 16 Loss: -0.4693
Epoch 16 best val f1 0.6667 test f1 0.5107148885726929
Epoch 17 Loss: -0.4930
Epoch 18 Loss: -0.5164
Epoch 19 Loss: -0.5395
Epoch 20 Loss: -0.5624
Epoch 21 Loss: -0.5849
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.71it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.92it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.90it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.99it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.04it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.00it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.93it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.06it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 22 Loss: -0.6072
Epoch 23 Loss: -0.6294
Epoch 24 Loss: -0.6516
Epoch 24 best val f1 0.7222 test f1 0.4916149079799652
Epoch 25 Loss: -0.6737
Epoch 26 Loss: -0.6958
Epoch 27 Loss: -0.7179
Epoch 28 Loss: -0.7400
Epoch 29 Loss: -0.7621
Epoch 30 Loss: -0.7841
Epoch 31 Loss: -0.8061
Epoch 32 Loss: -0.8286
Epoch 33 Loss: -0.8514
Epoch 34 Loss: -0.8746
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.89it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.83it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.97it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.13it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.96it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.09it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.79it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.98it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
Epoch 36 Loss: -0.9218
Epoch 37 Loss: -0.9472
Epoch 38 Loss: -0.9770
Epoch 39 Loss: -1.0095
Epoch 40 Loss: -1.0409
Epoch 41 Loss: -1.0719
Epoch 42 Loss: -1.1025
Epoch 43 Loss: -1.1318
Epoch 44 Loss: -1.1603
Epoch 45 Loss: -1.1885
Epoch 46 Loss: -1.2171
Epoch 47 Loss: -1.2463
Epoch 48 Loss: -1.2758
Epoch 49 Loss: -1.3061
Epoch 50 Loss: -1.3388
Epoch 51 Loss: -1.3752
Epoch 52 Loss: -1.4192
Epoch 53 Loss: -1.4658
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.33it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.10it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.20it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.02it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.32it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 54 Loss: -1.5146
Epoch 55 Loss: -1.5664
Epoch 56 Loss: -1.6169
Epoch 57 Loss: -1.6656
Epoch 58 Loss: -1.7127
Epoch 59 Loss: -1.7585
Epoch 60 Loss: -1.8034
Epoch 61 Loss: -1.8482
Epoch 62 Loss: -1.8935
Epoch 63 Loss: -1.9396
Epoch 64 Loss: -1.9860
Epoch 65 Loss: -2.0324
Epoch 66 Loss: -2.0790
Epoch 67 Loss: -2.1257
Epoch 68 Loss: -2.1726
Epoch 69 Loss: -2.2196
Epoch 70 Loss: -2.2669
Epoch 71 Loss: -2.3178
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.13it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.22it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.24it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.16it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.26it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.30it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.35it/s]
  0%|                                                                          | 0/1 [00:00<?, ?it/s]
Epoch 73 Loss: -2.4505
Epoch 74 Loss: -2.5290
Epoch 75 Loss: -2.6084
Epoch 76 Loss: -2.6876
Epoch 77 Loss: -2.7619
Epoch 78 Loss: -2.8319
Epoch 79 Loss: -2.8994
Epoch 80 Loss: -2.9661
Epoch 81 Loss: -3.0319
Epoch 82 Loss: -3.0968
Epoch 83 Loss: -3.1613
Epoch 84 Loss: -3.2261
Epoch 85 Loss: -3.2911
Epoch 86 Loss: -3.3562
Epoch 87 Loss: -3.4212
Epoch 88 Loss: -3.4864
Epoch 89 Loss: -3.5518
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.29it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.32it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.27it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.21it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.34it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.19it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.23it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.17it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.31it/s]
Epoch 91 Loss: -3.6830
Epoch 92 Loss: -3.7486
Epoch 93 Loss: -3.8143
Epoch 94 Loss: -3.8802
Epoch 95 Loss: -3.9466
Epoch 96 Loss: -4.0130
Epoch 97 Loss: -4.0799
Epoch 98 Loss: -4.1469
Epoch 99 Loss: -4.2141
Epoch 100 Loss: -4.2815
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.25it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.31it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.28it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.95it/s]
100%|██████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 17.31it/s]